#import "../lib.typ": data-table

= 系统测试与运行

本章介绍系统的测试环境配置、功能测试和性能测试的实施过程，以及开发过程中遇到的问题和解决方案。

== 测试环境

测试在以下硬件环境中进行:

#data-table(
  headers: ("硬件", "配置"),
  ([CPU], [Intel Core i5-13600K]),
  ([内存], [48GB DDR5 6000MHz]),
  ([硬盘], [2TB NVMe SSD]),
  ([网络], [千兆以太网]),
)

软件环境配置如下:

#data-table(
  headers: ("软件", "版本/配置"),
  ([操作系统], [Windows 11]),
  ([数据库], [PostgreSQL 17]),
  ([后端运行时], [Go 1.25.4]),
  ([前端环境], [Node.js 24.9.0 + Bun 1.3.2]),
  ([数据库管理], [pgAdmin 4]),
)

== 功能测试

功能测试验证系统各模块是否按需求正确实现，采用黑盒测试方法。

=== 用户模块测试

#data-table(
  columns: (auto, auto, auto, auto),
  align: (left, left, left, center),
  headers: ("测试用例", "输入数据", "预期结果", "测试结果"),
  ([用户注册], [合法用户信息], [注册成功，返回用户ID], [✓]),
  ([用户名重复], [已存在的用户名], [报错"用户名已存在"], [✓]),
  ([手机号格式错误], [非法手机号], [报错"手机号格式不正确"], [✓]),
  ([用户登录], [正确的用户名密码], [登录成功，返回JWT Token], [✓]),
  ([密码错误], [错误的密码], [报错"用户名或密码错误"], [✓]),
  ([Token认证], [携带有效Token], [通过认证，正常访问], [✓]),
  ([Token过期], [过期的Token], [返回401未授权], [✓]),
)

=== 包裹管理模块测试

#data-table(
  columns: (auto, auto, auto, auto),
  align: (left, left, left, center),
  headers: ("测试用例", "输入数据", "预期结果", "测试结果"),
  ([包裹入库], [完整包裹信息], [入库成功，生成取件码，分配货架], [✓]),
  ([快递单号重复], [已存在的单号], [报错"快递单号已存在"], [✓]),
  ([货架分配], [不同包裹大小], [正确分配到对应货架], [✓]),
  ([取件码唯一性], [批量入库个包裹], [个唯一取件码], [✓]),
  ([包裹取件], [正确的取件码+手机号], [取件成功，状态更新], [✓]),
  ([取件码不存在], [不存在的取件码], [报错"取件码不存在"], [✓]),
  ([手机号不匹配], [错误的手机号], [报错"手机号不匹配"], [✓]),
  ([包裹查询], [按取件码查询], [返回包裹详细信息], [✓]),
  ([包裹状态流转], [入库→上架→取件], [状态正确流转], [✓]),
)

=== 货架管理模块测试

#data-table(
  columns: (auto, auto, auto, auto),
  align: (left, left, left, center),
  headers: ("测试用例", "输入数据", "预期结果", "测试结果"),
  ([货架创建], [完整货架信息], [创建成功，返回货架ID], [✓]),
  ([货架占用数维护], [包裹上架/取件], [current_count自动增减], [✓]),
  ([货架容量检查], [货架已满时分配], [触发器阻止分配], [✓]),
  ([货架利用率查询], [查询所有货架], [正确计算利用率], [✓]),
)

=== 运费计算测试

#data-table(
  columns: (auto, auto, auto, auto),
  align: (left, left, left, center),
  headers: ("测试用例", "输入数据", "预期结果", "测试结果"),
  ([首重范围内], [重量1kg], [运费=首重价格], [✓]),
  ([超出首重], [重量3.5kg], [运费=首重+(续重×3)], [✓]),
  ([体积重量], [体积0.05m³], [按体积重量计费], [✓]),
  ([快递公司不存在], [未配置的公司], [报错提示], [✓]),
)

=== 滞留件处理测试

#data-table(
  columns: (auto, auto, auto, auto),
  align: (left, left, left, center),
  headers: ("测试用例", "输入数据", "预期结果", "测试结果"),
  ([滞留识别], [超过3天未取], [标记为滞留状态], [✓]),
  ([滞留费用计算], [滞留5天], [费用=2元], [✓]),
  ([滞留提醒], [滞留包裹], [发送提醒通知], [✓]),
  ([批量退回], [多个滞留包裹], [批量更新状态], [✓]),
)

== 系统运行展示

本节通过实际运行截图展示系统的主要功能界面，分为用户端功能和员工端功能两部分进行说明。

=== 用户端功能

用户端面向普通用户提供包裹查询、取件和寄件等服务。系统采用简洁直观的界面设计，降低用户学习成本。

登录界面采用左右分栏布局，左侧为登录表单区域，支持用户名和密码登录；右侧展示系统名称和标语，突出系统的便捷、高效、安全特性。整体配色采用绿色为主色调，符合校园物流服务的定位。

#figure(
  image("../assets/example/login.png", width: 80%),
  caption: [用户登录界面]
)

登录成功后进入个人仪表盘页面，该页面以卡片形式展示用户的包裹概览信息。上方"我的包裹"区域显示待取件包裹列表，包含取件码、快递公司、状态和入库时间等关键信息；下方"我的寄件"区域展示用户发起的寄件订单，包含寄件单号、收件人、快递公司、运费和状态等字段。通过"查看全部"链接可以跳转到完整列表页面。

#figure(
  image("../assets/example/dashboard.png", width: 80%),
  caption: [用户仪表盘]
)

包裹查询功能提供两种查询方式：取件码查询和快递单号查询。用户输入取件码后点击查询，系统返回包裹的详细信息，包括取件码、快递单号、收件人、手机号、快递公司、包裹尺寸、重量、当前状态、入库时间和预计滞留时间等。查询结果以清晰的键值对形式展示，方便用户快速获取所需信息。

#figure(
  image("../assets/example/query.png", width: 80%),
  caption: [包裹查询界面]
)

"我的包裹"页面以表格形式展示用户的所有包裹记录，支持按状态筛选。表格列包含取件码、快递单号、快递公司、货架位置、状态、入库时间和备注。不同状态使用不同颜色的标签区分：待上架为蓝色、待取件为绿色、滞留为橙色、已取件为灰色。表格底部提供分页控件，支持调整每页显示数量。

#figure(
  image("../assets/example/parcel.png", width: 80%),
  caption: [我的包裹列表]
)

寄件功能允许用户在线创建寄件订单。点击"创建寄件单"按钮弹出表单对话框，需要填写收件人姓名、收件人电话、收件地址、快递公司、重量和体积等信息。系统根据快递公司的收费标准和包裹参数实时计算预估运费，显示在表单底部，帮助用户在提交前了解费用情况。

#figure(
  image("../assets/example/send.png", width: 80%),
  caption: [创建寄件单]
)

=== 员工端功能

员工端面向驿站工作人员，提供包裹入库、货架管理和滞留件处理等后台管理功能。

包裹管理页面是员工日常操作的核心界面。页面顶部提供"包裹入库"和"包裹取件"两个操作按钮，下方表格展示所有包裹记录。点击"包裹入库"按钮弹出入库表单，需要填写快递单号、收件人姓名、收件人电话、快递公司、包裹尺寸和重量等必填字段，以及身份证号和备注等选填字段。系统会自动生成唯一的取件码并根据包裹尺寸智能分配货架位置。

#figure(
  image("../assets/example/stock.png", width: 80%),
  caption: [包裹入库界面]
)

货架管理页面用于维护驿站的货架资源。页面顶部以统计卡片形式展示总货架数、启用货架数、总容量和总使用率等关键指标。下方表格详细列出每个货架的信息，包括货架编码（采用"区域-层-列"的命名规则）、区域、层号、列号、类型、容量、使用率和状态。使用率以进度条形式直观展示，方便员工快速识别货架负载情况。每行提供编辑和删除操作按钮，右上角的"新增货架"按钮用于添加新的货架单元。

#figure(
  image("../assets/example/shelve.png", width: 80%),
  caption: [货架管理界面]
)

滞留件管理是驿站运营的重要环节。页面顶部以统计卡片展示待处理、已提醒、已退回的滞留件数量以及累计滞留费用。表格展示滞留包裹的详细信息，包括取件码、快递单号、收件人、手机号、货架位置、滞留天数、提醒次数、滞留费用和当前状态。滞留天数以醒目的红色数字标注，提醒员工关注。操作列提供"发送提醒"和"退回"按钮，页面顶部还支持批量退回操作，提升处理效率。

#figure(
  image("../assets/example/overdue.png", width: 80%),
  caption: [滞留件管理界面]
)

本章通过详细的功能测试和系统运行展示，验证了系统的正确性和稳定性。测试结果表明，系统核心功能完备，用户界面友好直观，能够满足校园物流驿站的实际业务需求。系统已具备实际部署和使用的条件。
