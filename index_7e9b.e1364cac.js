(function(_){var filename = ((function(){var _documentCurrentScript = typeof document !== "undefined" ? document.currentScript : null;return typeof document === "undefined" ? require("url").pathToFileURL(__filename).href : _documentCurrentScript && _documentCurrentScript.src || new URL("index_7e9b.js", document.baseURI).href})());for(var r in _){_[r].__farm_resource_pot__=filename;window['6a0c116a218a403c6f0e6f69157a05cf'].__farm_module_system__.register(r,_[r])}})({"2dd52d78":function e(e,t,a,l){e._m(t),a("2d08c2e5"),a("a3876e70");var r=a("9aaf3498"),o=a("9aaf3498"),u=a("9aaf3498"),i=a("1f6a8afd"),n=a("d8dfe26b"),c={class:"search-container"},d={key:0,class:"result-section"},s={style:{"font-size":"20px",color:"#18a058"}},f={style:{"margin-top":"16px","text-align":"center"}},p={key:1,class:"result-section"};t.default=r.defineComponent({__name:"Search",setup(e){var t=i.useMessage(),a=u.ref("pickup_code"),l=u.ref(""),r=u.ref(""),N=u.ref(!1),v=u.ref(null),m=u.ref("");u.ref(!1),u.ref(!1),u.ref("");var x={received:{text:"待上架",type:"info"},ready:{text:"待取件",type:"success"},picked_up:{text:"已取件",type:"default"},overdue:{text:"滞留",type:"warning"},returned:{text:"已退回",type:"error"}},_=async()=>{if(!N.value){if(v.value=null,m.value="","pickup_code"===a.value&&!l.value){t.error("请输入取件码");return;}if("tracking_number"===a.value&&!r.value){t.error("请输入快递单号");return;}N.value=!0;try{var e;e="pickup_code"===a.value?await n.getParcelByPickupCode(l.value):await n.getParcelByTrackingNumber(r.value),0===e.code&&e.data?(v.value=e.data,t.success("查询成功")):(m.value=e.message||"包裹不存在",t.error(m.value));}catch(e){m.value=e.message||"查询失败",t.error(m.value);}finally{N.value=!1;}}},V=()=>{l.value="",r.value="",v.value=null,m.value="";},h=e=>e?new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-";return(e,t)=>(o.openBlock(),o.createElementBlock("div",c,[o.createVNode(o.unref(i.NCard),{class:"search-card",title:"包裹查询"},{default:o.withCtx(()=>[o.createVNode(o.unref(i.NTabs),{value:a.value,"onUpdate:value":[t[2]||(t[2]=e=>a.value=e),V],type:"segment"},{default:o.withCtx(()=>[o.createVNode(o.unref(i.NTabPane),{name:"pickup_code",tab:"取件码查询"},{default:o.withCtx(()=>[o.createVNode(o.unref(i.NForm),{"label-placement":"top"},{default:o.withCtx(()=>[o.createVNode(o.unref(i.NFormItem),{label:"取件码"},{default:o.withCtx(()=>[o.createVNode(o.unref(i.NInput),{value:l.value,"onUpdate:value":t[0]||(t[0]=e=>l.value=e),placeholder:"请输入取件码，例如：A12345",size:"large",onKeyup:o.withKeys(_,["enter"])},null,8,["value"])]),_:1}),o.createVNode(o.unref(i.NFormItem),null,{default:o.withCtx(()=>[o.createVNode(o.unref(i.NButton),{type:"primary",size:"large",block:"",loading:N.value,onClick:_},{default:o.withCtx(()=>[...t[3]||(t[3]=[o.createTextVNode(" 查询 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),o.createVNode(o.unref(i.NTabPane),{name:"tracking_number",tab:"快递单号查询"},{default:o.withCtx(()=>[o.createVNode(o.unref(i.NForm),{"label-placement":"top"},{default:o.withCtx(()=>[o.createVNode(o.unref(i.NFormItem),{label:"快递单号"},{default:o.withCtx(()=>[o.createVNode(o.unref(i.NInput),{value:r.value,"onUpdate:value":t[1]||(t[1]=e=>r.value=e),placeholder:"请输入快递单号，例如：SF1234567890",size:"large",onKeyup:o.withKeys(_,["enter"])},null,8,["value"])]),_:1}),o.createVNode(o.unref(i.NFormItem),null,{default:o.withCtx(()=>[o.createVNode(o.unref(i.NButton),{type:"primary",size:"large",block:"",loading:N.value,onClick:_},{default:o.withCtx(()=>[...t[4]||(t[4]=[o.createTextVNode(" 查询 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["value"]),v.value?(o.openBlock(),o.createElementBlock("div",d,[o.createVNode(o.unref(i.NDescriptions),{"label-placement":"left",column:1,bordered:""},{default:o.withCtx(()=>[o.createVNode(o.unref(i.NDescriptionsItem),{label:"取件码"},{default:o.withCtx(()=>[o.createElementVNode("strong",s,o.toDisplayString(v.value.pickup_code),1)]),_:1}),o.createVNode(o.unref(i.NDescriptionsItem),{label:"快递单号"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(v.value.tracking_number),1)]),_:1}),o.createVNode(o.unref(i.NDescriptionsItem),{label:"收件人"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(v.value.recipient_name),1)]),_:1}),o.createVNode(o.unref(i.NDescriptionsItem),{label:"手机号"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(v.value.recipient_phone),1)]),_:1}),o.createVNode(o.unref(i.NDescriptionsItem),{label:"快递公司"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(v.value.courier_company),1)]),_:1}),o.createVNode(o.unref(i.NDescriptionsItem),{label:"包裹尺寸"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(v.value.size),1)]),_:1}),o.createVNode(o.unref(i.NDescriptionsItem),{label:"重量"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(v.value.weight)+" kg ",1)]),_:1}),o.createVNode(o.unref(i.NDescriptionsItem),{label:"状态"},{default:o.withCtx(()=>{var e;return[o.createVNode(o.unref(i.NTag),{type:(null===(e=x[v.value.status])||void 0===e?void 0:e.type)||"default"},{default:o.withCtx(()=>{var e;return[o.createTextVNode(o.toDisplayString((null===(e=x[v.value.status])||void 0===e?void 0:e.text)||v.value.status),1)];}),_:1},8,["type"])];}),_:1}),v.value.shelf?(o.openBlock(),o.createBlock(o.unref(i.NDescriptionsItem),{key:0,label:"货架位置"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(v.value.shelf.shelf_code)+" ("+o.toDisplayString(v.value.shelf.area)+"区"+o.toDisplayString(v.value.shelf.floor)+"层"+o.toDisplayString(v.value.shelf.column)+"列) ",1)]),_:1})):o.createCommentVNode("",!0),o.createVNode(o.unref(i.NDescriptionsItem),{label:"入库时间"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(h(v.value.received_at)),1)]),_:1}),v.value.shelved_at?(o.openBlock(),o.createBlock(o.unref(i.NDescriptionsItem),{key:1,label:"上架时间"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(h(v.value.shelved_at)),1)]),_:1})):o.createCommentVNode("",!0),v.value.picked_up_at?(o.openBlock(),o.createBlock(o.unref(i.NDescriptionsItem),{key:2,label:"取件时间"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(h(v.value.picked_up_at)),1)]),_:1})):o.createCommentVNode("",!0),v.value.expected_overdue_at?(o.openBlock(),o.createBlock(o.unref(i.NDescriptionsItem),{key:3,label:"预计滞留时间"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(h(v.value.expected_overdue_at)),1)]),_:1})):o.createCommentVNode("",!0),v.value.notes?(o.openBlock(),o.createBlock(o.unref(i.NDescriptionsItem),{key:4,label:"备注"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(v.value.notes),1)]),_:1})):o.createCommentVNode("",!0)]),_:1}),o.createElementVNode("div",f,[o.createVNode(o.unref(i.NButton),{onClick:V},{default:o.withCtx(()=>[...t[5]||(t[5]=[o.createTextVNode("继续查询",-1)])]),_:1})])])):m.value?(o.openBlock(),o.createElementBlock("div",p,[o.createVNode(o.unref(i.NResult),{status:"404",title:"未找到包裹",description:m.value},{footer:o.withCtx(()=>[o.createVNode(o.unref(i.NButton),{onClick:V},{default:o.withCtx(()=>[...t[6]||(t[6]=[o.createTextVNode("重新查询",-1)])]),_:1})]),_:1},8,["description"])])):o.createCommentVNode("",!0)]),_:1})]));}});},"3d2274bb":function e(e,t,o,l){e._m(t),o("2d08c2e5"),o("a3876e70"),o("c550eeaa");var a=o("9aaf3498"),n=o("9aaf3498"),r=o("9aaf3498"),i=o("a0cf2c50"),c=o("69191e11"),s=o("1f6a8afd"),d=o("8a685886"),u={class:"header-content"},p={class:"hero-section"},N={class:"statistics-section"},f={class:"section"},m={class:"feature-icon"},h={class:"feature-title"},V={class:"feature-description"},v={class:"section"},k={class:"service-icon"},C={class:"service-title"},g={class:"service-description"},x={key:0,class:"cta-section"};t.default=a.defineComponent({__name:"Home",setup(e){var t=i.useRouter(),o=c.useUserStore();s.useMessage(),o.initFromStorage();var l=r.computed(()=>o.isLoggedIn),a=r.computed(()=>o.userInfo),y=[{label:"个人中心",key:"profile"},{label:"退出登录",key:"logout"}],E=e=>{"logout"===e?(o.logout(),t.push("/")):"profile"===e&&t.push("/profile");},w=[{label:"配送点",value:"15"},{label:"注册用户",value:"5,680"},{label:"今日配送",value:"328"},{label:"累计配送",value:"156,892"}],B=[{title:"快速配送",description:"校内1小时送达，高效的物流配送网络覆盖校园每个角落",icon:d.SpeedometerOutline},{title:"安全可靠",description:"专业团队配送，实名认证，全程监控，保障包裹安全",icon:d.ShieldCheckmarkOutline},{title:"便捷取件",description:"多个自提点位，支持预约取件，随时随地轻松取件",icon:d.LocationOutline},{title:"实时追踪",description:"包裹状态实时更新，配送进度一目了然",icon:d.NotificationsOutline}],_=[{title:"包裹配送",description:"快递包裹统一配送服务，支持宿舍、教学楼等多种地址配送",icon:d.CubeOutline},{title:"暂存服务",description:"临时外出？我们提供安全的包裹暂存服务，随到随取",icon:d.ArchiveOutline},{title:"配送追踪",description:"实时查看包裹位置和配送进度，掌握每一个配送环节",icon:d.LocationOutline},{title:"到件通知",description:"包裹到达及时提醒，支持短信、微信等多种通知方式",icon:d.TimeOutline}];return(e,o)=>(n.openBlock(),n.createBlock(n.unref(s.NLayout),{style:{width:"100%","min-height":"100vh"}},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NLayoutHeader),{class:"header"},{default:n.withCtx(()=>[n.createElementVNode("div",u,[o[6]||(o[6]=n.createElementVNode("div",{class:"logo"},"校园物流系统",-1)),l.value?(n.openBlock(),n.createBlock(n.unref(s.NDropdown),{key:1,options:y,onSelect:E},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NButton),null,{icon:n.withCtx(()=>[n.createVNode(n.unref(s.NIcon),{component:n.unref(d.PersonOutline)},null,8,["component"])]),default:n.withCtx(()=>{var e,t;return[n.createTextVNode(" "+n.toDisplayString((null===(e=a.value)||void 0===e?void 0:e.realName)||(null===(t=a.value)||void 0===t?void 0:t.username)),1)];}),_:1})]),_:1})):(n.openBlock(),n.createBlock(n.unref(s.NSpace),{key:0},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NButton),{onClick:o[0]||(o[0]=e=>n.unref(t).push("/login"))},{default:n.withCtx(()=>[...o[4]||(o[4]=[n.createTextVNode("登录",-1)])]),_:1}),n.createVNode(n.unref(s.NButton),{type:"primary",onClick:o[1]||(o[1]=e=>n.unref(t).push("/register"))},{default:n.withCtx(()=>[...o[5]||(o[5]=[n.createTextVNode("注册",-1)])]),_:1})]),_:1}))])]),_:1}),n.createVNode(n.unref(s.NLayoutContent),{"content-style":"padding: 24px;"},{default:n.withCtx(()=>[n.createElementVNode("div",p,[o[8]||(o[8]=n.createElementVNode("h1",{class:"hero-title"},"便捷、高效、安全的校园物流服务",-1)),o[9]||(o[9]=n.createElementVNode("p",{class:"hero-description"},"让每一个包裹都能准时送达，让每一次配送都充满信赖",-1)),l.value?n.createCommentVNode("",!0):(n.openBlock(),n.createBlock(n.unref(s.NButton),{key:0,type:"primary",size:"large",onClick:o[2]||(o[2]=e=>n.unref(t).push("/register"))},{default:n.withCtx(()=>[...o[7]||(o[7]=[n.createTextVNode(" 立即开始 ",-1)])]),_:1}))]),n.createElementVNode("div",N,[n.createVNode(n.unref(s.NGrid),{"x-gap":24,"y-gap":24,cols:4,responsive:"screen"},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock(n.Fragment,null,n.renderList(w,e=>n.createVNode(n.unref(s.NGridItem),{key:e.label},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NStatistic),{label:e.label,value:e.value},null,8,["label","value"])]),_:2},1024)),64))]),_:1})]),n.createElementVNode("div",f,[o[10]||(o[10]=n.createElementVNode("h2",{class:"section-title"},"为什么选择我们？",-1)),n.createVNode(n.unref(s.NGrid),{"x-gap":24,"y-gap":24,cols:4,responsive:"screen"},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock(n.Fragment,null,n.renderList(B,e=>n.createVNode(n.unref(s.NGridItem),{key:e.title},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NCard),{class:"feature-card"},{default:n.withCtx(()=>[n.createElementVNode("div",m,[n.createVNode(n.unref(s.NIcon),{component:e.icon,size:32},null,8,["component"])]),n.createElementVNode("h3",h,n.toDisplayString(e.title),1),n.createElementVNode("p",V,n.toDisplayString(e.description),1)]),_:2},1024)]),_:2},1024)),64))]),_:1})]),n.createElementVNode("div",v,[o[11]||(o[11]=n.createElementVNode("h2",{class:"section-title"},"主要服务",-1)),n.createVNode(n.unref(s.NGrid),{"x-gap":24,"y-gap":24,cols:4,responsive:"screen"},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock(n.Fragment,null,n.renderList(_,e=>n.createVNode(n.unref(s.NGridItem),{key:e.title},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NCard),{class:"service-card"},{default:n.withCtx(()=>[n.createElementVNode("div",k,[n.createVNode(n.unref(s.NIcon),{component:e.icon,size:32},null,8,["component"])]),n.createElementVNode("h3",C,n.toDisplayString(e.title),1),n.createElementVNode("p",g,n.toDisplayString(e.description),1)]),_:2},1024)]),_:2},1024)),64))]),_:1})]),l.value?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",x,[o[13]||(o[13]=n.createElementVNode("h2",{class:"cta-title"},"准备好开始了吗？",-1)),o[14]||(o[14]=n.createElementVNode("p",{class:"cta-description"},"注册账号，即刻体验便捷的校园物流服务",-1)),n.createVNode(n.unref(s.NButton),{type:"primary",size:"large",onClick:o[3]||(o[3]=e=>n.unref(t).push("/register"))},{default:n.withCtx(()=>[...o[12]||(o[12]=[n.createTextVNode("立即注册",-1)])]),_:1})]))]),_:1})]),_:1}));}});},"64c6cf1d":function e(e,t,a,l){e._m(t),a("2d08c2e5"),a("a3876e70");var r=a("9aaf3498"),n=a("9aaf3498"),d=a("9aaf3498"),u=a("a0cf2c50"),o=a("69191e11"),c=a("1f6a8afd"),i=a("d8dfe26b"),s=a("d8dfe26b"),f=a("2025bacc"),v={class:"dashboard-container"},N={key:0,class:"not-logged-in"},m={key:1},p={key:0,class:"statistics-section"},h={class:"section"},y={class:"section-header"},V={key:0,class:"empty-state"},k={class:"section"},_={class:"section-header"},g={key:0,class:"empty-state"};t.default=r.defineComponent({__name:"Dashboard",setup(e){var t=u.useRouter(),a=o.useUserStore(),l=c.useMessage();a.initFromStorage();var r=d.ref(!1),C=d.ref(null),x=d.ref([]),w=d.ref([]),B=d.computed(()=>a.isLoggedIn),E=d.computed(()=>a.userInfo),b=d.computed(()=>{var e,t=null===(e=E.value)||void 0===e?void 0:e.role;return"staff"===t||"admin"===t;}),S={received:"待上架",ready:"待取件",picked_up:"已取件",overdue:"滞留",returned:"已退回"},I={pending:"待发货",shipped:"已发货",delivered:"已送达",cancelled:"已取消"},D=[{title:"取件码",key:"pickup_code"},{title:"快递公司",key:"courier_company"},{title:"状态",key:"status",render:e=>S[e.status]||e.status},{title:"入库时间",key:"received_at",render:e=>new Date(e.received_at).toLocaleString("zh-CN")}],G=[{title:"寄件单号",key:"shipment_number"},{title:"收件人",key:"recipient_name"},{title:"快递公司",key:"courier_company"},{title:"运费",key:"freight",render:e=>"¥".concat(e.freight)},{title:"状态",key:"status",render:e=>I[e.status]||e.status}],T=async()=>{r.value=!0;try{if(b.value){var e=await i.getDashboardStatistics();0===e.code&&e.data&&(C.value=e.data);}var t=await s.getMyParcels({page:1,page_size:5});0===t.code&&t.data&&(x.value=t.data.list);var a=await f.getMyShipments({page:1,page_size:5});0===a.code&&a.data&&(w.value=a.data.list);}catch(e){l.error("加载数据失败");}finally{r.value=!1;}};return d.onMounted(()=>{B.value&&T();}),(e,a)=>(n.openBlock(),n.createElementBlock("div",v,[B.value?(n.openBlock(),n.createElementBlock("div",m,[b.value&&C.value?(n.openBlock(),n.createElementBlock("div",p,[a[5]||(a[5]=n.createElementVNode("h3",null,"今日数据",-1)),n.createVNode(n.unref(c.NGrid),{"x-gap":24,"y-gap":24,cols:4},{default:n.withCtx(()=>[n.createVNode(n.unref(c.NGridItem),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NStatistic),{label:"今日入库",value:C.value.today.received_count},null,8,["value"])]),_:1})]),_:1}),n.createVNode(n.unref(c.NGridItem),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NStatistic),{label:"今日取件",value:C.value.today.picked_up_count},null,8,["value"])]),_:1})]),_:1}),n.createVNode(n.unref(c.NGridItem),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NStatistic),{label:"滞留包裹",value:C.value.today.overdue_count},null,8,["value"])]),_:1})]),_:1}),n.createVNode(n.unref(c.NGridItem),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NStatistic),{label:"货架使用率",value:C.value.shelves.utilization_rate,suffix:"%"},null,8,["value"])]),_:1})]),_:1})]),_:1})])):n.createCommentVNode("",!0),n.createElementVNode("div",h,[n.createElementVNode("div",y,[a[7]||(a[7]=n.createElementVNode("h3",null,"我的包裹",-1)),n.createVNode(n.unref(c.NButton),{text:"",type:"primary",onClick:a[1]||(a[1]=e=>n.unref(t).push("/my-parcels"))},{default:n.withCtx(()=>[...a[6]||(a[6]=[n.createTextVNode(" 查看全部 ",-1)])]),_:1})]),n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NDataTable),{columns:D,data:x.value,loading:r.value,pagination:!1},null,8,["data","loading"]),0!==x.value.length||r.value?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",V," 暂无包裹 "))]),_:1})]),n.createElementVNode("div",k,[n.createElementVNode("div",_,[a[9]||(a[9]=n.createElementVNode("h3",null,"我的寄件",-1)),n.createVNode(n.unref(c.NButton),{text:"",type:"primary",onClick:a[2]||(a[2]=e=>n.unref(t).push("/my-shipments"))},{default:n.withCtx(()=>[...a[8]||(a[8]=[n.createTextVNode(" 查看全部 ",-1)])]),_:1})]),n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NDataTable),{columns:G,data:w.value,loading:r.value,pagination:!1},null,8,["data","loading"]),0!==w.value.length||r.value?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",g," 暂无寄件记录 "))]),_:1})])])):(n.openBlock(),n.createElementBlock("div",N,[a[4]||(a[4]=n.createElementVNode("h2",null,"请先登录",-1)),n.createVNode(n.unref(c.NButton),{type:"primary",onClick:a[0]||(a[0]=e=>n.unref(t).push("/login")),style:{"margin-top":"16px"}},{default:n.withCtx(()=>[...a[3]||(a[3]=[n.createTextVNode(" 前往登录 ",-1)])]),_:1})]))]));}});},"6e9a68c3":function e(e,a,t,l){e._m(a),t("2d08c2e5"),t("a3876e70");var r=t("9aaf3498"),u=t("9aaf3498"),i=t("9aaf3498"),n=t("1f6a8afd"),o=t("d8dfe26b"),d=t("b90d6007"),c={class:"page-container"};a.default=r.defineComponent({__name:"ParcelManagement",setup(e){var a=n.useMessage(),t=i.ref(!1),l=i.ref([]),r=i.ref(0),p=i.ref(1),v=i.ref(20),f=i.ref(""),s=i.ref(!1),h=i.ref(!1),N=i.ref({tracking_number:"",recipient_name:"",recipient_phone:"",recipient_id_card:"",courier_company:"",size:"small",weight:1,notes:""}),_=i.ref(!1),m=i.ref(!1),w=i.ref({pickup_code:"",recipient_phone:""}),x=[{label:"全部",value:""},{label:"待上架",value:"received"},{label:"待取件",value:"ready"},{label:"已取件",value:"picked_up"},{label:"滞留",value:"overdue"},{label:"已退回",value:"returned"}],y=[{label:"小",value:"small"},{label:"中",value:"medium"},{label:"大",value:"large"}],V=d.COURIER_COMPANIES.map(e=>({label:e,value:e})),g={received:{text:"待上架",type:"info"},ready:{text:"待取件",type:"success"},picked_up:{text:"已取件",type:"default"},overdue:{text:"滞留",type:"warning"},returned:{text:"已退回",type:"error"}},C=[{title:"ID",key:"id",width:60},{title:"取件码",key:"pickup_code",width:100,render:e=>i.h("strong",{style:"color: #18a058; font-size: 14px;"},e.pickup_code)},{title:"快递单号",key:"tracking_number",width:140},{title:"收件人",key:"recipient_name",width:80},{title:"手机号",key:"recipient_phone",width:120},{title:"快递公司",key:"courier_company",width:100},{title:"货架",key:"shelf",width:100,render:e=>{var a;return(null===(a=e.shelf)||void 0===a?void 0:a.shelf_code)||"-";}},{title:"状态",key:"status",width:100,render:e=>{var a=g[e.status]||{text:e.status,type:"default"};return i.h(n.NTag,{type:a.type},{default:()=>a.text});}},{title:"入库时间",key:"received_at",width:160,render:e=>new Date(e.received_at).toLocaleString("zh-CN")},{title:"操作",key:"actions",width:120,render:e=>"received"===e.status?i.h(n.NButton,{size:"small",type:"primary",onClick:()=>I(e)},{default:()=>"上架"}):null}],k=async()=>{t.value=!0;var e=await o.getParcelList({status:f.value||void 0,page:p.value,page_size:v.value});0===e.code&&e.data?(l.value=e.data.list,r.value=e.data.pagination.total):a.error(e.message||"加载失败"),t.value=!1;},b=()=>{N.value={tracking_number:"",recipient_name:"",recipient_phone:"",recipient_id_card:"",courier_company:"",size:"small",weight:1,notes:""},s.value=!0;},I=async e=>{var t,l,r=await o.shelveParcel(e.id);0===r.code?(a.success("上架成功！货架位置：".concat(null===(l=r.data)||void 0===l?void 0:null===(t=l.shelf)||void 0===t?void 0:t.shelf_code)),k()):a.error(r.message||"上架失败");},U=async()=>{if(!h.value){if(!N.value.tracking_number){a.error("请输入快递单号");return;}if(!N.value.recipient_name){a.error("请输入收件人姓名");return;}if(!N.value.recipient_phone){a.error("请输入收件人电话");return;}if(!N.value.courier_company){a.error("请选择快递公司");return;}h.value=!0;var e,t=await o.receiveParcel(N.value);0===t.code?(a.success("入库成功！取件码：".concat(null===(e=t.data)||void 0===e?void 0:e.pickup_code)),s.value=!1,k()):a.error(t.message||"入库失败"),h.value=!1;}},F=()=>{w.value={pickup_code:"",recipient_phone:""},_.value=!0;},z=async()=>{if(!m.value){if(!w.value.pickup_code){a.error("请输入取件码");return;}if(!w.value.recipient_phone){a.error("请输入手机号");return;}m.value=!0;var e=await o.pickupParcel(w.value);0===e.code?(a.success("取件成功"),_.value=!1,k()):a.error(e.message||"取件失败"),m.value=!1;}},S=e=>{p.value=e,k();},B=()=>{p.value=1,k();};return i.onMounted(()=>{k();}),(e,a)=>(u.openBlock(),u.createElementBlock("div",c,[u.createVNode(u.unref(n.NCard),{title:"包裹管理"},{"header-extra":u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),null,{default:u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{type:"primary",onClick:b},{default:u.withCtx(()=>[...a[15]||(a[15]=[u.createTextVNode(" 包裹入库 ",-1)])]),_:1}),u.createVNode(u.unref(n.NButton),{type:"success",onClick:F},{default:u.withCtx(()=>[...a[16]||(a[16]=[u.createTextVNode(" 包裹取件 ",-1)])]),_:1})]),_:1})]),default:u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),{style:{"margin-bottom":"16px"}},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NSelect),{value:f.value,"onUpdate:value":[a[0]||(a[0]=e=>f.value=e),B],options:x,placeholder:"状态筛选",style:{width:"150px"}},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NDataTable),{columns:C,data:l.value,loading:t.value,pagination:{page:p.value,pageSize:v.value,itemCount:r.value,onUpdatePage:S},"scroll-x":1200},null,8,["data","loading","pagination"])]),_:1}),u.createVNode(u.unref(n.NModal),{show:s.value,"onUpdate:show":a[10]||(a[10]=e=>s.value=e),preset:"card",title:"包裹入库",style:{width:"600px"},"mask-closable":!1},{footer:u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),{justify:"end"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{onClick:a[9]||(a[9]=e=>s.value=!1)},{default:u.withCtx(()=>[...a[17]||(a[17]=[u.createTextVNode("取消",-1)])]),_:1}),u.createVNode(u.unref(n.NButton),{type:"primary",loading:h.value,onClick:U},{default:u.withCtx(()=>[...a[18]||(a[18]=[u.createTextVNode(" 确认入库 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:u.withCtx(()=>[u.createVNode(u.unref(n.NForm),{model:N.value,"label-placement":"left","label-width":"110"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NFormItem),{label:"快递单号",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:N.value.tracking_number,"onUpdate:value":a[1]||(a[1]=e=>N.value.tracking_number=e),placeholder:"请输入快递单号"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"收件人姓名",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:N.value.recipient_name,"onUpdate:value":a[2]||(a[2]=e=>N.value.recipient_name=e),placeholder:"请输入收件人姓名"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"收件人电话",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:N.value.recipient_phone,"onUpdate:value":a[3]||(a[3]=e=>N.value.recipient_phone=e),placeholder:"请输入收件人电话"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"身份证号"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:N.value.recipient_id_card,"onUpdate:value":a[4]||(a[4]=e=>N.value.recipient_id_card=e),placeholder:"选填"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"快递公司",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NSelect),{value:N.value.courier_company,"onUpdate:value":a[5]||(a[5]=e=>N.value.courier_company=e),options:u.unref(V),placeholder:"请选择快递公司"},null,8,["value","options"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"包裹尺寸",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NSelect),{value:N.value.size,"onUpdate:value":a[6]||(a[6]=e=>N.value.size=e),options:y,placeholder:"请选择包裹尺寸"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"重量 (kg)",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInputNumber),{value:N.value.weight,"onUpdate:value":a[7]||(a[7]=e=>N.value.weight=e),min:.1,max:50,step:.1,placeholder:"请输入重量",style:{width:"100%"}},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"备注"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:N.value.notes,"onUpdate:value":a[8]||(a[8]=e=>N.value.notes=e),type:"textarea",placeholder:"选填",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),u.createVNode(u.unref(n.NModal),{show:_.value,"onUpdate:show":a[14]||(a[14]=e=>_.value=e),preset:"card",title:"包裹取件",style:{width:"500px"},"mask-closable":!1},{footer:u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),{justify:"end"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{onClick:a[13]||(a[13]=e=>_.value=!1)},{default:u.withCtx(()=>[...a[19]||(a[19]=[u.createTextVNode("取消",-1)])]),_:1}),u.createVNode(u.unref(n.NButton),{type:"primary",loading:m.value,onClick:z},{default:u.withCtx(()=>[...a[20]||(a[20]=[u.createTextVNode(" 确认取件 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:u.withCtx(()=>[u.createVNode(u.unref(n.NForm),{model:w.value,"label-placement":"left","label-width":"80"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NFormItem),{label:"取件码",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.pickup_code,"onUpdate:value":a[11]||(a[11]=e=>w.value.pickup_code=e),placeholder:"请输入取件码",size:"large"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"手机号",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.recipient_phone,"onUpdate:value":a[12]||(a[12]=e=>w.value.recipient_phone=e),placeholder:"请输入收件人手机号进行验证",size:"large"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]));}});},"6f9dc2f6":function e(e,a,r,t){e._m(a),r("850e6c49"),r("2d08c2e5"),r("a3876e70");var l=r("9aaf3498"),d=r("9aaf3498"),u=r("9aaf3498"),o=r("a0cf2c50"),s=r("1f6a8afd"),n=r("37ef8574"),i={class:"register-container"},c={class:"register-content"},m={class:"register-left"},p={class:"form-actions"},v={class:"form-links"},N={class:"link-text"};a.default=l.defineComponent({__name:"Register",setup(e){var a=o.useRouter(),r=s.useMessage(),t=u.ref(null),l=u.ref(!1),f=u.ref({username:"",password:"",confirmPassword:"",realName:"",phone:"",idCard:"",email:""}),g=!1,h=!1,V=!1,w=!1,C=!1,_=!0,x=!0,b={username:{required:!0,message:"请输入用户名（3-20位字母、数字或下划线）",trigger:["blur","input"],validator:(e,a)=>!!a&&(g=/^[a-zA-Z0-9_]{3,20}$/.test(a))},password:{required:!0,message:"请输入合法的密码（6-20位）",trigger:["blur","input"],validator:(e,a)=>h=a.length>=6&&a.length<=20},confirmPassword:{required:!0,message:"两次输入的密码不一致",trigger:["blur","input"],validator:(e,a)=>V=a===f.value.password},realName:{required:!0,message:"请输入真实姓名",trigger:["blur","input"],validator:(e,a)=>w=a.length>=2&&a.length<=20},phone:{required:!0,message:"请输入正确的手机号（1开头的11位数字）",trigger:["blur","input"],validator:(e,a)=>C=/^1[3-9]\d{9}$/.test(a)},idCard:{required:!1,message:"请输入正确的身份证号（18位）",trigger:["blur","input"],validator:(e,a)=>a?_=/^[1-9]\d{5}(19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]$/.test(a):(_=!0,!0)},email:{required:!1,message:"请输入正确的邮箱地址",trigger:["blur","input"],validator:(e,a)=>a?x=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(a):(x=!0,!0)}},I=async()=>{if(!l.value){if(!g||!h||!V||!w||!C||!_||!x){r.error("请检查注册信息是否符合要求");return;}l.value=!0;var e=await n.register({username:f.value.username,password:f.value.password,realName:f.value.realName,phone:f.value.phone,idCard:f.value.idCard||void 0,email:f.value.email||void 0});0===e.code?(r.success("注册成功，即将跳转到登录页"),setTimeout(()=>{a.push("/login");},1500)):r.error(e.message||"注册失败，请重试"),setTimeout(()=>{l.value=!1;},1e3);}};return(e,a)=>{var r=d.resolveComponent("router-link");return d.openBlock(),d.createElementBlock("div",i,[d.createElementVNode("div",c,[d.createElementVNode("div",m,[d.createVNode(d.unref(s.NCard),{class:"register-card",bordered:!1},{default:d.withCtx(()=>[a[9]||(a[9]=d.createElementVNode("div",{class:"register-header"},[d.createElementVNode("h2",{class:"register-title"},"创建账号"),d.createElementVNode("p",{class:"register-subtitle"},"请填写以下信息完成注册")],-1)),d.createVNode(d.unref(s.NForm),{ref_key:"formRef",ref:t,model:f.value,"label-placement":"left","label-width":"0","require-mark-placement":"right-hanging",rules:b},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NFormItem),{path:"username"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.username,"onUpdate:value":a[0]||(a[0]=e=>f.value.username=e),placeholder:"用户名",size:"large"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"realName"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.realName,"onUpdate:value":a[1]||(a[1]=e=>f.value.realName=e),placeholder:"真实姓名",size:"large"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"phone"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.phone,"onUpdate:value":a[2]||(a[2]=e=>f.value.phone=e),placeholder:"手机号",size:"large"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"password"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.password,"onUpdate:value":a[3]||(a[3]=e=>f.value.password=e),type:"password",placeholder:"密码",size:"large","show-password-on":"click"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"confirmPassword"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.confirmPassword,"onUpdate:value":a[4]||(a[4]=e=>f.value.confirmPassword=e),type:"password",placeholder:"确认密码",size:"large","show-password-on":"click"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"idCard"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.idCard,"onUpdate:value":a[5]||(a[5]=e=>f.value.idCard=e),placeholder:"身份证号（选填）",size:"large"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"email"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.email,"onUpdate:value":a[6]||(a[6]=e=>f.value.email=e),placeholder:"邮箱（选填）",size:"large"},null,8,["value"])]),_:1}),d.createElementVNode("div",p,[d.createVNode(d.unref(s.NButton),{type:"primary",size:"large",block:"",loading:l.value,onClick:I},{default:d.withCtx(()=>[d.createTextVNode(d.toDisplayString(l.value?"注册中...":"注册"),1)]),_:1},8,["loading"])]),d.createElementVNode("div",v,[d.createElementVNode("p",N,[a[8]||(a[8]=d.createTextVNode(" 已有账号？ ",-1)),d.createVNode(r,{to:"/login",class:"link"},{default:d.withCtx(()=>[...a[7]||(a[7]=[d.createTextVNode("立即登录",-1)])]),_:1})])])]),_:1},8,["model"])]),_:1})]),a[10]||(a[10]=d.createElementVNode("div",{class:"register-right"},[d.createElementVNode("div",{class:"brand-content"},[d.createElementVNode("h1",{class:"brand-title"},"校园物流系统"),d.createElementVNode("p",{class:"brand-description"},"便捷、高效、安全的校园物流服务平台")])],-1))])]);};}});},"790b5d0e":function e(e,t,a,r){e._m(t),a("2d08c2e5"),a("a3876e70");var l=a("9aaf3498"),u=a("9aaf3498"),i=a("9aaf3498"),n=a("1f6a8afd"),o=a("2025bacc"),d={class:"page-container"},c={style:{"font-size":"20px",color:"#18a058"}};t.default=l.defineComponent({__name:"MyShipments",setup(e){var t=n.useMessage(),a=i.ref(!1),r=i.ref([]),l=i.ref(0),p=i.ref(1),v=i.ref(20),f=i.ref(!1),m=i.ref(!1),s=i.ref([]),h=i.ref(null),N=i.ref({recipient_name:"",recipient_phone:"",recipient_address:"",courier_company:"",weight:1,volume:.001}),w={pending:{text:"待发货",type:"warning"},shipped:{text:"已发货",type:"info"},delivered:{text:"已送达",type:"success"},cancelled:{text:"已取消",type:"error"}},_=[{title:"寄件单号",key:"shipment_number",width:180},{title:"收件人",key:"recipient_name",width:100},{title:"收件电话",key:"recipient_phone",width:120},{title:"收件地址",key:"recipient_address",ellipsis:{tooltip:!0},width:200},{title:"快递公司",key:"courier_company",width:100},{title:"重量",key:"weight",width:80,render:e=>"".concat(e.weight," kg")},{title:"运费",key:"freight",width:80,render:e=>"¥".concat(e.freight)},{title:"状态",key:"status",width:100,render:e=>{var t=w[e.status]||{text:e.status,type:"default"};return i.h(n.NTag,{type:t.type},{default:()=>t.text});}},{title:"创建时间",key:"created_at",width:160,render:e=>new Date(e.created_at).toLocaleString("zh-CN")}],y=async()=>{a.value=!0;var e=await o.getMyShipments({page:p.value,page_size:v.value});0===e.code&&e.data?(r.value=e.data.list,l.value=e.data.pagination.total):t.error(e.message||"加载失败"),a.value=!1;},g=async()=>{try{var e=await o.getCourierCompanies();0===e.code&&e.data&&(s.value=e.data);}catch(e){}},x=async()=>{if(N.value.courier_company&&N.value.weight&&N.value.volume)try{var e={courier_company:N.value.courier_company,weight:N.value.weight,volume:N.value.volume},t=await o.calculateFreight(e);0===t.code&&t.data&&(h.value=t.data.freight);}catch(e){}},C=()=>{N.value={recipient_name:"",recipient_phone:"",recipient_address:"",courier_company:"",weight:1,volume:.001},h.value=null,f.value=!0,g();},V=async()=>{if(!m.value){if(!N.value.recipient_name){t.error("请输入收件人姓名");return;}if(!N.value.recipient_phone){t.error("请输入收件人电话");return;}if(!N.value.recipient_address){t.error("请输入收件地址");return;}if(!N.value.courier_company){t.error("请选择快递公司");return;}m.value=!0;var e=await o.createShipment(N.value);0===e.code?(t.success("创建成功"),f.value=!1,y()):t.error(e.message||"创建失败"),m.value=!1;}},k=e=>{p.value=e,y();};return i.onMounted(()=>{y();}),(e,t)=>(u.openBlock(),u.createElementBlock("div",d,[u.createVNode(u.unref(n.NCard),{title:"我的寄件"},{"header-extra":u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{type:"primary",onClick:C},{default:u.withCtx(()=>[...t[8]||(t[8]=[u.createTextVNode(" 创建寄件单 ",-1)])]),_:1})]),default:u.withCtx(()=>[u.createVNode(u.unref(n.NDataTable),{columns:_,data:r.value,loading:a.value,pagination:{page:p.value,pageSize:v.value,itemCount:l.value,onUpdatePage:k},"scroll-x":1200},null,8,["data","loading","pagination"])]),_:1}),u.createVNode(u.unref(n.NModal),{show:f.value,"onUpdate:show":t[7]||(t[7]=e=>f.value=e),preset:"card",title:"创建寄件单",style:{width:"600px"},"mask-closable":!1},{footer:u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),{justify:"end"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{onClick:t[6]||(t[6]=e=>f.value=!1)},{default:u.withCtx(()=>[...t[9]||(t[9]=[u.createTextVNode("取消",-1)])]),_:1}),u.createVNode(u.unref(n.NButton),{type:"primary",loading:m.value,onClick:V},{default:u.withCtx(()=>[...t[10]||(t[10]=[u.createTextVNode(" 创建 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:u.withCtx(()=>[u.createVNode(u.unref(n.NForm),{model:N.value,"label-placement":"left","label-width":"100"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NFormItem),{label:"收件人姓名",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:N.value.recipient_name,"onUpdate:value":t[0]||(t[0]=e=>N.value.recipient_name=e),placeholder:"请输入收件人姓名"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"收件人电话",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:N.value.recipient_phone,"onUpdate:value":t[1]||(t[1]=e=>N.value.recipient_phone=e),placeholder:"请输入收件人电话"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"收件地址",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:N.value.recipient_address,"onUpdate:value":t[2]||(t[2]=e=>N.value.recipient_address=e),type:"textarea",placeholder:"请输入详细地址",rows:3},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"快递公司",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NSelect),{value:N.value.courier_company,"onUpdate:value":[t[3]||(t[3]=e=>N.value.courier_company=e),x],options:s.value.map(e=>({label:e,value:e})),placeholder:"请选择快递公司"},null,8,["value","options"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"重量 (kg)",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInputNumber),{value:N.value.weight,"onUpdate:value":[t[4]||(t[4]=e=>N.value.weight=e),x],min:.1,max:50,step:.1,placeholder:"请输入重量",style:{width:"100%"}},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"体积 (m³)",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInputNumber),{value:N.value.volume,"onUpdate:value":[t[5]||(t[5]=e=>N.value.volume=e),x],min:.001,max:1,step:.001,placeholder:"请输入体积",style:{width:"100%"}},null,8,["value"])]),_:1}),null!==h.value?(u.openBlock(),u.createBlock(u.unref(n.NFormItem),{key:0,label:"预估运费"},{default:u.withCtx(()=>[u.createElementVNode("strong",c,"¥"+u.toDisplayString(h.value),1)]),_:1})):u.createCommentVNode("",!0)]),_:1},8,["model"])]),_:1},8,["show"])]));}});},"95a3a9ed":function e(e,t,a,l){e._m(t),a("df42fcb9"),a("db38ec0f"),a("2d08c2e5"),a("a3876e70");var r=a("9aaf3498"),d=a("9aaf3498"),u=a("9aaf3498"),n=a("1f6a8afd"),i=a("1af7f2eb"),o={class:"page-container"};t.default=r.defineComponent({__name:"OverdueManagement",setup(e){var t=n.useMessage(),a=u.ref(!1),l=u.ref([]),r=u.ref(0),c=u.ref(1),s=u.ref(20),f=u.ref(null),v=u.ref([]),h=u.computed(()=>{var e=l.value.filter(e=>"pending"===e.status).length;return{pending:e,reminded:l.value.filter(e=>"reminded"===e.status).length,returned:l.value.filter(e=>"returned"===e.status).length,totalFee:l.value.reduce((e,t)=>e+t.overdue_fee,0)};}),N=[{label:"全部",value:null},{label:"待处理",value:"pending"},{label:"已提醒",value:"reminded"},{label:"已退回",value:"returned"}],p={pending:{text:"待处理",type:"warning"},reminded:{text:"已提醒",type:"info"},returned:{text:"已退回",type:"default"}},x=e=>e>=7?"#f5222d":e>=3?"#fa8c16":"#52c41a",y=[{type:"selection"},{title:"ID",key:"id",width:60},{title:"取件码",key:"pickup_code",width:100,render:e=>u.h("strong",{style:"color: #18a058;"},e.pickup_code)},{title:"快递单号",key:"tracking_number",width:140},{title:"收件人",key:"recipient_name",width:80},{title:"手机号",key:"recipient_phone",width:120},{title:"货架",key:"shelf_code",width:80,render:e=>e.shelf_code||"-"},{title:"滞留天数",key:"overdue_days",width:100,render:e=>u.h("span",{style:{color:x(e.overdue_days),fontWeight:"bold"}},"".concat(e.overdue_days," 天"))},{title:"提醒次数",key:"reminder_count",width:80},{title:"滞留费",key:"overdue_fee",width:80,render:e=>"¥".concat(e.overdue_fee.toFixed(2))},{title:"状态",key:"status",width:80,render:e=>{var t=p[e.status]||{text:e.status,type:"default"};return u.h(n.NTag,{type:t.type},{default:()=>t.text});}},{title:"操作",key:"actions",width:150,render:e=>"returned"===e.status?u.h("span",{style:"color: #999;"},"已退回"):u.h(n.NSpace,{},{default:()=>[u.h(n.NButton,{size:"small",type:"info",onClick:()=>w(e)},{default:()=>"发送提醒"}),u.h(n.NPopconfirm,{onPositiveClick:()=>_([e.id])},{trigger:()=>u.h(n.NButton,{size:"small",type:"error"},{default:()=>"退回"}),default:()=>"确定退回该包裹吗？"})]})}],g=async()=>{a.value=!0;var e=await i.getOverdueList({status:f.value||void 0,page:c.value,page_size:s.value});0===e.code&&e.data?(l.value=e.data.list,r.value=e.data.pagination.total):t.error(e.message||"加载失败"),a.value=!1;},w=async e=>{var a=await i.sendReminder(e.id);0===a.code?(t.success("提醒已发送"),g()):t.error(a.message||"发送失败");},_=async e=>{var a=await i.batchReturn(e);0===a.code&&a.data?(t.success("成功退回 ".concat(a.data.success," 个包裹")),v.value=[],g()):t.error(a.message||"退回失败");},k=()=>{var e=v.value;if(0===e.length){t.warning("请选择要退回的包裹");return;}_(e);},C=async()=>{var e=await i.checkOverdue();0===e.code&&e.data?(t.success("已标记 ".concat(e.data.marked_count," 个新滞留件")),g()):t.error(e.message||"检查失败");},m=e=>{c.value=e,g();},V=e=>{v.value=e;};return u.onMounted(()=>{g();}),(e,t)=>(d.openBlock(),d.createElementBlock("div",o,[d.createVNode(d.unref(n.NGrid),{cols:4,"x-gap":16,style:{"margin-bottom":"16px"}},{default:d.withCtx(()=>[d.createVNode(d.unref(n.NGi),null,{default:d.withCtx(()=>[d.createVNode(d.unref(n.NCard),null,{default:d.withCtx(()=>[d.createVNode(d.unref(n.NStatistic),{label:"待处理",value:h.value.pending},{suffix:d.withCtx(()=>[...t[0]||(t[0]=[d.createTextVNode("件",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),d.createVNode(d.unref(n.NGi),null,{default:d.withCtx(()=>[d.createVNode(d.unref(n.NCard),null,{default:d.withCtx(()=>[d.createVNode(d.unref(n.NStatistic),{label:"已提醒",value:h.value.reminded},{suffix:d.withCtx(()=>[...t[1]||(t[1]=[d.createTextVNode("件",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),d.createVNode(d.unref(n.NGi),null,{default:d.withCtx(()=>[d.createVNode(d.unref(n.NCard),null,{default:d.withCtx(()=>[d.createVNode(d.unref(n.NStatistic),{label:"已退回",value:h.value.returned},{suffix:d.withCtx(()=>[...t[2]||(t[2]=[d.createTextVNode("件",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),d.createVNode(d.unref(n.NGi),null,{default:d.withCtx(()=>[d.createVNode(d.unref(n.NCard),null,{default:d.withCtx(()=>[d.createVNode(d.unref(n.NStatistic),{label:"累计滞留费"},{prefix:d.withCtx(()=>[...t[3]||(t[3]=[d.createTextVNode("¥",-1)])]),default:d.withCtx(()=>[d.createTextVNode(d.toDisplayString(h.value.totalFee.toFixed(2)),1)]),_:1})]),_:1})]),_:1})]),_:1}),d.createVNode(d.unref(n.NCard),{title:"滞留件管理"},{"header-extra":d.withCtx(()=>[d.createVNode(d.unref(n.NSpace),null,{default:d.withCtx(()=>[d.createVNode(d.unref(n.NButton),{onClick:C},{default:d.withCtx(()=>[...t[4]||(t[4]=[d.createTextVNode("检查滞留件",-1)])]),_:1}),d.createVNode(d.unref(n.NButton),{type:"error",disabled:0===v.value.length,onClick:k},{default:d.withCtx(()=>[d.createTextVNode(" 批量退回 ("+d.toDisplayString(v.value.length)+") ",1)]),_:1},8,["disabled"])]),_:1})]),default:d.withCtx(()=>[d.createVNode(d.unref(n.NSpace),{style:{"margin-bottom":"16px"}},{default:d.withCtx(()=>[(d.openBlock(),d.createElementBlock(d.Fragment,null,d.renderList(N,e=>{var t;return d.createVNode(d.unref(n.NButton),{key:null!==(t=e.value)&&void 0!==t?t:"all",type:f.value===e.value?"primary":"default",onClick:t=>{f.value=e.value,c.value=1,g();}},{default:d.withCtx(()=>[d.createTextVNode(d.toDisplayString(e.label),1)]),_:2},1032,["type","onClick"]);}),64))]),_:1}),d.createVNode(d.unref(n.NDataTable),{columns:y,data:l.value,loading:a.value,"row-key":e=>e.id,"checked-row-keys":v.value,"onUpdate:checkedRowKeys":V,pagination:{page:c.value,pageSize:s.value,itemCount:r.value,onUpdatePage:m},"scroll-x":1300},null,8,["data","loading","row-key","checked-row-keys","pagination"])]),_:1})]));}});},"df1164f8":function e(e,a,l,t){e._m(a),l("db38ec0f"),l("2d08c2e5"),l("a3876e70");var u=l("9aaf3498"),r=l("9aaf3498"),o=l("9aaf3498"),n=l("1f6a8afd"),d=l("33a636cf"),i={class:"page-container"};a.default=u.defineComponent({__name:"ShelfManagement",setup(e){var a=n.useMessage(),l=o.ref(!1),t=o.ref([]),u=o.ref(0),v=o.ref(1),c=o.ref(20),f=o.ref(null),s=o.ref(null),N=o.ref(null),p=o.ref(null),m=o.ref(!1),h=o.ref("create"),y=o.ref(!1),w=o.ref(null),x=o.ref({shelf_code:"",area:"",floor:1,column:1,type:"small",capacity:20}),V=o.ref({}),b=[{label:"全部",value:null},{label:"A区",value:"A"},{label:"B区",value:"B"},{label:"C区",value:"C"}],_=[{label:"全部",value:null},{label:"小件",value:"small"},{label:"中件",value:"medium"},{label:"大件",value:"large"}],C=[{label:"全部",value:null},{label:"启用",value:"active"},{label:"停用",value:"inactive"}],g={small:"小件",medium:"中件",large:"大件"},k={active:{text:"启用",type:"success"},inactive:{text:"停用",type:"warning"}},I=e=>e>=90?"#f5222d":e>=70?"#fa8c16":e>=30?"#52c41a":"#1890ff",S=[{title:"ID",key:"id",width:60},{title:"货架编码",key:"shelf_code",width:100},{title:"区域",key:"area",width:60},{title:"层",key:"floor",width:60},{title:"列",key:"column",width:60},{title:"类型",key:"type",width:80,render:e=>g[e.type]||e.type},{title:"容量",key:"capacity",width:80,render:e=>{var a;return"".concat(null!==(a=e.current_count)&&void 0!==a?a:0,"/").concat(e.capacity);}},{title:"使用率",key:"utilization",width:120,render:e=>{var a,l=Math.round((null!==(a=e.current_count)&&void 0!==a?a:0)/e.capacity*100);return o.h(n.NProgress,{type:"line",percentage:l,color:I(l),showIndicator:!0});}},{title:"状态",key:"status",width:80,render:e=>{var a,l,t=k[null!==(a=e.status)&&void 0!==a?a:"active"]||{text:null!==(l=e.status)&&void 0!==l?l:"未知",type:"default"};return o.h(n.NTag,{type:t.type},{default:()=>t.text});}},{title:"操作",key:"actions",width:150,render:e=>o.h(n.NSpace,{},{default:()=>[o.h(n.NButton,{size:"small",onClick:()=>z(e)},{default:()=>"编辑"}),o.h(n.NButton,{size:"small",type:"error",disabled:e.current_count>0,onClick:()=>G(e)},{default:()=>"删除"})]})}],U=async()=>{l.value=!0;var e=await d.getShelfList({area:f.value||void 0,type:s.value||void 0,status:N.value||void 0,page:v.value,page_size:c.value});0===e.code&&e.data?(t.value=e.data.list,u.value=e.data.pagination.total):a.error(e.message||"加载失败"),l.value=!1;},F=async()=>{try{var e=await d.getShelfStatistics();0===e.code&&e.data&&(p.value=e.data);}catch(e){console.error("Failed to load statistics",e);}},B=()=>{h.value="create",x.value={shelf_code:"",area:"",floor:1,column:1,type:"small",capacity:20},m.value=!0;},z=e=>{h.value="edit",w.value=e.id,V.value={area:e.area,floor:e.floor,column:e.column,type:e.type,capacity:e.capacity,status:e.status},m.value=!0;},q=async()=>{if(!y.value){if(y.value=!0,"create"===h.value){if(!x.value.shelf_code||!x.value.area){a.error("请填写完整信息"),y.value=!1;return;}var e=await d.createShelf(x.value);0===e.code?(a.success("创建成功"),m.value=!1,U(),F()):a.error(e.message||"创建失败");}else{if(!w.value){y.value=!1;return;}var l=await d.updateShelf(w.value,V.value);0===l.code?(a.success("更新成功"),m.value=!1,U(),F()):a.error(l.message||"更新失败");}y.value=!1;}},G=async e=>{var l=await d.deleteShelf(e.id);0===l.code?(a.success("删除成功"),U(),F()):a.error(l.message||"删除失败");},M=e=>{v.value=e,U();},T=()=>{v.value=1,U();};return o.onMounted(()=>{U(),F();}),(e,a)=>(r.openBlock(),r.createElementBlock("div",i,[r.createVNode(r.unref(n.NGrid),{cols:4,"x-gap":16,style:{"margin-bottom":"16px"}},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NGi),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NCard),null,{default:r.withCtx(()=>{var e;return[r.createVNode(r.unref(n.NStatistic),{label:"总货架数",value:(null===(e=p.value)||void 0===e?void 0:e.total_shelves)||0},null,8,["value"])];}),_:1})]),_:1}),r.createVNode(r.unref(n.NGi),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NCard),null,{default:r.withCtx(()=>{var e;return[r.createVNode(r.unref(n.NStatistic),{label:"启用货架",value:(null===(e=p.value)||void 0===e?void 0:e.active_shelves)||0},null,8,["value"])];}),_:1})]),_:1}),r.createVNode(r.unref(n.NGi),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NCard),null,{default:r.withCtx(()=>{var e;return[r.createVNode(r.unref(n.NStatistic),{label:"总容量",value:(null===(e=p.value)||void 0===e?void 0:e.total_capacity)||0},null,8,["value"])];}),_:1})]),_:1}),r.createVNode(r.unref(n.NGi),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NCard),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NStatistic),{label:"总使用率"},{default:r.withCtx(()=>{var e,a;return[r.createElementVNode("span",{style:r.normalizeStyle({color:I((null===(e=p.value)||void 0===e?void 0:e.utilization_rate)||0)})},r.toDisplayString(((null===(a=p.value)||void 0===a?void 0:a.utilization_rate)||0).toFixed(1))+"% ",5)];}),_:1})]),_:1})]),_:1})]),_:1}),r.createVNode(r.unref(n.NCard),{title:"货架管理"},{"header-extra":r.withCtx(()=>[r.createVNode(r.unref(n.NButton),{type:"primary",onClick:B},{default:r.withCtx(()=>[...a[17]||(a[17]=[r.createTextVNode("新增货架",-1)])]),_:1})]),default:r.withCtx(()=>[r.createVNode(r.unref(n.NSpace),{style:{"margin-bottom":"16px"}},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NSelect),{value:f.value,"onUpdate:value":[a[0]||(a[0]=e=>f.value=e),T],options:b,placeholder:"区域",style:{width:"100px"}},null,8,["value"]),r.createVNode(r.unref(n.NSelect),{value:s.value,"onUpdate:value":[a[1]||(a[1]=e=>s.value=e),T],options:_,placeholder:"类型",style:{width:"100px"}},null,8,["value"]),r.createVNode(r.unref(n.NSelect),{value:N.value,"onUpdate:value":[a[2]||(a[2]=e=>N.value=e),T],options:C,placeholder:"状态",style:{width:"100px"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NDataTable),{columns:S,data:t.value,loading:l.value,pagination:{page:v.value,pageSize:c.value,itemCount:u.value,onUpdatePage:M},"scroll-x":1e3},null,8,["data","loading","pagination"])]),_:1}),r.createVNode(r.unref(n.NModal),{show:m.value,"onUpdate:show":a[16]||(a[16]=e=>m.value=e),preset:"card",title:"create"===h.value?"新增货架":"编辑货架",style:{width:"500px"},"mask-closable":!1},{footer:r.withCtx(()=>[r.createVNode(r.unref(n.NSpace),{justify:"end"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NButton),{onClick:a[15]||(a[15]=e=>m.value=!1)},{default:r.withCtx(()=>[...a[18]||(a[18]=[r.createTextVNode("取消",-1)])]),_:1}),r.createVNode(r.unref(n.NButton),{type:"primary",loading:y.value,onClick:q},{default:r.withCtx(()=>[...a[19]||(a[19]=[r.createTextVNode(" 确认 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:r.withCtx(()=>["create"===h.value?(r.openBlock(),r.createBlock(r.unref(n.NForm),{key:0,model:x.value,"label-placement":"left","label-width":"80"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NFormItem),{label:"货架编码",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInput),{value:x.value.shelf_code,"onUpdate:value":a[3]||(a[3]=e=>x.value.shelf_code=e),placeholder:"如 A-1-1"},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"区域",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInput),{value:x.value.area,"onUpdate:value":a[4]||(a[4]=e=>x.value.area=e),placeholder:"如 A、B、C"},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"层",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:x.value.floor,"onUpdate:value":a[5]||(a[5]=e=>x.value.floor=e),min:1,max:10,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"列",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:x.value.column,"onUpdate:value":a[6]||(a[6]=e=>x.value.column=e),min:1,max:20,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"类型",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NSelect),{value:x.value.type,"onUpdate:value":a[7]||(a[7]=e=>x.value.type=e),options:[{label:"小件",value:"small"},{label:"中件",value:"medium"},{label:"大件",value:"large"}]},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"容量",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:x.value.capacity,"onUpdate:value":a[8]||(a[8]=e=>x.value.capacity=e),min:1,max:100,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1},8,["model"])):(r.openBlock(),r.createBlock(r.unref(n.NForm),{key:1,model:V.value,"label-placement":"left","label-width":"80"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NFormItem),{label:"区域"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInput),{value:V.value.area,"onUpdate:value":a[9]||(a[9]=e=>V.value.area=e)},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"层"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:V.value.floor,"onUpdate:value":a[10]||(a[10]=e=>V.value.floor=e),min:1,max:10,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"列"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:V.value.column,"onUpdate:value":a[11]||(a[11]=e=>V.value.column=e),min:1,max:20,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"类型"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NSelect),{value:V.value.type,"onUpdate:value":a[12]||(a[12]=e=>V.value.type=e),options:[{label:"小件",value:"small"},{label:"中件",value:"medium"},{label:"大件",value:"large"}]},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"容量"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:V.value.capacity,"onUpdate:value":a[13]||(a[13]=e=>V.value.capacity=e),min:1,max:100,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"状态"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NSelect),{value:V.value.status,"onUpdate:value":a[14]||(a[14]=e=>V.value.status=e),options:[{label:"启用",value:"active"},{label:"停用",value:"inactive"}]},null,8,["value"])]),_:1})]),_:1},8,["model"]))]),_:1},8,["show","title"])]));}});},});
//# sourceMappingURL=index_7e9b.e1364cac.js.map