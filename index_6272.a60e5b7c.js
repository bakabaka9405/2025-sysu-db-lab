(function(_){var filename = ((function(){var _documentCurrentScript = typeof document !== "undefined" ? document.currentScript : null;return typeof document === "undefined" ? require("url").pathToFileURL(__filename).href : _documentCurrentScript && _documentCurrentScript.src || new URL("index_6272.js", document.baseURI).href})());for(var r in _){_[r].__farm_resource_pot__=filename;window['6a0c116a218a403c6f0e6f69157a05cf'].__farm_module_system__.register(r,_[r])}})({"2dd52d78":function e(e,t,a,l){e._m(t),a("2d08c2e5"),a("a3876e70");var r=a("9aaf3498"),o=a("9aaf3498"),u=a("9aaf3498"),n=a("1f6a8afd"),i=a("d8dfe26b"),c=a("704cb3d6"),d=a("7e15ef1a"),f={class:"search-container"},s={key:0,class:"result-section"},p={style:{"font-size":"20px",color:"#18a058"}},N={style:{"margin-top":"16px","text-align":"center"}},v={key:1,class:"result-section"};t.default=r.defineComponent({__name:"Search",setup(e){var t=n.useMessage(),a=u.ref("pickup_code"),l=u.ref(""),r=u.ref(""),m=u.ref(!1),_=u.ref(null),x=u.ref("");u.ref(!1),u.ref(!1),u.ref("");var V=async()=>{if(!m.value){if(_.value=null,x.value="","pickup_code"===a.value&&!l.value){t.error("请输入取件码");return;}if("tracking_number"===a.value&&!r.value){t.error("请输入快递单号");return;}m.value=!0;try{var e;e="pickup_code"===a.value?await i.getParcelByPickupCode(l.value):await i.getParcelByTrackingNumber(r.value),0===e.code&&e.data?(_.value=e.data,t.success("查询成功")):(x.value=e.message||"包裹不存在",t.error(x.value));}catch(e){x.value=e.message||"查询失败",t.error(x.value);}finally{m.value=!1;}}},h=()=>{l.value="",r.value="",_.value=null,x.value="";};return(e,t)=>(o.openBlock(),o.createElementBlock("div",f,[o.createVNode(o.unref(n.NCard),{class:"search-card",title:"包裹查询"},{default:o.withCtx(()=>[o.createVNode(o.unref(n.NTabs),{value:a.value,"onUpdate:value":[t[2]||(t[2]=e=>a.value=e),h],type:"segment"},{default:o.withCtx(()=>[o.createVNode(o.unref(n.NTabPane),{name:"pickup_code",tab:"取件码查询"},{default:o.withCtx(()=>[o.createVNode(o.unref(n.NForm),{"label-placement":"top"},{default:o.withCtx(()=>[o.createVNode(o.unref(n.NFormItem),{label:"取件码"},{default:o.withCtx(()=>[o.createVNode(o.unref(n.NInput),{value:l.value,"onUpdate:value":t[0]||(t[0]=e=>l.value=e),placeholder:"请输入取件码，例如：A12345",size:"large",onKeyup:o.withKeys(V,["enter"])},null,8,["value"])]),_:1}),o.createVNode(o.unref(n.NFormItem),null,{default:o.withCtx(()=>[o.createVNode(o.unref(n.NButton),{type:"primary",size:"large",block:"",loading:m.value,onClick:V},{default:o.withCtx(()=>[...t[3]||(t[3]=[o.createTextVNode(" 查询 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),o.createVNode(o.unref(n.NTabPane),{name:"tracking_number",tab:"快递单号查询"},{default:o.withCtx(()=>[o.createVNode(o.unref(n.NForm),{"label-placement":"top"},{default:o.withCtx(()=>[o.createVNode(o.unref(n.NFormItem),{label:"快递单号"},{default:o.withCtx(()=>[o.createVNode(o.unref(n.NInput),{value:r.value,"onUpdate:value":t[1]||(t[1]=e=>r.value=e),placeholder:"请输入快递单号，例如：SF1234567890",size:"large",onKeyup:o.withKeys(V,["enter"])},null,8,["value"])]),_:1}),o.createVNode(o.unref(n.NFormItem),null,{default:o.withCtx(()=>[o.createVNode(o.unref(n.NButton),{type:"primary",size:"large",block:"",loading:m.value,onClick:V},{default:o.withCtx(()=>[...t[4]||(t[4]=[o.createTextVNode(" 查询 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["value"]),_.value?(o.openBlock(),o.createElementBlock("div",s,[o.createVNode(o.unref(n.NDescriptions),{"label-placement":"left",column:1,bordered:""},{default:o.withCtx(()=>[o.createVNode(o.unref(n.NDescriptionsItem),{label:"取件码"},{default:o.withCtx(()=>[o.createElementVNode("strong",p,o.toDisplayString(_.value.pickup_code),1)]),_:1}),o.createVNode(o.unref(n.NDescriptionsItem),{label:"快递单号"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(_.value.tracking_number),1)]),_:1}),o.createVNode(o.unref(n.NDescriptionsItem),{label:"收件人"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(_.value.recipient_name),1)]),_:1}),o.createVNode(o.unref(n.NDescriptionsItem),{label:"手机号"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(_.value.recipient_phone),1)]),_:1}),o.createVNode(o.unref(n.NDescriptionsItem),{label:"快递公司"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(_.value.courier_company),1)]),_:1}),o.createVNode(o.unref(n.NDescriptionsItem),{label:"包裹尺寸"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(_.value.size),1)]),_:1}),o.createVNode(o.unref(n.NDescriptionsItem),{label:"重量"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(_.value.weight)+" kg ",1)]),_:1}),o.createVNode(o.unref(n.NDescriptionsItem),{label:"状态"},{default:o.withCtx(()=>{var e;return[o.createVNode(o.unref(n.NTag),{type:(null===(e=o.unref(c.PARCEL_STATUS_MAP)[_.value.status])||void 0===e?void 0:e.type)||"default"},{default:o.withCtx(()=>{var e;return[o.createTextVNode(o.toDisplayString((null===(e=o.unref(c.PARCEL_STATUS_MAP)[_.value.status])||void 0===e?void 0:e.text)||_.value.status),1)];}),_:1},8,["type"])];}),_:1}),_.value.shelf?(o.openBlock(),o.createBlock(o.unref(n.NDescriptionsItem),{key:0,label:"货架位置"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(_.value.shelf.shelf_code)+" ("+o.toDisplayString(_.value.shelf.area)+"区"+o.toDisplayString(_.value.shelf.floor)+"层"+o.toDisplayString(_.value.shelf.column)+"列) ",1)]),_:1})):o.createCommentVNode("",!0),o.createVNode(o.unref(n.NDescriptionsItem),{label:"入库时间"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(o.unref(d.formatDateTime)(_.value.received_at)),1)]),_:1}),_.value.shelved_at?(o.openBlock(),o.createBlock(o.unref(n.NDescriptionsItem),{key:1,label:"上架时间"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(o.unref(d.formatDateTime)(_.value.shelved_at)),1)]),_:1})):o.createCommentVNode("",!0),_.value.picked_up_at?(o.openBlock(),o.createBlock(o.unref(n.NDescriptionsItem),{key:2,label:"取件时间"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(o.unref(d.formatDateTime)(_.value.picked_up_at)),1)]),_:1})):o.createCommentVNode("",!0),_.value.expected_overdue_at?(o.openBlock(),o.createBlock(o.unref(n.NDescriptionsItem),{key:3,label:"预计滞留时间"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(o.unref(d.formatDateTime)(_.value.expected_overdue_at)),1)]),_:1})):o.createCommentVNode("",!0),_.value.notes?(o.openBlock(),o.createBlock(o.unref(n.NDescriptionsItem),{key:4,label:"备注"},{default:o.withCtx(()=>[o.createTextVNode(o.toDisplayString(_.value.notes),1)]),_:1})):o.createCommentVNode("",!0)]),_:1}),o.createElementVNode("div",N,[o.createVNode(o.unref(n.NButton),{onClick:h},{default:o.withCtx(()=>[...t[5]||(t[5]=[o.createTextVNode("继续查询",-1)])]),_:1})])])):x.value?(o.openBlock(),o.createElementBlock("div",v,[o.createVNode(o.unref(n.NResult),{status:"404",title:"未找到包裹",description:x.value},{footer:o.withCtx(()=>[o.createVNode(o.unref(n.NButton),{onClick:h},{default:o.withCtx(()=>[...t[6]||(t[6]=[o.createTextVNode("重新查询",-1)])]),_:1})]),_:1},8,["description"])])):o.createCommentVNode("",!0)]),_:1})]));}});},"3d2274bb":function e(e,t,o,l){e._m(t),o("2d08c2e5"),o("a3876e70"),o("c550eeaa");var a=o("9aaf3498"),n=o("9aaf3498"),r=o("9aaf3498"),i=o("a0cf2c50"),c=o("69191e11"),s=o("1f6a8afd"),d=o("8a685886"),u={class:"header-content"},p={class:"hero-section"},N={class:"statistics-section"},f={class:"section"},m={class:"feature-icon"},h={class:"feature-title"},V={class:"feature-description"},v={class:"section"},k={class:"service-icon"},C={class:"service-title"},g={class:"service-description"},x={key:0,class:"cta-section"};t.default=a.defineComponent({__name:"Home",setup(e){var t=i.useRouter(),o=c.useUserStore();s.useMessage(),o.initFromStorage();var l=r.computed(()=>o.isLoggedIn),a=r.computed(()=>o.userInfo),y=[{label:"个人中心",key:"profile"},{label:"退出登录",key:"logout"}],E=e=>{"logout"===e?(o.logout(),t.push("/")):"profile"===e&&t.push("/profile");},w=[{label:"配送点",value:"15"},{label:"注册用户",value:"5,680"},{label:"今日配送",value:"328"},{label:"累计配送",value:"156,892"}],B=[{title:"快速配送",description:"校内1小时送达，高效的物流配送网络覆盖校园每个角落",icon:d.SpeedometerOutline},{title:"安全可靠",description:"专业团队配送，实名认证，全程监控，保障包裹安全",icon:d.ShieldCheckmarkOutline},{title:"便捷取件",description:"多个自提点位，支持预约取件，随时随地轻松取件",icon:d.LocationOutline},{title:"实时追踪",description:"包裹状态实时更新，配送进度一目了然",icon:d.NotificationsOutline}],_=[{title:"包裹配送",description:"快递包裹统一配送服务，支持宿舍、教学楼等多种地址配送",icon:d.CubeOutline},{title:"暂存服务",description:"临时外出？我们提供安全的包裹暂存服务，随到随取",icon:d.ArchiveOutline},{title:"配送追踪",description:"实时查看包裹位置和配送进度，掌握每一个配送环节",icon:d.LocationOutline},{title:"到件通知",description:"包裹到达及时提醒，支持短信、微信等多种通知方式",icon:d.TimeOutline}];return(e,o)=>(n.openBlock(),n.createBlock(n.unref(s.NLayout),{style:{width:"100%","min-height":"100vh"}},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NLayoutHeader),{class:"header"},{default:n.withCtx(()=>[n.createElementVNode("div",u,[o[6]||(o[6]=n.createElementVNode("div",{class:"logo"},"校园物流系统",-1)),l.value?(n.openBlock(),n.createBlock(n.unref(s.NDropdown),{key:1,options:y,onSelect:E},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NButton),null,{icon:n.withCtx(()=>[n.createVNode(n.unref(s.NIcon),{component:n.unref(d.PersonOutline)},null,8,["component"])]),default:n.withCtx(()=>{var e,t;return[n.createTextVNode(" "+n.toDisplayString((null===(e=a.value)||void 0===e?void 0:e.realName)||(null===(t=a.value)||void 0===t?void 0:t.username)),1)];}),_:1})]),_:1})):(n.openBlock(),n.createBlock(n.unref(s.NSpace),{key:0},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NButton),{onClick:o[0]||(o[0]=e=>n.unref(t).push("/login"))},{default:n.withCtx(()=>[...o[4]||(o[4]=[n.createTextVNode("登录",-1)])]),_:1}),n.createVNode(n.unref(s.NButton),{type:"primary",onClick:o[1]||(o[1]=e=>n.unref(t).push("/register"))},{default:n.withCtx(()=>[...o[5]||(o[5]=[n.createTextVNode("注册",-1)])]),_:1})]),_:1}))])]),_:1}),n.createVNode(n.unref(s.NLayoutContent),{"content-style":"padding: 24px;"},{default:n.withCtx(()=>[n.createElementVNode("div",p,[o[8]||(o[8]=n.createElementVNode("h1",{class:"hero-title"},"便捷、高效、安全的校园物流服务",-1)),o[9]||(o[9]=n.createElementVNode("p",{class:"hero-description"},"让每一个包裹都能准时送达，让每一次配送都充满信赖",-1)),l.value?n.createCommentVNode("",!0):(n.openBlock(),n.createBlock(n.unref(s.NButton),{key:0,type:"primary",size:"large",onClick:o[2]||(o[2]=e=>n.unref(t).push("/register"))},{default:n.withCtx(()=>[...o[7]||(o[7]=[n.createTextVNode(" 立即开始 ",-1)])]),_:1}))]),n.createElementVNode("div",N,[n.createVNode(n.unref(s.NGrid),{"x-gap":24,"y-gap":24,cols:4,responsive:"screen"},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock(n.Fragment,null,n.renderList(w,e=>n.createVNode(n.unref(s.NGridItem),{key:e.label},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NStatistic),{label:e.label,value:e.value},null,8,["label","value"])]),_:2},1024)),64))]),_:1})]),n.createElementVNode("div",f,[o[10]||(o[10]=n.createElementVNode("h2",{class:"section-title"},"为什么选择我们？",-1)),n.createVNode(n.unref(s.NGrid),{"x-gap":24,"y-gap":24,cols:4,responsive:"screen"},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock(n.Fragment,null,n.renderList(B,e=>n.createVNode(n.unref(s.NGridItem),{key:e.title},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NCard),{class:"feature-card"},{default:n.withCtx(()=>[n.createElementVNode("div",m,[n.createVNode(n.unref(s.NIcon),{component:e.icon,size:32},null,8,["component"])]),n.createElementVNode("h3",h,n.toDisplayString(e.title),1),n.createElementVNode("p",V,n.toDisplayString(e.description),1)]),_:2},1024)]),_:2},1024)),64))]),_:1})]),n.createElementVNode("div",v,[o[11]||(o[11]=n.createElementVNode("h2",{class:"section-title"},"主要服务",-1)),n.createVNode(n.unref(s.NGrid),{"x-gap":24,"y-gap":24,cols:4,responsive:"screen"},{default:n.withCtx(()=>[(n.openBlock(),n.createElementBlock(n.Fragment,null,n.renderList(_,e=>n.createVNode(n.unref(s.NGridItem),{key:e.title},{default:n.withCtx(()=>[n.createVNode(n.unref(s.NCard),{class:"service-card"},{default:n.withCtx(()=>[n.createElementVNode("div",k,[n.createVNode(n.unref(s.NIcon),{component:e.icon,size:32},null,8,["component"])]),n.createElementVNode("h3",C,n.toDisplayString(e.title),1),n.createElementVNode("p",g,n.toDisplayString(e.description),1)]),_:2},1024)]),_:2},1024)),64))]),_:1})]),l.value?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",x,[o[13]||(o[13]=n.createElementVNode("h2",{class:"cta-title"},"准备好开始了吗？",-1)),o[14]||(o[14]=n.createElementVNode("p",{class:"cta-description"},"注册账号，即刻体验便捷的校园物流服务",-1)),n.createVNode(n.unref(s.NButton),{type:"primary",size:"large",onClick:o[3]||(o[3]=e=>n.unref(t).push("/register"))},{default:n.withCtx(()=>[...o[12]||(o[12]=[n.createTextVNode("立即注册",-1)])]),_:1})]))]),_:1})]),_:1}));}});},"64c6cf1d":function e(e,t,a,l){e._m(t),a("2d08c2e5"),a("a3876e70"),a("db38ec0f");var r=a("9aaf3498"),n=a("9aaf3498"),d=a("9aaf3498"),o=a("a0cf2c50"),u=a("69191e11"),c=a("1f6a8afd"),i=a("d8dfe26b"),s=a("d8dfe26b"),f=a("2025bacc"),N=e.i(a("51231a61")),v=e.i(a("7080d915")),m={class:"dashboard-container"},p={key:0,class:"not-logged-in"},h={key:1},V={key:0,class:"statistics-section"},C={class:"section"},g={class:"section-header"},y={key:0,class:"empty-state"},_={class:"section"},x={class:"section-header"},k={key:0,class:"empty-state"};t.default=r.defineComponent({__name:"Dashboard",setup(t){var a=o.useRouter(),l=u.useUserStore(),r=c.useMessage();l.initFromStorage();var w=d.ref(!1),B=d.ref(null),E=d.ref([]),b=d.ref([]),S=d.computed(()=>l.isLoggedIn),I=d.computed(()=>l.userInfo),G=d.computed(()=>{var e,t=null===(e=I.value)||void 0===e?void 0:e.role;return"staff"===t||"admin"===t;}),M=async()=>{w.value=!0;try{if(G.value){var e=await i.getDashboardStatistics();0===e.code&&e.data&&(B.value=e.data);}var t=await s.getMyParcels({page:1,page_size:5});0===t.code&&t.data&&(E.value=t.data.list);var a=await f.getMyShipments({page:1,page_size:5});0===a.code&&a.data&&(b.value=a.data.list);}catch(e){r.error("加载数据失败");}finally{w.value=!1;}};return d.onMounted(()=>{S.value&&M();}),(t,l)=>(n.openBlock(),n.createElementBlock("div",m,[S.value?(n.openBlock(),n.createElementBlock("div",h,[G.value&&B.value?(n.openBlock(),n.createElementBlock("div",V,[l[5]||(l[5]=n.createElementVNode("h3",null,"今日数据",-1)),n.createVNode(n.unref(c.NGrid),{"x-gap":24,"y-gap":24,cols:4},{default:n.withCtx(()=>[n.createVNode(n.unref(c.NGridItem),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NStatistic),{label:"今日入库",value:B.value.today.received_count},null,8,["value"])]),_:1})]),_:1}),n.createVNode(n.unref(c.NGridItem),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NStatistic),{label:"今日取件",value:B.value.today.picked_up_count},null,8,["value"])]),_:1})]),_:1}),n.createVNode(n.unref(c.NGridItem),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NStatistic),{label:"滞留包裹",value:B.value.today.overdue_count},null,8,["value"])]),_:1})]),_:1}),n.createVNode(n.unref(c.NGridItem),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(n.unref(c.NStatistic),{label:"货架使用率"},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString((B.value.shelves.utilization_rate||0).toFixed(1))+"% ",1)]),_:1})]),_:1})]),_:1})]),_:1})])):n.createCommentVNode("",!0),n.createElementVNode("div",C,[n.createElementVNode("div",g,[l[7]||(l[7]=n.createElementVNode("h3",null,"我的包裹",-1)),n.createVNode(n.unref(c.NButton),{text:"",type:"primary",onClick:l[1]||(l[1]=e=>n.unref(a).push("/my-parcels"))},{default:n.withCtx(()=>[...l[6]||(l[6]=[n.createTextVNode(" 查看全部 ",-1)])]),_:1})]),n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(e.f(N),{parcels:E.value,loading:w.value,compact:"",pagination:!1},null,8,["parcels","loading"]),0!==E.value.length||w.value?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",y," 暂无包裹 "))]),_:1})]),n.createElementVNode("div",_,[n.createElementVNode("div",x,[l[9]||(l[9]=n.createElementVNode("h3",null,"我的寄件",-1)),n.createVNode(n.unref(c.NButton),{text:"",type:"primary",onClick:l[2]||(l[2]=e=>n.unref(a).push("/my-shipments"))},{default:n.withCtx(()=>[...l[8]||(l[8]=[n.createTextVNode(" 查看全部 ",-1)])]),_:1})]),n.createVNode(n.unref(c.NCard),null,{default:n.withCtx(()=>[n.createVNode(e.f(v),{shipments:b.value,loading:w.value,compact:"",pagination:!1},null,8,["shipments","loading"]),0!==b.value.length||w.value?n.createCommentVNode("",!0):(n.openBlock(),n.createElementBlock("div",k," 暂无寄件记录 "))]),_:1})])])):(n.openBlock(),n.createElementBlock("div",p,[l[4]||(l[4]=n.createElementVNode("h2",null,"请先登录",-1)),n.createVNode(n.unref(c.NButton),{type:"primary",onClick:l[0]||(l[0]=e=>n.unref(a).push("/login")),style:{"margin-top":"16px"}},{default:n.withCtx(()=>[...l[3]||(l[3]=[n.createTextVNode(" 前往登录 ",-1)])]),_:1})]))]));}});},"6e9a68c3":function e(e,a,t,l){e._m(a),t("2d08c2e5"),t("a3876e70");var r=t("9aaf3498"),u=t("9aaf3498"),o=t("9aaf3498"),n=t("1f6a8afd"),i=t("d8dfe26b"),d=t("b90d6007"),c=t("704cb3d6"),v=e.i(t("51231a61")),p={class:"page-container"};a.default=r.defineComponent({__name:"ParcelManagement",setup(a){var t=n.useMessage(),l=o.ref(!1),r=o.ref([]),f=o.ref(0),s=o.ref(1),N=o.ref(20),h=o.ref(""),_=o.ref(!1),m=o.ref(!1),w=o.ref({tracking_number:"",recipient_name:"",recipient_phone:"",recipient_id_card:"",courier_company:"",size:"small",weight:1,notes:""}),V=o.ref(!1),x=o.ref(!1),C=o.ref({pickup_code:"",recipient_phone:""}),g=[{label:"小",value:"small"},{label:"中",value:"medium"},{label:"大",value:"large"}],b=d.COURIER_COMPANIES.map(e=>({label:e,value:e})),y=async()=>{l.value=!0;var e=await i.getParcelList({status:h.value||void 0,page:s.value,page_size:N.value});0===e.code&&e.data?(r.value=e.data.list,f.value=e.data.pagination.total):t.error(e.message||"加载失败"),l.value=!1;},k=()=>{w.value={tracking_number:"",recipient_name:"",recipient_phone:"",recipient_id_card:"",courier_company:"",size:"small",weight:1,notes:""},_.value=!0;},I=async(e,a)=>{if("shelve"===e){var l,r,u=await i.shelveParcel(a.id);0===u.code?(t.success("上架成功！货架位置：".concat(null===(r=u.data)||void 0===r?void 0:null===(l=r.shelf)||void 0===l?void 0:l.shelf_code)),y()):t.error(u.message||"上架失败");}},U=async()=>{if(!m.value){if(!w.value.tracking_number){t.error("请输入快递单号");return;}if(!w.value.recipient_name){t.error("请输入收件人姓名");return;}if(!w.value.recipient_phone){t.error("请输入收件人电话");return;}if(!w.value.courier_company){t.error("请选择快递公司");return;}m.value=!0;var e,a=await i.receiveParcel(w.value);0===a.code?(t.success("入库成功！取件码：".concat(null===(e=a.data)||void 0===e?void 0:e.pickup_code)),_.value=!1,y()):t.error(a.message||"入库失败"),m.value=!1;}},S=()=>{C.value={pickup_code:"",recipient_phone:""},V.value=!0;},F=async()=>{if(!x.value){if(!C.value.pickup_code){t.error("请输入取件码");return;}if(!C.value.recipient_phone){t.error("请输入手机号");return;}x.value=!0;var e=await i.pickupParcel(C.value);0===e.code?(t.success("取件成功"),V.value=!1,y()):t.error(e.message||"取件失败"),x.value=!1;}},z=e=>{s.value=e,y();},T=e=>{N.value=e,s.value=1,y();},q=()=>{s.value=1,y();};return o.onMounted(()=>{y();}),(a,t)=>(u.openBlock(),u.createElementBlock("div",p,[u.createVNode(u.unref(n.NCard),{title:"包裹管理"},{"header-extra":u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),null,{default:u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{type:"primary",onClick:k},{default:u.withCtx(()=>[...t[15]||(t[15]=[u.createTextVNode("包裹入库",-1)])]),_:1}),u.createVNode(u.unref(n.NButton),{type:"success",onClick:S},{default:u.withCtx(()=>[...t[16]||(t[16]=[u.createTextVNode("包裹取件",-1)])]),_:1})]),_:1})]),default:u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),{style:{"margin-bottom":"16px"}},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NSelect),{value:h.value,"onUpdate:value":[t[0]||(t[0]=e=>h.value=e),q],options:u.unref(c.PARCEL_STATUS_OPTIONS),placeholder:"状态筛选",style:{width:"150px"}},null,8,["value","options"])]),_:1}),u.createVNode(e.f(v),{parcels:r.value,loading:l.value,"show-id":"","show-recipient":"","show-actions":"","scroll-x":1200,pagination:{page:s.value,pageSize:N.value,total:f.value,onChange:z,onSizeChange:T},onAction:I},null,8,["parcels","loading","pagination"])]),_:1}),u.createVNode(u.unref(n.NModal),{show:_.value,"onUpdate:show":t[10]||(t[10]=e=>_.value=e),preset:"card",title:"包裹入库",style:{width:"600px"},"mask-closable":!1},{footer:u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),{justify:"end"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{onClick:t[9]||(t[9]=e=>_.value=!1)},{default:u.withCtx(()=>[...t[17]||(t[17]=[u.createTextVNode("取消",-1)])]),_:1}),u.createVNode(u.unref(n.NButton),{type:"primary",loading:m.value,onClick:U},{default:u.withCtx(()=>[...t[18]||(t[18]=[u.createTextVNode("确认入库",-1)])]),_:1},8,["loading"])]),_:1})]),default:u.withCtx(()=>[u.createVNode(u.unref(n.NForm),{model:w.value,"label-placement":"left","label-width":"110"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NFormItem),{label:"快递单号",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.tracking_number,"onUpdate:value":t[1]||(t[1]=e=>w.value.tracking_number=e),placeholder:"请输入快递单号"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"收件人姓名",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.recipient_name,"onUpdate:value":t[2]||(t[2]=e=>w.value.recipient_name=e),placeholder:"请输入收件人姓名"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"收件人电话",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.recipient_phone,"onUpdate:value":t[3]||(t[3]=e=>w.value.recipient_phone=e),placeholder:"请输入收件人电话"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"身份证号"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.recipient_id_card,"onUpdate:value":t[4]||(t[4]=e=>w.value.recipient_id_card=e),placeholder:"选填"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"快递公司",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NSelect),{value:w.value.courier_company,"onUpdate:value":t[5]||(t[5]=e=>w.value.courier_company=e),options:u.unref(b),placeholder:"请选择快递公司"},null,8,["value","options"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"包裹尺寸",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NSelect),{value:w.value.size,"onUpdate:value":t[6]||(t[6]=e=>w.value.size=e),options:g,placeholder:"请选择包裹尺寸"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"重量 (kg)",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInputNumber),{value:w.value.weight,"onUpdate:value":t[7]||(t[7]=e=>w.value.weight=e),min:.1,max:50,step:.1,style:{width:"100%"}},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"备注"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.notes,"onUpdate:value":t[8]||(t[8]=e=>w.value.notes=e),type:"textarea",placeholder:"选填",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"]),u.createVNode(u.unref(n.NModal),{show:V.value,"onUpdate:show":t[14]||(t[14]=e=>V.value=e),preset:"card",title:"包裹取件",style:{width:"500px"},"mask-closable":!1},{footer:u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),{justify:"end"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{onClick:t[13]||(t[13]=e=>V.value=!1)},{default:u.withCtx(()=>[...t[19]||(t[19]=[u.createTextVNode("取消",-1)])]),_:1}),u.createVNode(u.unref(n.NButton),{type:"primary",loading:x.value,onClick:F},{default:u.withCtx(()=>[...t[20]||(t[20]=[u.createTextVNode("确认取件",-1)])]),_:1},8,["loading"])]),_:1})]),default:u.withCtx(()=>[u.createVNode(u.unref(n.NForm),{model:C.value,"label-placement":"left","label-width":"80"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NFormItem),{label:"取件码",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:C.value.pickup_code,"onUpdate:value":t[11]||(t[11]=e=>C.value.pickup_code=e),placeholder:"请输入取件码",size:"large"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"手机号",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:C.value.recipient_phone,"onUpdate:value":t[12]||(t[12]=e=>C.value.recipient_phone=e),placeholder:"请输入收件人手机号进行验证",size:"large"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]));}});},"6f9dc2f6":function e(e,a,r,t){e._m(a),r("850e6c49"),r("2d08c2e5"),r("a3876e70");var l=r("9aaf3498"),d=r("9aaf3498"),u=r("9aaf3498"),o=r("a0cf2c50"),s=r("1f6a8afd"),n=r("37ef8574"),i={class:"register-container"},c={class:"register-content"},m={class:"register-left"},p={class:"form-actions"},v={class:"form-links"},N={class:"link-text"};a.default=l.defineComponent({__name:"Register",setup(e){var a=o.useRouter(),r=s.useMessage(),t=u.ref(null),l=u.ref(!1),f=u.ref({username:"",password:"",confirmPassword:"",realName:"",phone:"",idCard:"",email:""}),g=!1,h=!1,V=!1,w=!1,C=!1,_=!0,x=!0,b={username:{required:!0,message:"请输入用户名（3-20位字母、数字或下划线）",trigger:["blur","input"],validator:(e,a)=>!!a&&(g=/^[a-zA-Z0-9_]{3,20}$/.test(a))},password:{required:!0,message:"请输入合法的密码（6-20位）",trigger:["blur","input"],validator:(e,a)=>h=a.length>=6&&a.length<=20},confirmPassword:{required:!0,message:"两次输入的密码不一致",trigger:["blur","input"],validator:(e,a)=>V=a===f.value.password},realName:{required:!0,message:"请输入真实姓名",trigger:["blur","input"],validator:(e,a)=>w=a.length>=2&&a.length<=20},phone:{required:!0,message:"请输入正确的手机号（1开头的11位数字）",trigger:["blur","input"],validator:(e,a)=>C=/^1[3-9]\d{9}$/.test(a)},idCard:{required:!1,message:"请输入正确的身份证号（18位）",trigger:["blur","input"],validator:(e,a)=>a?_=/^[1-9]\d{5}(19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]$/.test(a):(_=!0,!0)},email:{required:!1,message:"请输入正确的邮箱地址",trigger:["blur","input"],validator:(e,a)=>a?x=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/.test(a):(x=!0,!0)}},I=async()=>{if(!l.value){if(!g||!h||!V||!w||!C||!_||!x){r.error("请检查注册信息是否符合要求");return;}l.value=!0;var e=await n.register({username:f.value.username,password:f.value.password,realName:f.value.realName,phone:f.value.phone,idCard:f.value.idCard||void 0,email:f.value.email||void 0});0===e.code?(r.success("注册成功，即将跳转到登录页"),setTimeout(()=>{a.push("/login");},1500)):r.error(e.message||"注册失败，请重试"),setTimeout(()=>{l.value=!1;},1e3);}};return(e,a)=>{var r=d.resolveComponent("router-link");return d.openBlock(),d.createElementBlock("div",i,[d.createElementVNode("div",c,[d.createElementVNode("div",m,[d.createVNode(d.unref(s.NCard),{class:"register-card",bordered:!1},{default:d.withCtx(()=>[a[9]||(a[9]=d.createElementVNode("div",{class:"register-header"},[d.createElementVNode("h2",{class:"register-title"},"创建账号"),d.createElementVNode("p",{class:"register-subtitle"},"请填写以下信息完成注册")],-1)),d.createVNode(d.unref(s.NForm),{ref_key:"formRef",ref:t,model:f.value,"label-placement":"left","label-width":"0","require-mark-placement":"right-hanging",rules:b},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NFormItem),{path:"username"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.username,"onUpdate:value":a[0]||(a[0]=e=>f.value.username=e),placeholder:"用户名",size:"large"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"realName"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.realName,"onUpdate:value":a[1]||(a[1]=e=>f.value.realName=e),placeholder:"真实姓名",size:"large"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"phone"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.phone,"onUpdate:value":a[2]||(a[2]=e=>f.value.phone=e),placeholder:"手机号",size:"large"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"password"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.password,"onUpdate:value":a[3]||(a[3]=e=>f.value.password=e),type:"password",placeholder:"密码",size:"large","show-password-on":"click"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"confirmPassword"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.confirmPassword,"onUpdate:value":a[4]||(a[4]=e=>f.value.confirmPassword=e),type:"password",placeholder:"确认密码",size:"large","show-password-on":"click"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"idCard"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.idCard,"onUpdate:value":a[5]||(a[5]=e=>f.value.idCard=e),placeholder:"身份证号（选填）",size:"large"},null,8,["value"])]),_:1}),d.createVNode(d.unref(s.NFormItem),{path:"email"},{default:d.withCtx(()=>[d.createVNode(d.unref(s.NInput),{value:f.value.email,"onUpdate:value":a[6]||(a[6]=e=>f.value.email=e),placeholder:"邮箱（选填）",size:"large"},null,8,["value"])]),_:1}),d.createElementVNode("div",p,[d.createVNode(d.unref(s.NButton),{type:"primary",size:"large",block:"",loading:l.value,onClick:I},{default:d.withCtx(()=>[d.createTextVNode(d.toDisplayString(l.value?"注册中...":"注册"),1)]),_:1},8,["loading"])]),d.createElementVNode("div",v,[d.createElementVNode("p",N,[a[8]||(a[8]=d.createTextVNode(" 已有账号？ ",-1)),d.createVNode(r,{to:"/login",class:"link"},{default:d.withCtx(()=>[...a[7]||(a[7]=[d.createTextVNode("立即登录",-1)])]),_:1})])])]),_:1},8,["model"])]),_:1})]),a[10]||(a[10]=d.createElementVNode("div",{class:"register-right"},[d.createElementVNode("div",{class:"brand-content"},[d.createElementVNode("h1",{class:"brand-title"},"校园物流系统"),d.createElementVNode("p",{class:"brand-description"},"便捷、高效、安全的校园物流服务平台")])],-1))])]);};}});},"790b5d0e":function e(e,a,t,l){e._m(a),t("2d08c2e5"),t("a3876e70");var r=t("9aaf3498"),u=t("9aaf3498"),o=t("9aaf3498"),n=t("1f6a8afd"),i=t("2025bacc"),d=e.i(t("7080d915")),c={class:"page-container"},v={style:{"font-size":"20px",color:"#18a058"}};a.default=r.defineComponent({__name:"MyShipments",setup(a){var t=n.useMessage(),l=o.ref(!1),r=o.ref([]),p=o.ref(0),f=o.ref(1),m=o.ref(20),s=o.ref(!1),h=o.ref(!1),N=o.ref([]),_=o.ref(null),w=o.ref({recipient_name:"",recipient_phone:"",recipient_address:"",courier_company:"",weight:1,volume:.001}),g=async()=>{l.value=!0;var e=await i.getMyShipments({page:f.value,page_size:m.value});0===e.code&&e.data?(r.value=e.data.list,p.value=e.data.pagination.total):t.error(e.message||"加载失败"),l.value=!1;},y=async()=>{try{var e=await i.getCourierCompanies();0===e.code&&e.data&&(N.value=e.data);}catch(e){}},C=async()=>{if(w.value.courier_company&&w.value.weight&&w.value.volume)try{var e={courier_company:w.value.courier_company,weight:w.value.weight,volume:w.value.volume},a=await i.calculateFreight(e);0===a.code&&a.data&&(_.value=a.data.freight);}catch(e){}},x=()=>{w.value={recipient_name:"",recipient_phone:"",recipient_address:"",courier_company:"",weight:1,volume:.001},_.value=null,s.value=!0,y();},V=async()=>{if(!h.value){if(!w.value.recipient_name){t.error("请输入收件人姓名");return;}if(!w.value.recipient_phone){t.error("请输入收件人电话");return;}if(!w.value.recipient_address){t.error("请输入收件地址");return;}if(!w.value.courier_company){t.error("请选择快递公司");return;}h.value=!0;var e=await i.createShipment(w.value);0===e.code?(t.success("创建成功"),s.value=!1,g()):t.error(e.message||"创建失败"),h.value=!1;}},b=e=>{f.value=e,g();},I=e=>{m.value=e,f.value=1,g();};return o.onMounted(()=>{g();}),(a,t)=>(u.openBlock(),u.createElementBlock("div",c,[u.createVNode(u.unref(n.NCard),{title:"我的寄件"},{"header-extra":u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{type:"primary",onClick:x},{default:u.withCtx(()=>[...t[8]||(t[8]=[u.createTextVNode(" 创建寄件单 ",-1)])]),_:1})]),default:u.withCtx(()=>[u.createVNode(e.f(d),{shipments:r.value,loading:l.value,pagination:{page:f.value,pageSize:m.value,total:p.value,onChange:b,onSizeChange:I}},null,8,["shipments","loading","pagination"])]),_:1}),u.createVNode(u.unref(n.NModal),{show:s.value,"onUpdate:show":t[7]||(t[7]=e=>s.value=e),preset:"card",title:"创建寄件单",style:{width:"600px"},"mask-closable":!1},{footer:u.withCtx(()=>[u.createVNode(u.unref(n.NSpace),{justify:"end"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NButton),{onClick:t[6]||(t[6]=e=>s.value=!1)},{default:u.withCtx(()=>[...t[9]||(t[9]=[u.createTextVNode("取消",-1)])]),_:1}),u.createVNode(u.unref(n.NButton),{type:"primary",loading:h.value,onClick:V},{default:u.withCtx(()=>[...t[10]||(t[10]=[u.createTextVNode(" 创建 ",-1)])]),_:1},8,["loading"])]),_:1})]),default:u.withCtx(()=>[u.createVNode(u.unref(n.NForm),{model:w.value,"label-placement":"left","label-width":"100"},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NFormItem),{label:"收件人姓名",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.recipient_name,"onUpdate:value":t[0]||(t[0]=e=>w.value.recipient_name=e),placeholder:"请输入收件人姓名"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"收件人电话",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.recipient_phone,"onUpdate:value":t[1]||(t[1]=e=>w.value.recipient_phone=e),placeholder:"请输入收件人电话"},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"收件地址",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInput),{value:w.value.recipient_address,"onUpdate:value":t[2]||(t[2]=e=>w.value.recipient_address=e),type:"textarea",placeholder:"请输入详细地址",rows:3},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"快递公司",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NSelect),{value:w.value.courier_company,"onUpdate:value":[t[3]||(t[3]=e=>w.value.courier_company=e),C],options:N.value.map(e=>({label:e,value:e})),placeholder:"请选择快递公司"},null,8,["value","options"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"重量 (kg)",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInputNumber),{value:w.value.weight,"onUpdate:value":[t[4]||(t[4]=e=>w.value.weight=e),C],min:.1,max:50,step:.1,placeholder:"请输入重量",style:{width:"100%"}},null,8,["value"])]),_:1}),u.createVNode(u.unref(n.NFormItem),{label:"体积 (m³)",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(n.NInputNumber),{value:w.value.volume,"onUpdate:value":[t[5]||(t[5]=e=>w.value.volume=e),C],min:.001,max:1,step:.001,placeholder:"请输入体积",style:{width:"100%"}},null,8,["value"])]),_:1}),null!==_.value?(u.openBlock(),u.createBlock(u.unref(n.NFormItem),{key:0,label:"预估运费"},{default:u.withCtx(()=>[u.createElementVNode("strong",v,"¥"+u.toDisplayString(_.value),1)]),_:1})):u.createCommentVNode("",!0)]),_:1},8,["model"])]),_:1},8,["show"])]));}});},"df1164f8":function e(e,a,l,t){e._m(a),l("db38ec0f"),l("2d08c2e5"),l("a3876e70");var u=l("9aaf3498"),r=l("9aaf3498"),o=l("9aaf3498"),n=l("1f6a8afd"),d=l("33a636cf"),v=e.i(l("15b743bd")),i={class:"page-container"};a.default=u.defineComponent({__name:"ShelfManagement",setup(a){var l=n.useMessage(),t=o.ref(!1),u=o.ref([]),c=o.ref(0),f=o.ref(1),N=o.ref(20),s=o.ref(""),m=o.ref(""),p=o.ref(""),h=o.ref(null),w=o.ref(!1),V=o.ref("create"),b=o.ref(!1),x=o.ref(null),C=o.ref({shelf_code:"",area:"",floor:1,column:1,type:"small",capacity:20}),y=o.ref({}),_=[{label:"全部",value:""},{label:"A区",value:"A"},{label:"B区",value:"B"},{label:"C区",value:"C"}],g=[{label:"全部",value:""},{label:"小件",value:"small"},{label:"中件",value:"medium"},{label:"大件",value:"large"}],S=[{label:"全部",value:""},{label:"启用",value:"active"},{label:"停用",value:"inactive"}],I=e=>e>=90?"#f5222d":e>=70?"#fa8c16":e>=30?"#52c41a":"#1890ff",F=async()=>{t.value=!0;var e=await d.getShelfList({area:s.value||void 0,type:m.value||void 0,status:p.value||void 0,page:f.value,page_size:N.value});0===e.code&&e.data?(u.value=e.data.list,c.value=e.data.pagination.total):l.error(e.message||"加载失败"),t.value=!1;},U=async()=>{try{var e=await d.getShelfStatistics();0===e.code&&e.data&&(h.value=e.data);}catch(e){console.error("Failed to load statistics",e);}},k=()=>{V.value="create",C.value={shelf_code:"",area:"",floor:1,column:1,type:"small",capacity:20},w.value=!0;},B=e=>{V.value="edit",x.value=e.id,y.value={area:e.area,floor:e.floor,column:e.column,type:e.type,capacity:e.capacity,status:e.status},w.value=!0;},q=async()=>{if(!b.value){if(b.value=!0,"create"===V.value){if(!C.value.shelf_code||!C.value.area){l.error("请填写完整信息"),b.value=!1;return;}var e=await d.createShelf(C.value);0===e.code?(l.success("创建成功"),w.value=!1,F(),U()):l.error(e.message||"创建失败");}else{if(!x.value){b.value=!1;return;}var a=await d.updateShelf(x.value,y.value);0===a.code?(l.success("更新成功"),w.value=!1,F(),U()):l.error(a.message||"更新失败");}b.value=!1;}},z=async e=>{var a=await d.deleteShelf(e.id);0===a.code?(l.success("删除成功"),F(),U()):l.error(a.message||"删除失败");},G=e=>{f.value=e,F();},A=e=>{N.value=e,f.value=1,F();},M=()=>{f.value=1,F();};return o.onMounted(()=>{F(),U();}),(a,l)=>(r.openBlock(),r.createElementBlock("div",i,[r.createVNode(r.unref(n.NGrid),{cols:4,"x-gap":16,style:{"margin-bottom":"16px"}},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NGi),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NCard),null,{default:r.withCtx(()=>{var e;return[r.createVNode(r.unref(n.NStatistic),{label:"总货架数",value:(null===(e=h.value)||void 0===e?void 0:e.total_shelves)||0},null,8,["value"])];}),_:1})]),_:1}),r.createVNode(r.unref(n.NGi),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NCard),null,{default:r.withCtx(()=>{var e;return[r.createVNode(r.unref(n.NStatistic),{label:"启用货架",value:(null===(e=h.value)||void 0===e?void 0:e.active_shelves)||0},null,8,["value"])];}),_:1})]),_:1}),r.createVNode(r.unref(n.NGi),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NCard),null,{default:r.withCtx(()=>{var e;return[r.createVNode(r.unref(n.NStatistic),{label:"总容量",value:(null===(e=h.value)||void 0===e?void 0:e.total_capacity)||0},null,8,["value"])];}),_:1})]),_:1}),r.createVNode(r.unref(n.NGi),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NCard),null,{default:r.withCtx(()=>[r.createVNode(r.unref(n.NStatistic),{label:"总使用率"},{default:r.withCtx(()=>{var e,a;return[r.createElementVNode("span",{style:r.normalizeStyle({color:I((null===(e=h.value)||void 0===e?void 0:e.utilization_rate)||0)})},r.toDisplayString(((null===(a=h.value)||void 0===a?void 0:a.utilization_rate)||0).toFixed(1))+"% ",5)];}),_:1})]),_:1})]),_:1})]),_:1}),r.createVNode(r.unref(n.NCard),{title:"货架管理"},{"header-extra":r.withCtx(()=>[r.createVNode(r.unref(n.NButton),{type:"primary",onClick:k},{default:r.withCtx(()=>[...l[17]||(l[17]=[r.createTextVNode("新增货架",-1)])]),_:1})]),default:r.withCtx(()=>[r.createVNode(r.unref(n.NSpace),{style:{"margin-bottom":"16px"}},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NSelect),{value:s.value,"onUpdate:value":[l[0]||(l[0]=e=>s.value=e),M],options:_,placeholder:"区域",style:{width:"100px"}},null,8,["value"]),r.createVNode(r.unref(n.NSelect),{value:m.value,"onUpdate:value":[l[1]||(l[1]=e=>m.value=e),M],options:g,placeholder:"类型",style:{width:"100px"}},null,8,["value"]),r.createVNode(r.unref(n.NSelect),{value:p.value,"onUpdate:value":[l[2]||(l[2]=e=>p.value=e),M],options:S,placeholder:"状态",style:{width:"100px"}},null,8,["value"])]),_:1}),r.createVNode(e.f(v),{shelves:u.value,loading:t.value,pagination:{page:f.value,pageSize:N.value,total:c.value,onChange:G,onSizeChange:A},onEdit:B,onDelete:z},null,8,["shelves","loading","pagination"])]),_:1}),r.createVNode(r.unref(n.NModal),{show:w.value,"onUpdate:show":l[16]||(l[16]=e=>w.value=e),preset:"card",title:"create"===V.value?"新增货架":"编辑货架",style:{width:"500px"},"mask-closable":!1},{footer:r.withCtx(()=>[r.createVNode(r.unref(n.NSpace),{justify:"end"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NButton),{onClick:l[15]||(l[15]=e=>w.value=!1)},{default:r.withCtx(()=>[...l[18]||(l[18]=[r.createTextVNode("取消",-1)])]),_:1}),r.createVNode(r.unref(n.NButton),{type:"primary",loading:b.value,onClick:q},{default:r.withCtx(()=>[...l[19]||(l[19]=[r.createTextVNode("确认",-1)])]),_:1},8,["loading"])]),_:1})]),default:r.withCtx(()=>["create"===V.value?(r.openBlock(),r.createBlock(r.unref(n.NForm),{key:0,model:C.value,"label-placement":"left","label-width":"80"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NFormItem),{label:"货架编码",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInput),{value:C.value.shelf_code,"onUpdate:value":l[3]||(l[3]=e=>C.value.shelf_code=e),placeholder:"如 A-1-1"},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"区域",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInput),{value:C.value.area,"onUpdate:value":l[4]||(l[4]=e=>C.value.area=e),placeholder:"如 A、B、C"},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"层",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:C.value.floor,"onUpdate:value":l[5]||(l[5]=e=>C.value.floor=e),min:1,max:10,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"列",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:C.value.column,"onUpdate:value":l[6]||(l[6]=e=>C.value.column=e),min:1,max:20,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"类型",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NSelect),{value:C.value.type,"onUpdate:value":l[7]||(l[7]=e=>C.value.type=e),options:[{label:"小件",value:"small"},{label:"中件",value:"medium"},{label:"大件",value:"large"}]},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"容量",required:""},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:C.value.capacity,"onUpdate:value":l[8]||(l[8]=e=>C.value.capacity=e),min:1,max:100,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1},8,["model"])):(r.openBlock(),r.createBlock(r.unref(n.NForm),{key:1,model:y.value,"label-placement":"left","label-width":"80"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NFormItem),{label:"区域"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInput),{value:y.value.area,"onUpdate:value":l[9]||(l[9]=e=>y.value.area=e)},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"层"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:y.value.floor,"onUpdate:value":l[10]||(l[10]=e=>y.value.floor=e),min:1,max:10,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"列"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:y.value.column,"onUpdate:value":l[11]||(l[11]=e=>y.value.column=e),min:1,max:20,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"类型"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NSelect),{value:y.value.type,"onUpdate:value":l[12]||(l[12]=e=>y.value.type=e),options:[{label:"小件",value:"small"},{label:"中件",value:"medium"},{label:"大件",value:"large"}]},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"容量"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NInputNumber),{value:y.value.capacity,"onUpdate:value":l[13]||(l[13]=e=>y.value.capacity=e),min:1,max:100,style:{width:"100%"}},null,8,["value"])]),_:1}),r.createVNode(r.unref(n.NFormItem),{label:"状态"},{default:r.withCtx(()=>[r.createVNode(r.unref(n.NSelect),{value:y.value.status,"onUpdate:value":l[14]||(l[14]=e=>y.value.status=e),options:[{label:"启用",value:"active"},{label:"停用",value:"inactive"}]},null,8,["value"])]),_:1})]),_:1},8,["model"]))]),_:1},8,["show","title"])]));}});},"e9accfd2":function e(e,a,t,l){e._m(a),t("2d08c2e5"),t("a3876e70");var r=t("9aaf3498"),u=t("9aaf3498"),o=t("9aaf3498"),i=t("a0cf2c50"),n=t("69191e11"),d=t("1f6a8afd"),c=t("37ef8574"),f={class:"page-container"},N={key:0},v={key:1};a.default=r.defineComponent({__name:"Profile",setup(e){var a=i.useRouter(),t=n.useUserStore(),l=d.useMessage(),r=o.ref(!1),m=o.ref(!1),s=o.ref(null),p=o.ref({realName:"",email:""}),x={user:{text:"用户",type:"default"},staff:{text:"员工",type:"info"},admin:{text:"管理员",type:"success"}},V=async()=>{r.value=!0;var e=await c.getProfile();0===e.code&&e.data?(s.value=e.data,p.value={realName:e.data.realName,email:e.data.email||""}):l.error(e.message||"加载失败"),r.value=!1;},C=()=>{s.value&&(p.value={realName:s.value.realName,email:s.value.email||""}),m.value=!0;},y=()=>{m.value=!1;},h=async()=>{if(!r.value){if(!p.value.realName){l.error("请输入真实姓名");return;}r.value=!0;var e=await c.updateProfile(p.value);0===e.code?(l.success("更新成功"),m.value=!1,s.value&&(s.value.realName=p.value.realName,s.value.email=p.value.email,t.setUserInfo(s.value)),V()):l.error(e.message||"更新失败"),r.value=!1;}},w=()=>{t.logout(),l.success("已退出登录"),a.push("/");};return o.onMounted(()=>{V();}),(e,a)=>(u.openBlock(),u.createElementBlock("div",f,[u.createVNode(u.unref(d.NCard),{title:"个人中心",style:{"max-width":"800px",margin:"0 auto"}},{default:u.withCtx(()=>[!m.value&&s.value?(u.openBlock(),u.createElementBlock("div",N,[u.createVNode(u.unref(d.NDescriptions),{"label-placement":"left",column:1,bordered:""},{default:u.withCtx(()=>[u.createVNode(u.unref(d.NDescriptionsItem),{label:"用户名"},{default:u.withCtx(()=>[u.createTextVNode(u.toDisplayString(s.value.username),1)]),_:1}),u.createVNode(u.unref(d.NDescriptionsItem),{label:"真实姓名"},{default:u.withCtx(()=>[u.createTextVNode(u.toDisplayString(s.value.realName),1)]),_:1}),u.createVNode(u.unref(d.NDescriptionsItem),{label:"手机号"},{default:u.withCtx(()=>[u.createTextVNode(u.toDisplayString(s.value.phone),1)]),_:1}),u.createVNode(u.unref(d.NDescriptionsItem),{label:"邮箱"},{default:u.withCtx(()=>[u.createTextVNode(u.toDisplayString(s.value.email||"-"),1)]),_:1}),s.value.idCard?(u.openBlock(),u.createBlock(u.unref(d.NDescriptionsItem),{key:0,label:"身份证号"},{default:u.withCtx(()=>[u.createTextVNode(u.toDisplayString(s.value.idCard),1)]),_:1})):u.createCommentVNode("",!0),u.createVNode(u.unref(d.NDescriptionsItem),{label:"角色"},{default:u.withCtx(()=>{var e;return[u.createVNode(u.unref(d.NTag),{type:(null===(e=x[s.value.role])||void 0===e?void 0:e.type)||"default"},{default:u.withCtx(()=>{var e;return[u.createTextVNode(u.toDisplayString((null===(e=x[s.value.role])||void 0===e?void 0:e.text)||s.value.role),1)];}),_:1},8,["type"])];}),_:1})]),_:1}),u.createVNode(u.unref(d.NSpace),{style:{"margin-top":"24px"},justify:"center"},{default:u.withCtx(()=>[u.createVNode(u.unref(d.NButton),{type:"primary",onClick:C},{default:u.withCtx(()=>[...a[2]||(a[2]=[u.createTextVNode(" 编辑资料 ",-1)])]),_:1}),u.createVNode(u.unref(d.NButton),{onClick:w},{default:u.withCtx(()=>[...a[3]||(a[3]=[u.createTextVNode(" 退出登录 ",-1)])]),_:1})]),_:1})])):(u.openBlock(),u.createElementBlock("div",v,[u.createVNode(u.unref(d.NForm),{model:p.value,"label-placement":"left","label-width":"100"},{default:u.withCtx(()=>[u.createVNode(u.unref(d.NFormItem),{label:"真实姓名",required:""},{default:u.withCtx(()=>[u.createVNode(u.unref(d.NInput),{value:p.value.realName,"onUpdate:value":a[0]||(a[0]=e=>p.value.realName=e),placeholder:"请输入真实姓名"},null,8,["value"])]),_:1}),u.createVNode(u.unref(d.NFormItem),{label:"邮箱"},{default:u.withCtx(()=>[u.createVNode(u.unref(d.NInput),{value:p.value.email,"onUpdate:value":a[1]||(a[1]=e=>p.value.email=e),placeholder:"请输入邮箱"},null,8,["value"])]),_:1})]),_:1},8,["model"]),u.createVNode(u.unref(d.NSpace),{style:{"margin-top":"24px"},justify:"center"},{default:u.withCtx(()=>[u.createVNode(u.unref(d.NButton),{onClick:y},{default:u.withCtx(()=>[...a[4]||(a[4]=[u.createTextVNode(" 取消 ",-1)])]),_:1}),u.createVNode(u.unref(d.NButton),{type:"primary",loading:r.value,onClick:h},{default:u.withCtx(()=>[...a[5]||(a[5]=[u.createTextVNode(" 保存 ",-1)])]),_:1},8,["loading"])]),_:1})]))]),_:1})]));}});},});
//# sourceMappingURL=index_6272.a60e5b7c.js.map