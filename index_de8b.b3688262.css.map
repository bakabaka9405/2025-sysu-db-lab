{"version":3,"sources":["/src/App.vue","/src/views/Home.vue","/src/views/Login.vue","/src/views/Register.vue","/src/views/MainLayout.vue","/src/views/Dashboard.vue","/src/views/Search.vue","/src/views/MyParcels.vue","/src/views/MyShipments.vue","/src/views/ParcelManagement.vue","/src/views/ShelfManagement.vue","/src/views/OverdueManagement.vue","/src/views/Profile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { NMessageProvider, NDialogProvider, NNotificationProvider } from 'naive-ui'\n</script>\n\n<template>\n  <NMessageProvider>\n    <NDialogProvider>\n      <NNotificationProvider>\n        <router-view />\n      </NNotificationProvider>\n    </NDialogProvider>\n  </NMessageProvider>\n</template>\n\n<style>\nhtml,\nbody {\n  margin: 0;\n  padding: 0;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { computed } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useUserStore } from '../stores/user'\nimport {\n  NLayout,\n  NLayoutHeader,\n  NLayoutContent,\n  NButton,\n  NSpace,\n  NGrid,\n  NGridItem,\n  NStatistic,\n  NCard,\n  NIcon,\n  NDropdown,\n  useMessage\n} from 'naive-ui'\nimport {\n  CubeOutline,\n  LocationOutline,\n  TimeOutline,\n  ShieldCheckmarkOutline,\n  SpeedometerOutline,\n  NotificationsOutline,\n  ArchiveOutline,\n  PersonOutline\n} from '@vicons/ionicons5'\n\nconst router = useRouter()\nconst userStore = useUserStore()\nconst message = useMessage()\n\n// 初始化用户状态\nuserStore.initFromStorage()\n\n// 是否已登录\nconst isLoggedIn = computed(() => userStore.isLoggedIn)\nconst userInfo = computed(() => userStore.userInfo)\n\n// 用户下拉菜单选项\nconst userOptions = [\n  {\n    label: '个人中心',\n    key: 'profile'\n  },\n  {\n    label: '退出登录',\n    key: 'logout'\n  }\n]\n\n// 处理用户菜单选择\nconst handleUserMenuSelect = (key: string) => {\n  if (key === 'logout') {\n    userStore.logout()\n    router.push('/')\n  } else if (key === 'profile') {\n    router.push('/profile')\n  }\n}\n\n// 网站统计数据\nconst statistics = [\n  { label: '配送点', value: '15' },\n  { label: '注册用户', value: '5,680' },\n  { label: '今日配送', value: '328' },\n  { label: '累计配送', value: '156,892' }\n]\n\n// 产品特性数据\nconst features = [\n  {\n    title: '快速配送',\n    description: '校内1小时送达，高效的物流配送网络覆盖校园每个角落',\n    icon: SpeedometerOutline\n  },\n  {\n    title: '安全可靠',\n    description: '专业团队配送，实名认证，全程监控，保障包裹安全',\n    icon: ShieldCheckmarkOutline\n  },\n  {\n    title: '便捷取件',\n    description: '多个自提点位，支持预约取件，随时随地轻松取件',\n    icon: LocationOutline\n  },\n  {\n    title: '实时追踪',\n    description: '包裹状态实时更新，配送进度一目了然',\n    icon: NotificationsOutline\n  }\n]\n\n// 服务类型数据\nconst services = [\n  {\n    title: '包裹配送',\n    description: '快递包裹统一配送服务，支持宿舍、教学楼等多种地址配送',\n    icon: CubeOutline\n  },\n  {\n    title: '暂存服务',\n    description: '临时外出？我们提供安全的包裹暂存服务，随到随取',\n    icon: ArchiveOutline\n  },\n  {\n    title: '配送追踪',\n    description: '实时查看包裹位置和配送进度，掌握每一个配送环节',\n    icon: LocationOutline\n  },\n  {\n    title: '到件通知',\n    description: '包裹到达及时提醒，支持短信、微信等多种通知方式',\n    icon: TimeOutline\n  }\n]\n</script>\n\n<template>\n  <NLayout style=\"width: 100%; min-height: 100vh;\">\n    <!-- 页面顶部导航栏 -->\n    <NLayoutHeader class=\"header\">\n      <div class=\"header-content\">\n        <div class=\"logo\">校园物流系统</div>\n        <!-- 顶部导航按钮区域 -->\n        <NSpace v-if=\"!isLoggedIn\">\n          <NButton @click=\"router.push('/login')\">登录</NButton>\n          <NButton type=\"primary\" @click=\"router.push('/register')\">注册</NButton>\n        </NSpace>\n        <NDropdown v-else :options=\"userOptions\" @select=\"handleUserMenuSelect\">\n          <NButton>\n            <template #icon>\n              <NIcon :component=\"PersonOutline\" />\n            </template>\n            {{ userInfo?.realName || userInfo?.username }}\n          </NButton>\n        </NDropdown>\n      </div>\n    </NLayoutHeader>\n\n    <!-- 页面内容区域 -->\n    <NLayoutContent content-style=\"padding: 24px;\">\n      <!-- Hero Section -->\n      <div class=\"hero-section\">\n        <h1 class=\"hero-title\">便捷、高效、安全的校园物流服务</h1>\n        <p class=\"hero-description\">让每一个包裹都能准时送达，让每一次配送都充满信赖</p>\n        <NButton v-if=\"!isLoggedIn\" type=\"primary\" size=\"large\" @click=\"router.push('/register')\">\n          立即开始\n        </NButton>\n      </div>\n\n      <!-- 统计数据 -->\n      <div class=\"statistics-section\">\n        <NGrid :x-gap=\"24\" :y-gap=\"24\" :cols=\"4\" responsive=\"screen\">\n          <NGridItem v-for=\"stat in statistics\" :key=\"stat.label\">\n            <NStatistic :label=\"stat.label\" :value=\"stat.value\" />\n          </NGridItem>\n        </NGrid>\n      </div>\n\n      <!-- 产品特性部分 -->\n      <div class=\"section\">\n        <h2 class=\"section-title\">为什么选择我们？</h2>\n        <NGrid :x-gap=\"24\" :y-gap=\"24\" :cols=\"4\" responsive=\"screen\">\n          <NGridItem v-for=\"feature in features\" :key=\"feature.title\">\n            <NCard class=\"feature-card\">\n              <div class=\"feature-icon\">\n                <NIcon :component=\"feature.icon\" :size=\"32\" />\n              </div>\n              <h3 class=\"feature-title\">{{ feature.title }}</h3>\n              <p class=\"feature-description\">{{ feature.description }}</p>\n            </NCard>\n          </NGridItem>\n        </NGrid>\n      </div>\n\n      <!-- 主要功能 -->\n      <div class=\"section\">\n        <h2 class=\"section-title\">主要服务</h2>\n        <NGrid :x-gap=\"24\" :y-gap=\"24\" :cols=\"4\" responsive=\"screen\">\n          <NGridItem v-for=\"service in services\" :key=\"service.title\">\n            <NCard class=\"service-card\">\n              <div class=\"service-icon\">\n                <NIcon :component=\"service.icon\" :size=\"32\" />\n              </div>\n              <h3 class=\"service-title\">{{ service.title }}</h3>\n              <p class=\"service-description\">{{ service.description }}</p>\n            </NCard>\n          </NGridItem>\n        </NGrid>\n      </div>\n\n      <!-- 行动号召部分 -->\n      <div v-if=\"!isLoggedIn\" class=\"cta-section\">\n        <h2 class=\"cta-title\">准备好开始了吗？</h2>\n        <p class=\"cta-description\">注册账号，即刻体验便捷的校园物流服务</p>\n        <NButton type=\"primary\" size=\"large\" @click=\"router.push('/register')\">立即注册</NButton>\n      </div>\n    </NLayoutContent>\n  </NLayout>\n</template>\n\n<style scoped>\n/* 页面顶部导航栏样式 */\n.header {\n  height: 64px;\n  padding: 0 24px;\n  background-color: #fff;\n  border-bottom: 1px solid #eee;\n  width: 100%;\n  position: sticky;\n  top: 0;\n  z-index: 100;\n}\n\n/* 导航栏内容居中对齐 */\n.header-content {\n  height: 100%;\n  max-width: 1200px;\n  margin: 0 auto;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n/* Logo样式 */\n.logo {\n  font-size: 20px;\n  font-weight: bold;\n  color: #18a058;\n  letter-spacing: 1px;\n}\n\n/* Hero区域样式 */\n.hero-section {\n  max-width: 1200px;\n  margin: 48px auto;\n  text-align: center;\n  padding: 64px 24px;\n  background: linear-gradient(135deg, #36ad6a 0%, #18a058 100%);\n  border-radius: 16px;\n  color: white;\n}\n\n.hero-title {\n  font-size: 36px;\n  font-weight: bold;\n  margin: 0 0 16px;\n}\n\n.hero-description {\n  font-size: 18px;\n  margin: 0 0 32px;\n  opacity: 0.95;\n}\n\n/* 统计数据区域样式 */\n.statistics-section {\n  max-width: 1200px;\n  margin: 48px auto;\n  padding: 32px;\n  background: #fff;\n  border-radius: 12px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);\n}\n\n/* 通用内容区块样式 */\n.section {\n  max-width: 1200px;\n  margin: 48px auto;\n}\n\n/* 区块标题样式 */\n.section-title {\n  text-align: center;\n  font-size: 28px;\n  font-weight: 600;\n  margin-bottom: 40px;\n  color: #333;\n}\n\n/* 特性卡片和服务卡片通用样式 */\n.feature-card,\n.service-card {\n  text-align: center;\n  padding: 32px 24px;\n  height: 100%;\n  transition: all 0.3s ease;\n  cursor: pointer;\n}\n\n/* 卡片悬停效果 */\n.feature-card:hover,\n.service-card:hover {\n  transform: translateY(-8px);\n  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);\n}\n\n/* 卡片图标样式 */\n.feature-icon,\n.service-icon {\n  margin-bottom: 16px;\n  color: #18a058;\n  display: flex;\n  justify-content: center;\n}\n\n/* 卡片标题样式 */\n.feature-title,\n.service-title {\n  font-size: 18px;\n  font-weight: 600;\n  margin: 12px 0;\n  color: #333;\n}\n\n/* 卡片描述文字样式 */\n.feature-description,\n.service-description {\n  font-size: 14px;\n  color: #666;\n  margin: 0;\n  line-height: 1.6;\n}\n\n/* 行动号召区域样式 */\n.cta-section {\n  max-width: 1200px;\n  margin: 64px auto;\n  text-align: center;\n  padding: 64px 48px;\n  background: linear-gradient(135deg, #36ad6a 0%, #18a058 100%);\n  border-radius: 16px;\n  color: white;\n}\n\n/* 行动号召标题样式 */\n.cta-title {\n  font-size: 32px;\n  font-weight: bold;\n  margin: 0 0 16px;\n}\n\n/* 行动号召描述样式 */\n.cta-description {\n  font-size: 18px;\n  margin: 0 0 32px;\n  opacity: 0.95;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { NCard, NForm, NFormItem, NInput, NButton, useMessage } from 'naive-ui'\nimport { login } from '../api/user'\nimport { useUserStore } from '../stores/user'\n\nconst router = useRouter()\nconst message = useMessage()\nconst userStore = useUserStore()\n\nconst formRef = ref(null)\nconst loginLoading = ref(false)\n\nconst formValue = ref({\n  usernameOrPhone: '',\n  password: ''\n})\n\n/**\n * 表单验证规则\n * 支持用户名或手机号登录\n */\nconst rules = {\n  usernameOrPhone: {\n    required: true,\n    message: '请输入用户名或手机号',\n    trigger: ['blur', 'input'],\n    validator: (_rule: any, value: string) => {\n      if (!value) return false\n      // 验证手机号格式\n      const phoneRegex = /^1[3-9]\\d{9}$/\n      if (phoneRegex.test(value)) return true\n      // 验证用户名格式\n      const usernameRegex = /^[a-zA-Z0-9_]{3,20}$/\n      if (usernameRegex.test(value)) return true\n      return false\n    }\n  },\n  password: {\n    required: true,\n    message: '请输入密码',\n    trigger: ['blur', 'input']\n  }\n}\n\n/**\n * 处理用户登录\n */\nconst handleLogin = async () => {\n  if (loginLoading.value) return\n\n  loginLoading.value = true\n  const res = await login(formValue.value)\n\n  if (res.code === 0 && res.data) {\n    // 保存token和用户信息到store\n    userStore.setToken(res.data.accessToken)\n    userStore.setUserInfo(res.data.user)\n\n    message.success('登录成功')\n    router.push('/')\n  } else {\n    message.error(res.message || '用户名或密码错误')\n  }\n\n  setTimeout(() => {\n    loginLoading.value = false\n  }, 1000)\n}\n</script>\n\n<template>\n  <div class=\"login-container\">\n    <div class=\"login-content\">\n      <div class=\"login-left\">\n        <NCard class=\"login-card\" :bordered=\"false\">\n          <div class=\"login-header\">\n            <h2 class=\"login-title\">欢迎回来</h2>\n            <p class=\"login-subtitle\">请登录您的账号</p>\n          </div>\n\n          <NForm ref=\"formRef\" :model=\"formValue\" label-placement=\"left\" label-width=\"0\"\n            require-mark-placement=\"right-hanging\" :rules=\"rules\">\n            <NFormItem path=\"usernameOrPhone\">\n              <NInput v-model:value=\"formValue.usernameOrPhone\" placeholder=\"用户名或手机号\" size=\"large\" />\n            </NFormItem>\n\n            <NFormItem path=\"password\">\n              <NInput v-model:value=\"formValue.password\" type=\"password\" placeholder=\"密码\" size=\"large\"\n                show-password-on=\"click\" @keyup.enter=\"handleLogin\" />\n            </NFormItem>\n\n            <div class=\"form-actions\">\n              <NButton type=\"primary\" size=\"large\" block :loading=\"loginLoading\" @click=\"handleLogin\">\n                {{ loginLoading ? '登录中...' : '登录' }}\n              </NButton>\n            </div>\n\n            <div class=\"form-links\">\n              <p class=\"link-text\">\n                还没有账号？\n                <router-link to=\"/register\" class=\"link\">立即注册</router-link>\n              </p>\n            </div>\n          </NForm>\n        </NCard>\n      </div>\n\n      <div class=\"login-right\">\n        <div class=\"brand-content\">\n          <h1 class=\"brand-title\">校园物流系统</h1>\n          <p class=\"brand-description\">便捷、高效、安全的校园物流服务平台</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.login-container {\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: linear-gradient(135deg, #36ad6a 0%, #18a058 100%);\n}\n\n.login-content {\n  display: flex;\n  width: 1000px;\n  height: 600px;\n  background: rgba(255, 255, 255, 0.95);\n  border-radius: 16px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);\n  overflow: hidden;\n}\n\n.login-left {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 40px;\n}\n\n.login-card {\n  width: 100%;\n  max-width: 400px;\n  background: transparent;\n}\n\n.login-header {\n  text-align: center;\n  margin-bottom: 32px;\n}\n\n.login-title {\n  font-size: 24px;\n  color: #333;\n  margin: 0 0 8px;\n  font-weight: 600;\n}\n\n.login-subtitle {\n  font-size: 14px;\n  color: #666;\n  margin: 0;\n}\n\n.form-actions {\n  margin-top: 32px;\n}\n\n.form-links {\n  margin-top: 20px;\n  text-align: center;\n}\n\n.link-text {\n  font-size: 14px;\n  color: #666;\n  margin: 0;\n}\n\n.link {\n  color: #18a058;\n  text-decoration: none;\n  font-weight: 500;\n  transition: color 0.3s ease;\n}\n\n.link:hover {\n  color: #0c7a43;\n  text-decoration: underline;\n}\n\n.login-right {\n  flex: 1;\n  background: linear-gradient(135deg, #36ad6a 0%, #18a058 100%);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 40px;\n  color: white;\n  text-align: center;\n}\n\n.brand-title {\n  font-size: 48px;\n  font-weight: bold;\n  margin: 0 0 16px;\n  letter-spacing: 2px;\n}\n\n.brand-description {\n  font-size: 18px;\n  margin: 0;\n  opacity: 0.95;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { NCard, NForm, NFormItem, NInput, NButton, useMessage } from 'naive-ui'\nimport { register } from '../api/user'\n\nconst router = useRouter()\nconst message = useMessage()\nconst formRef = ref(null)\nconst registerLoading = ref(false)\n\nconst formValue = ref({\n  username: '',\n  password: '',\n  confirmPassword: '',\n  realName: '',\n  phone: '',\n  idCard: '',\n  email: ''\n})\n\n// 表单验证状态变量\nlet usernameValid = false\nlet passwordValid = false\nlet confirmPasswordValid = false\nlet realNameValid = false\nlet phoneValid = false\nlet idCardValid = true // 可选字段，默认有效\nlet emailValid = true // 可选字段，默认有效\n\n/**\n * 表单验证规则\n */\nconst rules = {\n  username: {\n    required: true,\n    message: '请输入用户名（3-20位字母、数字或下划线）',\n    trigger: ['blur', 'input'],\n    validator: (_rule: any, value: string) => {\n      if (!value) return false\n      const usernameRegex = /^[a-zA-Z0-9_]{3,20}$/\n      return usernameValid = usernameRegex.test(value)\n    }\n  },\n  password: {\n    required: true,\n    message: '请输入合法的密码（6-20位）',\n    trigger: ['blur', 'input'],\n    validator: (_rule: any, value: string) => {\n      return passwordValid = (value.length >= 6 && value.length <= 20)\n    }\n  },\n  confirmPassword: {\n    required: true,\n    message: '两次输入的密码不一致',\n    trigger: ['blur', 'input'],\n    validator: (_rule: any, value: string) => {\n      return confirmPasswordValid = (value === formValue.value.password)\n    }\n  },\n  realName: {\n    required: true,\n    message: '请输入真实姓名',\n    trigger: ['blur', 'input'],\n    validator: (_rule: any, value: string) => {\n      return realNameValid = (value.length >= 2 && value.length <= 20)\n    }\n  },\n  phone: {\n    required: true,\n    message: '请输入正确的手机号（1开头的11位数字）',\n    trigger: ['blur', 'input'],\n    validator: (_rule: any, value: string) => {\n      const phoneRegex = /^1[3-9]\\d{9}$/\n      return phoneValid = phoneRegex.test(value)\n    }\n  },\n  idCard: {\n    required: false,\n    message: '请输入正确的身份证号（18位）',\n    trigger: ['blur', 'input'],\n    validator: (_rule: any, value: string) => {\n      if (!value) {\n        idCardValid = true\n        return true\n      }\n      const idCardRegex = /^[1-9]\\d{5}(19|20)\\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])\\d{3}[\\dXx]$/\n      return idCardValid = idCardRegex.test(value)\n    }\n  },\n  email: {\n    required: false,\n    message: '请输入正确的邮箱地址',\n    trigger: ['blur', 'input'],\n    validator: (_rule: any, value: string) => {\n      if (!value) {\n        emailValid = true\n        return true\n      }\n      const emailRegex = /^([A-Za-z0-9_\\-\\.])+\\@([A-Za-z0-9_\\-\\.])+\\.([A-Za-z]{2,4})$/\n      return emailValid = emailRegex.test(value)\n    }\n  }\n}\n\n/**\n * 处理用户注册\n */\nconst handleRegister = async () => {\n  if (registerLoading.value) return\n\n  // 验证所有字段\n  if (!usernameValid || !passwordValid || !confirmPasswordValid || !realNameValid || !phoneValid || !idCardValid || !emailValid) {\n    message.error('请检查注册信息是否符合要求')\n    return\n  }\n\n  registerLoading.value = true\n  const res = await register({\n    username: formValue.value.username,\n    password: formValue.value.password,\n    realName: formValue.value.realName,\n    phone: formValue.value.phone,\n    idCard: formValue.value.idCard || undefined,\n    email: formValue.value.email || undefined\n  })\n\n  if (res.code === 0) {\n    message.success('注册成功，即将跳转到登录页')\n    setTimeout(() => {\n      router.push('/login')\n    }, 1500)\n  } else {\n    message.error(res.message || '注册失败，请重试')\n  }\n\n  setTimeout(() => {\n    registerLoading.value = false\n  }, 1000)\n}\n</script>\n\n<template>\n  <div class=\"register-container\">\n    <div class=\"register-content\">\n      <div class=\"register-left\">\n        <NCard class=\"register-card\" :bordered=\"false\">\n          <div class=\"register-header\">\n            <h2 class=\"register-title\">创建账号</h2>\n            <p class=\"register-subtitle\">请填写以下信息完成注册</p>\n          </div>\n\n          <NForm\n            ref=\"formRef\"\n            :model=\"formValue\"\n            label-placement=\"left\"\n            label-width=\"0\"\n            require-mark-placement=\"right-hanging\"\n            :rules=\"rules\"\n          >\n            <NFormItem path=\"username\">\n              <NInput\n                v-model:value=\"formValue.username\"\n                placeholder=\"用户名\"\n                size=\"large\"\n              />\n            </NFormItem>\n\n            <NFormItem path=\"realName\">\n              <NInput\n                v-model:value=\"formValue.realName\"\n                placeholder=\"真实姓名\"\n                size=\"large\"\n              />\n            </NFormItem>\n\n            <NFormItem path=\"phone\">\n              <NInput\n                v-model:value=\"formValue.phone\"\n                placeholder=\"手机号\"\n                size=\"large\"\n              />\n            </NFormItem>\n\n            <NFormItem path=\"password\">\n              <NInput\n                v-model:value=\"formValue.password\"\n                type=\"password\"\n                placeholder=\"密码\"\n                size=\"large\"\n                show-password-on=\"click\"\n              />\n            </NFormItem>\n\n            <NFormItem path=\"confirmPassword\">\n              <NInput\n                v-model:value=\"formValue.confirmPassword\"\n                type=\"password\"\n                placeholder=\"确认密码\"\n                size=\"large\"\n                show-password-on=\"click\"\n              />\n            </NFormItem>\n\n            <NFormItem path=\"idCard\">\n              <NInput\n                v-model:value=\"formValue.idCard\"\n                placeholder=\"身份证号（选填）\"\n                size=\"large\"\n              />\n            </NFormItem>\n\n            <NFormItem path=\"email\">\n              <NInput\n                v-model:value=\"formValue.email\"\n                placeholder=\"邮箱（选填）\"\n                size=\"large\"\n              />\n            </NFormItem>\n\n            <div class=\"form-actions\">\n              <NButton\n                type=\"primary\"\n                size=\"large\"\n                block\n                :loading=\"registerLoading\"\n                @click=\"handleRegister\"\n              >\n                {{ registerLoading ? '注册中...' : '注册' }}\n              </NButton>\n            </div>\n\n            <div class=\"form-links\">\n              <p class=\"link-text\">\n                已有账号？\n                <router-link to=\"/login\" class=\"link\">立即登录</router-link>\n              </p>\n            </div>\n          </NForm>\n        </NCard>\n      </div>\n\n      <div class=\"register-right\">\n        <div class=\"brand-content\">\n          <h1 class=\"brand-title\">校园物流系统</h1>\n          <p class=\"brand-description\">便捷、高效、安全的校园物流服务平台</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.register-container {\n  min-height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: linear-gradient(135deg, #36ad6a 0%, #18a058 100%);\n  padding: 20px 0;\n}\n\n.register-content {\n  display: flex;\n  width: 1000px;\n  min-height: 700px;\n  background: rgba(255, 255, 255, 0.95);\n  border-radius: 16px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);\n  overflow: hidden;\n}\n\n.register-left {\n  flex: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 40px;\n}\n\n.register-card {\n  width: 100%;\n  max-width: 400px;\n  background: transparent;\n}\n\n.register-header {\n  text-align: center;\n  margin-bottom: 24px;\n}\n\n.register-title {\n  font-size: 24px;\n  color: #333;\n  margin: 0 0 8px;\n  font-weight: 600;\n}\n\n.register-subtitle {\n  font-size: 14px;\n  color: #666;\n  margin: 0;\n}\n\n.form-actions {\n  margin-top: 24px;\n}\n\n.form-links {\n  margin-top: 16px;\n  text-align: center;\n}\n\n.link-text {\n  font-size: 14px;\n  color: #666;\n  margin: 0;\n}\n\n.link {\n  color: #18a058;\n  text-decoration: none;\n  font-weight: 500;\n  transition: color 0.3s ease;\n}\n\n.link:hover {\n  color: #0c7a43;\n  text-decoration: underline;\n}\n\n.register-right {\n  flex: 1;\n  background: linear-gradient(135deg, #36ad6a 0%, #18a058 100%);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding: 40px;\n  color: white;\n  text-align: center;\n}\n\n.brand-title {\n  font-size: 48px;\n  font-weight: bold;\n  margin: 0 0 16px;\n  letter-spacing: 2px;\n}\n\n.brand-description {\n  font-size: 18px;\n  margin: 0;\n  opacity: 0.95;\n}\n\n/* 强制输入框文本左对齐 */\n:deep(.n-input__input-el) {\n  text-align: left !important;\n}\n\n:deep(.n-input__textarea-el) {\n  text-align: left !important;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, computed, h, onMounted, watch } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useUserStore } from '../stores/user'\nimport {\n  NLayout,\n  NLayoutSider,\n  NLayoutContent,\n  NMenu,\n  NAvatar,\n  NDropdown,\n  NSpace,\n  type MenuOption,\n  type DropdownOption\n} from 'naive-ui'\nimport {\n  HomeOutline,\n  CubeOutline,\n  SendOutline,\n  SearchOutline,\n  PersonOutline,\n  LogOutOutline,\n  BarChartOutline,\n  GridOutline,\n  AlertCircleOutline\n} from '@vicons/ionicons5'\n\nconst router = useRouter()\nconst route = useRoute()\nconst userStore = useUserStore()\n\n// 初始化用户状态\nuserStore.initFromStorage()\n\n// 侧边栏折叠状态\nconst collapsed = ref(false)\n\n// 控制用户名显示，只在动画完成后显示\nconst showUsername = ref(true)\n\n// 当前激活的菜单项\nconst activeKey = ref('')\n\n// 计算属性\nconst userInfo = computed(() => userStore.userInfo)\nconst isStaffOrAdmin = computed(() => {\n  const role = userInfo.value?.role\n  return role === 'staff' || role === 'admin'\n})\n\n// 导航菜单选项\nconst menuOptions = computed<MenuOption[]>(() => {\n  const baseMenus: MenuOption[] = [\n    {\n      label: '仪表盘',\n      key: '/dashboard',\n      icon: () => h(HomeOutline)\n    },\n    {\n      label: '包裹查询',\n      key: '/search',\n      icon: () => h(SearchOutline)\n    }\n  ]\n\n  // 只有普通用户显示\"我的包裹\"和\"我的寄件\"\n  if (!isStaffOrAdmin.value) {\n    baseMenus.push(\n      {\n        label: '我的包裹',\n        key: '/my-parcels',\n        icon: () => h(CubeOutline)\n      },\n      {\n        label: '我的寄件',\n        key: '/my-shipments',\n        icon: () => h(SendOutline)\n      }\n    )\n  }\n\n  // staff/admin 显示管理菜单\n  if (isStaffOrAdmin.value) {\n    baseMenus.push({\n      label: '包裹管理',\n      key: '/parcel-management',\n      icon: () => h(BarChartOutline)\n    })\n    baseMenus.push({\n      label: '货架管理',\n      key: '/shelf-management',\n      icon: () => h(GridOutline)\n    })\n    baseMenus.push({\n      label: '滞留件管理',\n      key: '/overdue-management',\n      icon: () => h(AlertCircleOutline)\n    })\n  }\n\n  return baseMenus\n})\n\n// 用户头像下拉菜单选项\nconst dropdownOptions: DropdownOption[] = [\n  {\n    label: '个人中心',\n    key: 'profile'\n  },\n  {\n    label: '退出登录',\n    key: 'logout'\n  }\n]\n\n// 监听侧边栏折叠状态变化，控制用户名显示时机\nwatch(collapsed, (newCollapsed) => {\n  if (newCollapsed) {\n    // 折叠时立即隐藏用户名\n    showUsername.value = false\n  } else {\n    // 展开时延迟显示用户名，等待动画完成\n    setTimeout(() => {\n      showUsername.value = true\n    }, 100)\n  }\n})\n\n// 监听路由变化，更新激活的菜单项\nwatch(\n  () => route.path,\n  (newPath) => {\n    activeKey.value = newPath\n  },\n  { immediate: true }\n)\n\n// 处理导航菜单项点击事件\nconst handleUpdateValue = (key: string) => {\n  router.push(key)\n}\n\n// 处理用户头像下拉菜单选择事件\nconst handleSelect = (key: string) => {\n  if (key === 'profile') {\n    // 跳转到个人中心页面\n    router.push('/profile')\n  } else if (key === 'logout') {\n    // 退出登录，清除token并跳转到登录页\n    userStore.logout()\n    router.push('/login')\n  }\n}\n\n// 组件挂载时执行的操作\nonMounted(() => {\n  // 检查用户是否登录，如果未登录则跳转到登录页\n  if (!userStore.isLoggedIn) {\n    router.push('/login')\n    return\n  }\n\n  // 根据当前路由动态设置激活的菜单项\n  const currentRoute = router.currentRoute.value.path\n  const menuKeys = menuOptions.value.map((option) => option.key)\n  if (menuKeys.includes(currentRoute)) {\n    activeKey.value = currentRoute\n  } else {\n    // 如果当前路由不在菜单中，设置默认值\n    activeKey.value = '/dashboard'\n  }\n})\n</script>\n\n<template>\n  <!-- 整体布局容器，包含侧边栏和内容区 -->\n  <NLayout class=\"main-layout\" has-sider>\n    <!-- 侧边导航栏 -->\n    <NLayoutSider\n      bordered\n      collapse-mode=\"width\"\n      :collapsed-width=\"64\"\n      :width=\"240\"\n      show-trigger\n      v-model:collapsed=\"collapsed\"\n      :native-scrollbar=\"false\"\n    >\n      <div class=\"sider-content\">\n        <!-- 品牌标题 -->\n        <div class=\"brand-header\">\n          <h2 v-if=\"!collapsed\" class=\"brand-title\">校园物流</h2>\n          <h2 v-else class=\"brand-title-collapsed\">物流</h2>\n        </div>\n\n        <!-- 导航菜单 -->\n        <NMenu\n          v-model:value=\"activeKey\"\n          :options=\"menuOptions\"\n          :collapsed-width=\"64\"\n          :collapsed-icon-size=\"22\"\n          @update:value=\"handleUpdateValue\"\n        />\n\n        <!-- 用户信息区域，显示在侧边栏底部 -->\n        <div class=\"user-profile\">\n          <NDropdown :options=\"dropdownOptions\" @select=\"handleSelect\">\n            <NSpace align=\"center\">\n              <NAvatar\n                round\n                :size=\"32\"\n                :style=\"{ backgroundColor: '#18a058', color: '#fff' }\"\n              >\n                {{ userInfo?.username?.charAt(0).toUpperCase() || 'U' }}\n              </NAvatar>\n              <span class=\"username\" v-if=\"!collapsed && showUsername\">\n                {{ userInfo?.realName || userInfo?.username }}\n              </span>\n            </NSpace>\n          </NDropdown>\n        </div>\n      </div>\n    </NLayoutSider>\n\n    <!-- 主内容区域 -->\n    <NLayout>\n      <NLayoutContent content-style=\"padding: 24px;\">\n        <!-- 路由视图，根据当前路由显示对应组件 -->\n        <router-view />\n      </NLayoutContent>\n    </NLayout>\n  </NLayout>\n</template>\n\n<style scoped>\n/* 主布局容器 - 占满整个视口 */\n.main-layout {\n  width: 100%;\n  height: 100vh;\n}\n\n/* 侧边栏内容样式，使用flex布局实现顶部菜单+底部用户信息的结构 */\n.sider-content {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n/* 品牌标题区域 */\n.brand-header {\n  flex-shrink: 0;\n  padding: 20px 24px;\n  text-align: center;\n  border-bottom: 1px solid var(--n-border-color);\n  margin-bottom: 8px;\n}\n\n.brand-title {\n  color: #18a058;\n  margin: 0;\n  font-size: 20px;\n  font-weight: bold;\n  transition: opacity 0.3s;\n}\n\n.brand-title-collapsed {\n  color: #18a058;\n  margin: 0;\n  font-size: 16px;\n  font-weight: bold;\n}\n\n/* 用户信息区域样式，固定在侧边栏底部 */\n.user-profile {\n  margin-top: auto;\n  padding: 16px;\n  border-top: 1px solid var(--n-border-color);\n  cursor: pointer;\n}\n\n/* 用户名称文本样式 */\n.username {\n  font-size: 14px;\n  color: var(--n-text-color);\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  max-width: 120px;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, onMounted, computed } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useUserStore } from '../stores/user'\nimport {\n  NButton,\n  NGrid,\n  NGridItem,\n  NCard,\n  NStatistic,\n  NDataTable,\n  useMessage\n} from 'naive-ui'\nimport { getDashboardStatistics } from '../api/parcel'\nimport { getMyParcels } from '../api/parcel'\nimport { getMyShipments } from '../api/shipment'\nimport type { DashboardStatistics, Parcel, Shipment } from '../api/types'\n\nconst router = useRouter()\nconst userStore = useUserStore()\nconst message = useMessage()\n\n// 初始化用户状态\nuserStore.initFromStorage()\n\nconst loading = ref(false)\nconst statistics = ref<DashboardStatistics | null>(null)\nconst recentParcels = ref<Parcel[]>([])\nconst recentShipments = ref<Shipment[]>([])\n\n// 计算属性\nconst isLoggedIn = computed(() => userStore.isLoggedIn)\nconst userInfo = computed(() => userStore.userInfo)\nconst isStaffOrAdmin = computed(() => {\n  const role = userInfo.value?.role\n  return role === 'staff' || role === 'admin'\n})\n\n// 包裹状态映射\nconst parcelStatusMap: Record<string, string> = {\n  received: '待上架',\n  ready: '待取件',\n  picked_up: '已取件',\n  overdue: '滞留',\n  returned: '已退回'\n}\n\n// 寄件状态映射\nconst shipmentStatusMap: Record<string, string> = {\n  pending: '待发货',\n  shipped: '已发货',\n  delivered: '已送达',\n  cancelled: '已取消'\n}\n\n// 包裹表格列定义\nconst parcelColumns = [\n  { title: '取件码', key: 'pickup_code' },\n  { title: '快递公司', key: 'courier_company' },\n  {\n    title: '状态',\n    key: 'status',\n    render: (row: Parcel) => parcelStatusMap[row.status] || row.status\n  },\n  {\n    title: '入库时间',\n    key: 'received_at',\n    render: (row: Parcel) => new Date(row.received_at).toLocaleString('zh-CN')\n  }\n]\n\n// 寄件表格列定义\nconst shipmentColumns = [\n  { title: '寄件单号', key: 'shipment_number' },\n  { title: '收件人', key: 'recipient_name' },\n  { title: '快递公司', key: 'courier_company' },\n  { title: '运费', key: 'freight', render: (row: Shipment) => `¥${row.freight}` },\n  {\n    title: '状态',\n    key: 'status',\n    render: (row: Shipment) => shipmentStatusMap[row.status] || row.status\n  }\n]\n\n// 加载数据\nconst loadData = async () => {\n  loading.value = true\n  try {\n    // 加载统计数据\n    if (isStaffOrAdmin.value) {\n      const statsRes = await getDashboardStatistics()\n      if (statsRes.code === 0 && statsRes.data) {\n        statistics.value = statsRes.data\n      }\n    }\n\n    // 加载最近的包裹\n    const parcelsRes = await getMyParcels({ page: 1, page_size: 5 })\n    if (parcelsRes.code === 0 && parcelsRes.data) {\n      recentParcels.value = parcelsRes.data.list\n    }\n\n    // 加载最近的寄件\n    const shipmentsRes = await getMyShipments({ page: 1, page_size: 5 })\n    if (shipmentsRes.code === 0 && shipmentsRes.data) {\n      recentShipments.value = shipmentsRes.data.list\n    }\n  } catch (error) {\n    message.error('加载数据失败')\n  } finally {\n    loading.value = false\n  }\n}\n\nonMounted(() => {\n  if (isLoggedIn.value) {\n    loadData()\n  }\n})\n</script>\n\n<template>\n  <div class=\"dashboard-container\">\n    <div v-if=\"!isLoggedIn\" class=\"not-logged-in\">\n      <h2>请先登录</h2>\n      <NButton type=\"primary\" @click=\"router.push('/login')\" style=\"margin-top: 16px\">\n        前往登录\n      </NButton>\n    </div>\n\n    <div v-else>\n      <!-- 管理员统计数据 -->\n      <div v-if=\"isStaffOrAdmin && statistics\" class=\"statistics-section\">\n        <h3>今日数据</h3>\n        <NGrid :x-gap=\"24\" :y-gap=\"24\" :cols=\"4\">\n          <NGridItem>\n            <NCard>\n              <NStatistic label=\"今日入库\" :value=\"statistics.today.received_count\" />\n            </NCard>\n          </NGridItem>\n          <NGridItem>\n            <NCard>\n              <NStatistic label=\"今日取件\" :value=\"statistics.today.picked_up_count\" />\n            </NCard>\n          </NGridItem>\n          <NGridItem>\n            <NCard>\n              <NStatistic label=\"滞留包裹\" :value=\"statistics.today.overdue_count\" />\n            </NCard>\n          </NGridItem>\n          <NGridItem>\n            <NCard>\n              <NStatistic\n                label=\"货架使用率\"\n                :value=\"statistics.shelves.utilization_rate\"\n                suffix=\"%\"\n              />\n            </NCard>\n          </NGridItem>\n        </NGrid>\n      </div>\n\n      <!-- 最近的包裹 -->\n      <div class=\"section\">\n        <div class=\"section-header\">\n          <h3>我的包裹</h3>\n          <NButton text type=\"primary\" @click=\"router.push('/my-parcels')\">\n            查看全部\n          </NButton>\n        </div>\n        <NCard>\n          <NDataTable\n            :columns=\"parcelColumns\"\n            :data=\"recentParcels\"\n            :loading=\"loading\"\n            :pagination=\"false\"\n          />\n          <div\n            v-if=\"recentParcels.length === 0 && !loading\"\n            class=\"empty-state\"\n          >\n            暂无包裹\n          </div>\n        </NCard>\n      </div>\n\n      <!-- 最近的寄件 -->\n      <div class=\"section\">\n        <div class=\"section-header\">\n          <h3>我的寄件</h3>\n          <NButton text type=\"primary\" @click=\"router.push('/my-shipments')\">\n            查看全部\n          </NButton>\n        </div>\n        <NCard>\n          <NDataTable\n            :columns=\"shipmentColumns\"\n            :data=\"recentShipments\"\n            :loading=\"loading\"\n            :pagination=\"false\"\n          />\n          <div\n            v-if=\"recentShipments.length === 0 && !loading\"\n            class=\"empty-state\"\n          >\n            暂无寄件记录\n          </div>\n        </NCard>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style scoped>\n.dashboard-container {\n  width: 100%;\n}\n\n.not-logged-in {\n  text-align: center;\n  padding: 80px 0;\n}\n\n.statistics-section {\n  margin-bottom: 24px;\n}\n\n.section {\n  margin-bottom: 24px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n}\n\n.section-header h3 {\n  margin: 0;\n}\n\n.empty-state {\n  text-align: center;\n  padding: 40px 0;\n  color: #999;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport {\n  NCard,\n  NTabs,\n  NTabPane,\n  NForm,\n  NFormItem,\n  NInput,\n  NButton,\n  NResult,\n  NDescriptions,\n  NDescriptionsItem,\n  NTag,\n  NModal,\n  NSpace,\n  useMessage\n} from 'naive-ui'\nimport { getParcelByPickupCode, getParcelByTrackingNumber, pickupParcel } from '../api/parcel'\nimport type { Parcel } from '../api/types'\n\nconst message = useMessage()\nconst searchType = ref<'pickup_code' | 'tracking_number'>('pickup_code')\nconst pickupCode = ref('')\nconst trackingNumber = ref('')\nconst loading = ref(false)\nconst searchResult = ref<Parcel | null>(null)\nconst searchError = ref('')\n\n// 取件弹窗\nconst showPickupModal = ref(false)\nconst pickupLoading = ref(false)\nconst verifyPhone = ref('')\n\n// 包裹状态映射\nconst parcelStatusMap: Record<string, { text: string; type: any }> = {\n  received: { text: '待上架', type: 'info' },\n  ready: { text: '待取件', type: 'success' },\n  picked_up: { text: '已取件', type: 'default' },\n  overdue: { text: '滞留', type: 'warning' },\n  returned: { text: '已退回', type: 'error' }\n}\n\n// 是否可以取件\nconst canPickup = () => {\n  return searchResult.value &&\n    (searchResult.value.status === 'ready' || searchResult.value.status === 'overdue')\n}\n\n// 打开取件弹窗\nconst handleOpenPickup = () => {\n  verifyPhone.value = ''\n  showPickupModal.value = true\n}\n\n// 提交取件\nconst handleSubmitPickup = async () => {\n  if (pickupLoading.value || !searchResult.value) return\n\n  if (!verifyPhone.value) {\n    message.error('请输入手机号进行验证')\n    return\n  }\n\n  pickupLoading.value = true\n  const res = await pickupParcel({\n    pickup_code: searchResult.value.pickup_code,\n    recipient_phone: verifyPhone.value\n  })\n\n  if (res.code === 0) {\n    message.success('取件成功！')\n    showPickupModal.value = false\n    // 更新查询结果\n    searchResult.value = res.data || null\n  } else {\n    message.error(res.message || '取件失败')\n  }\n  pickupLoading.value = false\n}\n\n// 查询包裹\nconst handleSearch = async () => {\n  if (loading.value) return\n\n  searchResult.value = null\n  searchError.value = ''\n\n  // 验证输入\n  if (searchType.value === 'pickup_code' && !pickupCode.value) {\n    message.error('请输入取件码')\n    return\n  }\n  if (searchType.value === 'tracking_number' && !trackingNumber.value) {\n    message.error('请输入快递单号')\n    return\n  }\n\n  loading.value = true\n  try {\n    let res\n    if (searchType.value === 'pickup_code') {\n      res = await getParcelByPickupCode(pickupCode.value)\n    } else {\n      res = await getParcelByTrackingNumber(trackingNumber.value)\n    }\n\n    if (res.code === 0 && res.data) {\n      searchResult.value = res.data\n      message.success('查询成功')\n    } else {\n      searchError.value = res.message || '包裹不存在'\n      message.error(searchError.value)\n    }\n  } catch (error: any) {\n    searchError.value = error.message || '查询失败'\n    message.error(searchError.value)\n  } finally {\n    loading.value = false\n  }\n}\n\n// 重置搜索\nconst handleReset = () => {\n  pickupCode.value = ''\n  trackingNumber.value = ''\n  searchResult.value = null\n  searchError.value = ''\n}\n\n// 格式化日期时间\nconst formatDateTime = (dateStr?: string) => {\n  if (!dateStr) return '-'\n  return new Date(dateStr).toLocaleString('zh-CN', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit'\n  })\n}\n</script>\n\n<template>\n  <div class=\"search-container\">\n    <NCard class=\"search-card\" title=\"包裹查询\">\n      <NTabs v-model:value=\"searchType\" type=\"segment\" @update:value=\"handleReset\">\n        <NTabPane name=\"pickup_code\" tab=\"取件码查询\">\n          <NForm label-placement=\"top\">\n            <NFormItem label=\"取件码\">\n              <NInput v-model:value=\"pickupCode\" placeholder=\"请输入取件码，例如：A12345\" size=\"large\"\n                @keyup.enter=\"handleSearch\" />\n            </NFormItem>\n            <NFormItem>\n              <NButton type=\"primary\" size=\"large\" block :loading=\"loading\" @click=\"handleSearch\">\n                查询\n              </NButton>\n            </NFormItem>\n          </NForm>\n        </NTabPane>\n\n        <NTabPane name=\"tracking_number\" tab=\"快递单号查询\">\n          <NForm label-placement=\"top\">\n            <NFormItem label=\"快递单号\">\n              <NInput v-model:value=\"trackingNumber\" placeholder=\"请输入快递单号，例如：SF1234567890\" size=\"large\"\n                @keyup.enter=\"handleSearch\" />\n            </NFormItem>\n            <NFormItem>\n              <NButton type=\"primary\" size=\"large\" block :loading=\"loading\" @click=\"handleSearch\">\n                查询\n              </NButton>\n            </NFormItem>\n          </NForm>\n        </NTabPane>\n      </NTabs>\n\n      <!-- 查询结果 -->\n      <div v-if=\"searchResult\" class=\"result-section\">\n        <NDescriptions label-placement=\"left\" :column=\"1\" bordered>\n          <NDescriptionsItem label=\"取件码\">\n            <strong style=\"font-size: 20px; color: #18a058;\">{{ searchResult.pickup_code }}</strong>\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"快递单号\">\n            {{ searchResult.tracking_number }}\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"收件人\">\n            {{ searchResult.recipient_name }}\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"手机号\">\n            {{ searchResult.recipient_phone }}\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"快递公司\">\n            {{ searchResult.courier_company }}\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"包裹尺寸\">\n            {{ searchResult.size }}\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"重量\">\n            {{ searchResult.weight }} kg\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"状态\">\n            <NTag :type=\"parcelStatusMap[searchResult.status]?.type || 'default'\">\n              {{ parcelStatusMap[searchResult.status]?.text || searchResult.status }}\n            </NTag>\n          </NDescriptionsItem>\n          <NDescriptionsItem v-if=\"searchResult.shelf\" label=\"货架位置\">\n            {{ searchResult.shelf.shelf_code }} ({{ searchResult.shelf.area }}区{{ searchResult.shelf.floor }}层{{\n              searchResult.shelf.column }}列)\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"入库时间\">\n            {{ formatDateTime(searchResult.received_at) }}\n          </NDescriptionsItem>\n          <NDescriptionsItem v-if=\"searchResult.shelved_at\" label=\"上架时间\">\n            {{ formatDateTime(searchResult.shelved_at) }}\n          </NDescriptionsItem>\n          <NDescriptionsItem v-if=\"searchResult.picked_up_at\" label=\"取件时间\">\n            {{ formatDateTime(searchResult.picked_up_at) }}\n          </NDescriptionsItem>\n          <NDescriptionsItem v-if=\"searchResult.expected_overdue_at\" label=\"预计滞留时间\">\n            {{ formatDateTime(searchResult.expected_overdue_at) }}\n          </NDescriptionsItem>\n          <NDescriptionsItem v-if=\"searchResult.notes\" label=\"备注\">\n            {{ searchResult.notes }}\n          </NDescriptionsItem>\n        </NDescriptions>\n\n        <div style=\"margin-top: 16px; text-align: center;\">\n          <NButton @click=\"handleReset\">继续查询</NButton>\n        </div>\n      </div>\n\n      <!-- 错误提示 -->\n      <div v-else-if=\"searchError\" class=\"result-section\">\n        <NResult status=\"404\" title=\"未找到包裹\" :description=\"searchError\">\n          <template #footer>\n            <NButton @click=\"handleReset\">重新查询</NButton>\n          </template>\n        </NResult>\n      </div>\n    </NCard>\n  </div>\n</template>\n\n<style scoped>\n.search-container {\n  min-height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: linear-gradient(135deg, #36ad6a 0%, #18a058 100%);\n  padding: 40px 20px;\n}\n\n.search-card {\n  width: 100%;\n  max-width: 600px;\n}\n\n.result-section {\n  margin-top: 32px;\n  padding-top: 32px;\n  border-top: 1px solid #f0f0f0;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, onMounted, h } from 'vue'\nimport {\n  NCard,\n  NDataTable,\n  NButton,\n  NSpace,\n  NTag,\n  NInput,\n  NSelect,\n  useMessage,\n  type DataTableColumns\n} from 'naive-ui'\nimport { getMyParcels } from '../api/parcel'\nimport type { Parcel } from '../api/types'\n\nconst message = useMessage()\nconst loading = ref(false)\nconst parcels = ref<Parcel[]>([])\nconst total = ref(0)\nconst page = ref(1)\nconst pageSize = ref(20)\n\n// 筛选条件\nconst statusFilter = ref<string | null>(null)\nconst searchKeyword = ref('')\n\n// 包裹状态选项\nconst statusOptions = [\n  { label: '全部', value: '' },\n  { label: '待取件', value: 'ready' },\n  { label: '已取件', value: 'picked_up' },\n  { label: '滞留', value: 'overdue' }\n]\n\n// 包裹状态映射\nconst parcelStatusMap: Record<string, { text: string; type: any }> = {\n  received: { text: '待上架', type: 'info' },\n  ready: { text: '待取件', type: 'success' },\n  picked_up: { text: '已取件', type: 'default' },\n  overdue: { text: '滞留', type: 'warning' },\n  returned: { text: '已退回', type: 'error' }\n}\n\n// 表格列定义\nconst columns: DataTableColumns<Parcel> = [\n  {\n    title: '取件码',\n    key: 'pickup_code',\n    width: 100,\n    render: (row) => {\n      return h('strong', { style: 'color: #18a058; font-size: 16px;' }, row.pickup_code)\n    }\n  },\n  {\n    title: '快递单号',\n    key: 'tracking_number',\n    width: 150\n  },\n  {\n    title: '快递公司',\n    key: 'courier_company',\n    width: 100\n  },\n  {\n    title: '货架位置',\n    key: 'shelf',\n    width: 120,\n    render: (row) => row.shelf?.shelf_code || '-'\n  },\n  {\n    title: '状态',\n    key: 'status',\n    width: 100,\n    render: (row) => {\n      const status = parcelStatusMap[row.status] || { text: row.status, type: 'default' }\n      return h(NTag, { type: status.type }, { default: () => status.text })\n    }\n  },\n  {\n    title: '入库时间',\n    key: 'received_at',\n    width: 160,\n    render: (row) => new Date(row.received_at).toLocaleString('zh-CN')\n  },\n  {\n    title: '备注',\n    key: 'notes',\n    ellipsis: { tooltip: true }\n  }\n]\n\n// 加载数据\nconst loadData = async () => {\n  loading.value = true\n  const res = await getMyParcels({\n    status: statusFilter.value || undefined,\n    page: page.value,\n    page_size: pageSize.value\n  })\n\n  if (res.code === 0 && res.data) {\n    parcels.value = res.data.list\n    total.value = res.data.pagination.total\n  } else {\n    message.error(res.message || '加载失败')\n  }\n  loading.value = false\n}\n\n// 处理分页变化\nconst handlePageChange = (newPage: number) => {\n  page.value = newPage\n  loadData()\n}\n\n// 处理每页条数变化\nconst handlePageSizeChange = (newPageSize: number) => {\n  pageSize.value = newPageSize\n  page.value = 1\n  loadData()\n}\n\n// 处理状态筛选\nconst handleStatusChange = () => {\n  page.value = 1\n  loadData()\n}\n\nonMounted(() => {\n  loadData()\n})\n</script>\n\n<template>\n  <div class=\"page-container\">\n    <NCard title=\"我的包裹\">\n      <!-- 筛选工具栏 -->\n      <NSpace style=\"margin-bottom: 16px;\">\n        <NSelect v-model:value=\"statusFilter\" :options=\"statusOptions\" placeholder=\"状态筛选\" style=\"width: 150px;\"\n          @update:value=\"handleStatusChange\" />\n      </NSpace>\n\n      <!-- 数据表格 -->\n      <NDataTable\n        :remote=\"true\"\n        :columns=\"columns\"\n        :data=\"parcels\"\n        :loading=\"loading\"\n        :pagination=\"{\n          page: page,\n          pageSize: pageSize,\n          itemCount: total,\n          showSizePicker: true,\n          pageSizes: [10, 20, 50],\n          onUpdatePage: handlePageChange,\n          onUpdatePageSize: handlePageSizeChange,\n          prefix: () => `共 ${total} 条`\n        }\"\n        :scroll-x=\"1000\"\n      />\n    </NCard>\n  </div>\n</template>\n\n<style scoped>\n.page-container {\n  padding: 24px;\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, onMounted, h } from 'vue'\nimport {\n  NCard,\n  NDataTable,\n  NButton,\n  NSpace,\n  NTag,\n  NModal,\n  NForm,\n  NFormItem,\n  NInput,\n  NSelect,\n  NInputNumber,\n  useMessage,\n  type DataTableColumns\n} from 'naive-ui'\nimport { getMyShipments, createShipment, getCourierCompanies, calculateFreight } from '../api/shipment'\nimport type { Shipment, CreateShipmentRequest, CalculateFreightRequest } from '../api/types'\n\nconst message = useMessage()\n\nconst loading = ref(false)\nconst shipments = ref<Shipment[]>([])\nconst total = ref(0)\nconst page = ref(1)\nconst pageSize = ref(20)\n\n// 创建寄件单弹窗\nconst showCreateModal = ref(false)\nconst createLoading = ref(false)\nconst courierCompanies = ref<string[]>([])\nconst estimatedFreight = ref<number | null>(null)\n\n// 表单数据\nconst formValue = ref<CreateShipmentRequest>({\n  recipient_name: '',\n  recipient_phone: '',\n  recipient_address: '',\n  courier_company: '',\n  weight: 1,\n  volume: 0.001\n})\n\n// 寄件状态映射\nconst shipmentStatusMap: Record<string, { text: string; type: any }> = {\n  pending: { text: '待发货', type: 'warning' },\n  shipped: { text: '已发货', type: 'info' },\n  delivered: { text: '已送达', type: 'success' },\n  cancelled: { text: '已取消', type: 'error' }\n}\n\n// 表格列定义\nconst columns: DataTableColumns<Shipment> = [\n  {\n    title: '寄件单号',\n    key: 'shipment_number',\n    width: 180\n  },\n  {\n    title: '收件人',\n    key: 'recipient_name',\n    width: 100\n  },\n  {\n    title: '收件电话',\n    key: 'recipient_phone',\n    width: 120\n  },\n  {\n    title: '收件地址',\n    key: 'recipient_address',\n    ellipsis: { tooltip: true },\n    width: 200\n  },\n  {\n    title: '快递公司',\n    key: 'courier_company',\n    width: 100\n  },\n  {\n    title: '重量',\n    key: 'weight',\n    width: 80,\n    render: (row) => `${row.weight} kg`\n  },\n  {\n    title: '运费',\n    key: 'freight',\n    width: 80,\n    render: (row) => `¥${row.freight}`\n  },\n  {\n    title: '状态',\n    key: 'status',\n    width: 100,\n    render: (row) => {\n      const status = shipmentStatusMap[row.status] || { text: row.status, type: 'default' }\n      return h(NTag, { type: status.type }, { default: () => status.text })\n    }\n  },\n  {\n    title: '创建时间',\n    key: 'created_at',\n    width: 160,\n    render: (row) => new Date(row.created_at).toLocaleString('zh-CN')\n  }\n]\n\n// 加载数据\nconst loadData = async () => {\n  loading.value = true\n  const res = await getMyShipments({\n    page: page.value,\n    page_size: pageSize.value\n  })\n\n  if (res.code === 0 && res.data) {\n    shipments.value = res.data.list\n    total.value = res.data.pagination.total\n  } else {\n    message.error(res.message || '加载失败')\n  }\n  loading.value = false\n}\n\n// 加载快递公司列表\nconst loadCourierCompanies = async () => {\n  try {\n    const res = await getCourierCompanies()\n    if (res.code === 0 && res.data) {\n      courierCompanies.value = res.data\n    }\n  } catch (error) {\n    // 忽略错误\n  }\n}\n\n// 计算运费\nconst handleCalculateFreight = async () => {\n  if (!formValue.value.courier_company || !formValue.value.weight || !formValue.value.volume) {\n    return\n  }\n\n  try {\n    const params: CalculateFreightRequest = {\n      courier_company: formValue.value.courier_company,\n      weight: formValue.value.weight,\n      volume: formValue.value.volume\n    }\n    const res = await calculateFreight(params)\n    if (res.code === 0 && res.data) {\n      estimatedFreight.value = res.data.freight\n    }\n  } catch (error) {\n    // 忽略错误\n  }\n}\n\n// 打开创建弹窗\nconst handleCreate = () => {\n  formValue.value = {\n    recipient_name: '',\n    recipient_phone: '',\n    recipient_address: '',\n    courier_company: '',\n    weight: 1,\n    volume: 0.001\n  }\n  estimatedFreight.value = null\n  showCreateModal.value = true\n  loadCourierCompanies()\n}\n\n// 提交创建\nconst handleSubmit = async () => {\n  if (createLoading.value) return\n\n  // 验证\n  if (!formValue.value.recipient_name) {\n    message.error('请输入收件人姓名')\n    return\n  }\n  if (!formValue.value.recipient_phone) {\n    message.error('请输入收件人电话')\n    return\n  }\n  if (!formValue.value.recipient_address) {\n    message.error('请输入收件地址')\n    return\n  }\n  if (!formValue.value.courier_company) {\n    message.error('请选择快递公司')\n    return\n  }\n\n  createLoading.value = true\n  const res = await createShipment(formValue.value)\n  if (res.code === 0) {\n    message.success('创建成功')\n    showCreateModal.value = false\n    loadData()\n  } else {\n    message.error(res.message || '创建失败')\n  }\n  createLoading.value = false\n}\n\n// 处理分页变化\nconst handlePageChange = (newPage: number) => {\n  page.value = newPage\n  loadData()\n}\n\n// 处理每页条数变化\nconst handlePageSizeChange = (newPageSize: number) => {\n  pageSize.value = newPageSize\n  page.value = 1\n  loadData()\n}\n\nonMounted(() => {\n  loadData()\n})\n</script>\n\n<template>\n  <div class=\"page-container\">\n    <NCard title=\"我的寄件\">\n      <template #header-extra>\n        <NButton type=\"primary\" @click=\"handleCreate\">\n          创建寄件单\n        </NButton>\n      </template>\n\n      <!-- 数据表格 -->\n      <NDataTable\n        :remote=\"true\"\n        :columns=\"columns\"\n        :data=\"shipments\"\n        :loading=\"loading\"\n        :pagination=\"{\n          page: page,\n          pageSize: pageSize,\n          itemCount: total,\n          showSizePicker: true,\n          pageSizes: [10, 20, 50],\n          onUpdatePage: handlePageChange,\n          onUpdatePageSize: handlePageSizeChange,\n          prefix: () => `共 ${total} 条`\n        }\"\n        :scroll-x=\"1200\"\n      />\n    </NCard>\n\n    <!-- 创建寄件单弹窗 -->\n    <NModal\n      v-model:show=\"showCreateModal\"\n      preset=\"card\"\n      title=\"创建寄件单\"\n      style=\"width: 600px;\"\n      :mask-closable=\"false\"\n    >\n      <NForm :model=\"formValue\" label-placement=\"left\" label-width=\"100\">\n        <NFormItem label=\"收件人姓名\" required>\n          <NInput v-model:value=\"formValue.recipient_name\" placeholder=\"请输入收件人姓名\" />\n        </NFormItem>\n\n        <NFormItem label=\"收件人电话\" required>\n          <NInput v-model:value=\"formValue.recipient_phone\" placeholder=\"请输入收件人电话\" />\n        </NFormItem>\n\n        <NFormItem label=\"收件地址\" required>\n          <NInput\n            v-model:value=\"formValue.recipient_address\"\n            type=\"textarea\"\n            placeholder=\"请输入详细地址\"\n            :rows=\"3\"\n          />\n        </NFormItem>\n\n        <NFormItem label=\"快递公司\" required>\n          <NSelect\n            v-model:value=\"formValue.courier_company\"\n            :options=\"courierCompanies.map(c => ({ label: c, value: c }))\"\n            placeholder=\"请选择快递公司\"\n            @update:value=\"handleCalculateFreight\"\n          />\n        </NFormItem>\n\n        <NFormItem label=\"重量 (kg)\" required>\n          <NInputNumber\n            v-model:value=\"formValue.weight\"\n            :min=\"0.1\"\n            :max=\"50\"\n            :step=\"0.1\"\n            placeholder=\"请输入重量\"\n            style=\"width: 100%;\"\n            @update:value=\"handleCalculateFreight\"\n          />\n        </NFormItem>\n\n        <NFormItem label=\"体积 (m³)\" required>\n          <NInputNumber\n            v-model:value=\"formValue.volume\"\n            :min=\"0.001\"\n            :max=\"1\"\n            :step=\"0.001\"\n            placeholder=\"请输入体积\"\n            style=\"width: 100%;\"\n            @update:value=\"handleCalculateFreight\"\n          />\n        </NFormItem>\n\n        <NFormItem v-if=\"estimatedFreight !== null\" label=\"预估运费\">\n          <strong style=\"font-size: 20px; color: #18a058;\">¥{{ estimatedFreight }}</strong>\n        </NFormItem>\n      </NForm>\n\n      <template #footer>\n        <NSpace justify=\"end\">\n          <NButton @click=\"showCreateModal = false\">取消</NButton>\n          <NButton type=\"primary\" :loading=\"createLoading\" @click=\"handleSubmit\">\n            创建\n          </NButton>\n        </NSpace>\n      </template>\n    </NModal>\n  </div>\n</template>\n\n<style scoped>\n.page-container {\n  padding: 24px;\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, onMounted, h } from 'vue'\nimport {\n  NCard,\n  NTabs,\n  NTabPane,\n  NDataTable,\n  NButton,\n  NSpace,\n  NTag,\n  NModal,\n  NForm,\n  NFormItem,\n  NInput,\n  NSelect,\n  NInputNumber,\n  useMessage,\n  type DataTableColumns\n} from 'naive-ui'\nimport {\n  getParcelList,\n  receiveParcel,\n  shelveParcel,\n  pickupParcel\n} from '../api/parcel'\nimport { COURIER_COMPANIES } from '../api/mock-data'\nimport type { Parcel, ReceiveParcelRequest, PickupParcelRequest, ParcelSize } from '../api/types'\n\nconst message = useMessage()\n\n// 包裹列表\nconst loading = ref(false)\nconst parcels = ref<Parcel[]>([])\nconst total = ref(0)\nconst page = ref(1)\nconst pageSize = ref(20)\nconst statusFilter = ref<string>('')\n\n// 入库弹窗\nconst showReceiveModal = ref(false)\nconst receiveLoading = ref(false)\nconst receiveForm = ref<ReceiveParcelRequest>({\n  tracking_number: '',\n  recipient_name: '',\n  recipient_phone: '',\n  recipient_id_card: '',\n  courier_company: '',\n  size: 'small',\n  weight: 1,\n  notes: ''\n})\n\n// 取件弹窗\nconst showPickupModal = ref(false)\nconst pickupLoading = ref(false)\nconst pickupForm = ref<PickupParcelRequest>({\n  pickup_code: '',\n  recipient_phone: ''\n})\n\n// 状态选项\nconst statusOptions = [\n  { label: '全部', value: '' },\n  { label: '待上架', value: 'received' },\n  { label: '待取件', value: 'ready' },\n  { label: '已取件', value: 'picked_up' },\n  { label: '滞留', value: 'overdue' },\n  { label: '已退回', value: 'returned' }\n]\n\n// 包裹尺寸选项\nconst sizeOptions = [\n  { label: '小', value: 'small' },\n  { label: '中', value: 'medium' },\n  { label: '大', value: 'large' }\n]\n\n// 快递公司选项\nconst courierOptions = COURIER_COMPANIES.map(c => ({ label: c, value: c }))\n\n// 包裹状态映射\nconst parcelStatusMap: Record<string, { text: string; type: any }> = {\n  received: { text: '待上架', type: 'info' },\n  ready: { text: '待取件', type: 'success' },\n  picked_up: { text: '已取件', type: 'default' },\n  overdue: { text: '滞留', type: 'warning' },\n  returned: { text: '已退回', type: 'error' }\n}\n\n// 表格列定义\nconst columns: DataTableColumns<Parcel> = [\n  {\n    title: 'ID',\n    key: 'id',\n    width: 60\n  },\n  {\n    title: '取件码',\n    key: 'pickup_code',\n    width: 100,\n    render: (row) => {\n      return h('strong', { style: 'color: #18a058; font-size: 14px;' }, row.pickup_code)\n    }\n  },\n  {\n    title: '快递单号',\n    key: 'tracking_number',\n    width: 140\n  },\n  {\n    title: '收件人',\n    key: 'recipient_name',\n    width: 80\n  },\n  {\n    title: '手机号',\n    key: 'recipient_phone',\n    width: 120\n  },\n  {\n    title: '快递公司',\n    key: 'courier_company',\n    width: 100\n  },\n  {\n    title: '货架',\n    key: 'shelf',\n    width: 100,\n    render: (row) => row.shelf?.shelf_code || '-'\n  },\n  {\n    title: '状态',\n    key: 'status',\n    width: 100,\n    render: (row) => {\n      const status = parcelStatusMap[row.status] || { text: row.status, type: 'default' }\n      return h(NTag, { type: status.type }, { default: () => status.text })\n    }\n  },\n  {\n    title: '入库时间',\n    key: 'received_at',\n    width: 160,\n    render: (row) => new Date(row.received_at).toLocaleString('zh-CN')\n  },\n  {\n    title: '操作',\n    key: 'actions',\n    width: 120,\n    render: (row) => {\n      if (row.status === 'received') {\n        return h(NButton, {\n          size: 'small',\n          type: 'primary',\n          onClick: () => handleShelve(row)\n        }, { default: () => '上架' })\n      }\n      return null\n    }\n  }\n]\n\n// 加载包裹列表\nconst loadParcels = async () => {\n  loading.value = true\n  const res = await getParcelList({\n    status: statusFilter.value || undefined,\n    page: page.value,\n    page_size: pageSize.value\n  })\n\n  if (res.code === 0 && res.data) {\n    parcels.value = res.data.list\n    total.value = res.data.pagination.total\n  } else {\n    message.error(res.message || '加载失败')\n  }\n  loading.value = false\n}\n\n// 打开入库弹窗\nconst handleOpenReceive = () => {\n  receiveForm.value = {\n    tracking_number: '',\n    recipient_name: '',\n    recipient_phone: '',\n    recipient_id_card: '',\n    courier_company: '',\n    size: 'small',\n    weight: 1,\n    notes: ''\n  }\n  showReceiveModal.value = true\n}\n\n// 包裹上架\nconst handleShelve = async (parcel: Parcel) => {\n  const res = await shelveParcel(parcel.id)\n  if (res.code === 0) {\n    message.success(`上架成功！货架位置：${res.data?.shelf?.shelf_code}`)\n    loadParcels()\n  } else {\n    message.error(res.message || '上架失败')\n  }\n}\n\n// 提交入库\nconst handleSubmitReceive = async () => {\n  if (receiveLoading.value) return\n\n  // 验证\n  if (!receiveForm.value.tracking_number) {\n    message.error('请输入快递单号')\n    return\n  }\n  if (!receiveForm.value.recipient_name) {\n    message.error('请输入收件人姓名')\n    return\n  }\n  if (!receiveForm.value.recipient_phone) {\n    message.error('请输入收件人电话')\n    return\n  }\n  if (!receiveForm.value.courier_company) {\n    message.error('请选择快递公司')\n    return\n  }\n\n  receiveLoading.value = true\n  const res = await receiveParcel(receiveForm.value)\n  if (res.code === 0) {\n    message.success(`入库成功！取件码：${res.data?.pickup_code}`)\n    showReceiveModal.value = false\n    loadParcels()\n  } else {\n    message.error(res.message || '入库失败')\n  }\n  receiveLoading.value = false\n}\n\n// 打开取件弹窗\nconst handleOpenPickup = () => {\n  pickupForm.value = {\n    pickup_code: '',\n    recipient_phone: ''\n  }\n  showPickupModal.value = true\n}\n\n// 提交取件\nconst handleSubmitPickup = async () => {\n  if (pickupLoading.value) return\n\n  // 验证\n  if (!pickupForm.value.pickup_code) {\n    message.error('请输入取件码')\n    return\n  }\n  if (!pickupForm.value.recipient_phone) {\n    message.error('请输入手机号')\n    return\n  }\n\n  pickupLoading.value = true\n  const res = await pickupParcel(pickupForm.value)\n  if (res.code === 0) {\n    message.success('取件成功')\n    showPickupModal.value = false\n    loadParcels()\n  } else {\n    message.error(res.message || '取件失败')\n  }\n  pickupLoading.value = false\n}\n\n// 处理分页变化\nconst handlePageChange = (newPage: number) => {\n  page.value = newPage\n  loadParcels()\n}\n\n// 处理每页条数变化\nconst handlePageSizeChange = (newPageSize: number) => {\n  pageSize.value = newPageSize\n  page.value = 1\n  loadParcels()\n}\n\n// 处理状态筛选\nconst handleStatusChange = () => {\n  page.value = 1\n  loadParcels()\n}\n\nonMounted(() => {\n  loadParcels()\n})\n</script>\n\n<template>\n  <div class=\"page-container\">\n    <NCard title=\"包裹管理\">\n      <template #header-extra>\n        <NSpace>\n          <NButton type=\"primary\" @click=\"handleOpenReceive\">\n            包裹入库\n          </NButton>\n          <NButton type=\"success\" @click=\"handleOpenPickup\">\n            包裹取件\n          </NButton>\n        </NSpace>\n      </template>\n\n      <!-- 筛选工具栏 -->\n      <NSpace style=\"margin-bottom: 16px;\">\n        <NSelect v-model:value=\"statusFilter\" :options=\"statusOptions\" placeholder=\"状态筛选\" style=\"width: 150px;\"\n          @update:value=\"handleStatusChange\" />\n      </NSpace>\n\n      <!-- 数据表格 -->\n      <NDataTable\n        :remote=\"true\"\n        :columns=\"columns\"\n        :data=\"parcels\"\n        :loading=\"loading\"\n        :pagination=\"{\n          page: page,\n          pageSize: pageSize,\n          itemCount: total,\n          showSizePicker: true,\n          pageSizes: [10, 20, 50],\n          onUpdatePage: handlePageChange,\n          onUpdatePageSize: handlePageSizeChange,\n          prefix: () => `共 ${total} 条`\n        }\"\n        :scroll-x=\"1200\"\n      />\n    </NCard>\n\n    <!-- 入库弹窗 -->\n    <NModal v-model:show=\"showReceiveModal\" preset=\"card\" title=\"包裹入库\" style=\"width: 600px;\" :mask-closable=\"false\">\n      <NForm :model=\"receiveForm\" label-placement=\"left\" label-width=\"110\">\n        <NFormItem label=\"快递单号\" required>\n          <NInput v-model:value=\"receiveForm.tracking_number\" placeholder=\"请输入快递单号\" />\n        </NFormItem>\n\n        <NFormItem label=\"收件人姓名\" required>\n          <NInput v-model:value=\"receiveForm.recipient_name\" placeholder=\"请输入收件人姓名\" />\n        </NFormItem>\n\n        <NFormItem label=\"收件人电话\" required>\n          <NInput v-model:value=\"receiveForm.recipient_phone\" placeholder=\"请输入收件人电话\" />\n        </NFormItem>\n\n        <NFormItem label=\"身份证号\">\n          <NInput v-model:value=\"receiveForm.recipient_id_card\" placeholder=\"选填\" />\n        </NFormItem>\n\n        <NFormItem label=\"快递公司\" required>\n          <NSelect v-model:value=\"receiveForm.courier_company\" :options=\"courierOptions\" placeholder=\"请选择快递公司\" />\n        </NFormItem>\n\n        <NFormItem label=\"包裹尺寸\" required>\n          <NSelect v-model:value=\"receiveForm.size\" :options=\"sizeOptions\" placeholder=\"请选择包裹尺寸\" />\n        </NFormItem>\n\n        <NFormItem label=\"重量 (kg)\" required>\n          <NInputNumber v-model:value=\"receiveForm.weight\" :min=\"0.1\" :max=\"50\" :step=\"0.1\" placeholder=\"请输入重量\"\n            style=\"width: 100%;\" />\n        </NFormItem>\n\n        <NFormItem label=\"备注\">\n          <NInput v-model:value=\"receiveForm.notes\" type=\"textarea\" placeholder=\"选填\" :rows=\"3\" />\n        </NFormItem>\n      </NForm>\n\n      <template #footer>\n        <NSpace justify=\"end\">\n          <NButton @click=\"showReceiveModal = false\">取消</NButton>\n          <NButton type=\"primary\" :loading=\"receiveLoading\" @click=\"handleSubmitReceive\">\n            确认入库\n          </NButton>\n        </NSpace>\n      </template>\n    </NModal>\n\n    <!-- 取件弹窗 -->\n    <NModal v-model:show=\"showPickupModal\" preset=\"card\" title=\"包裹取件\" style=\"width: 500px;\" :mask-closable=\"false\">\n      <NForm :model=\"pickupForm\" label-placement=\"left\" label-width=\"80\">\n        <NFormItem label=\"取件码\" required>\n          <NInput v-model:value=\"pickupForm.pickup_code\" placeholder=\"请输入取件码\" size=\"large\" />\n        </NFormItem>\n\n        <NFormItem label=\"手机号\" required>\n          <NInput v-model:value=\"pickupForm.recipient_phone\" placeholder=\"请输入收件人手机号进行验证\" size=\"large\" />\n        </NFormItem>\n      </NForm>\n\n      <template #footer>\n        <NSpace justify=\"end\">\n          <NButton @click=\"showPickupModal = false\">取消</NButton>\n          <NButton type=\"primary\" :loading=\"pickupLoading\" @click=\"handleSubmitPickup\">\n            确认取件\n          </NButton>\n        </NSpace>\n      </template>\n    </NModal>\n  </div>\n</template>\n\n<style scoped>\n.page-container {\n  padding: 24px;\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, onMounted, h } from 'vue'\nimport {\n  NCard,\n  NDataTable,\n  NButton,\n  NSpace,\n  NTag,\n  NModal,\n  NForm,\n  NFormItem,\n  NInput,\n  NSelect,\n  NInputNumber,\n  NStatistic,\n  NGrid,\n  NGi,\n  NProgress,\n  useMessage,\n  type DataTableColumns\n} from 'naive-ui'\nimport {\n  getShelfList,\n  createShelf,\n  updateShelf,\n  deleteShelf,\n  getShelfStatistics,\n  type Shelf,\n  type CreateShelfRequest,\n  type UpdateShelfRequest,\n  type ShelfStatistics\n} from '../api/shelf'\n\nconst message = useMessage()\n\n// 货架列表\nconst loading = ref(false)\nconst shelves = ref<Shelf[]>([])\nconst total = ref(0)\nconst page = ref(1)\nconst pageSize = ref(20)\nconst areaFilter = ref('')\nconst typeFilter = ref('')\nconst statusFilter = ref('')\n\n// 统计数据\nconst statistics = ref<ShelfStatistics | null>(null)\n\n// 弹窗状态\nconst showModal = ref(false)\nconst modalMode = ref<'create' | 'edit'>('create')\nconst modalLoading = ref(false)\nconst editingId = ref<number | null>(null)\n\n// 表单数据\nconst formData = ref<CreateShelfRequest>({\n  shelf_code: '',\n  area: '',\n  floor: 1,\n  column: 1,\n  type: 'small',\n  capacity: 20\n})\nconst editFormData = ref<UpdateShelfRequest>({})\n\n// 筛选选项\nconst areaOptions = [\n  { label: '全部', value: '' },\n  { label: 'A区', value: 'A' },\n  { label: 'B区', value: 'B' },\n  { label: 'C区', value: 'C' }\n]\n\nconst typeOptions = [\n  { label: '全部', value: '' },\n  { label: '小件', value: 'small' },\n  { label: '中件', value: 'medium' },\n  { label: '大件', value: 'large' }\n]\n\nconst statusOptions = [\n  { label: '全部', value: '' },\n  { label: '启用', value: 'active' },\n  { label: '停用', value: 'inactive' }\n]\n\n// 类型映射\nconst typeMap: Record<string, string> = {\n  small: '小件',\n  medium: '中件',\n  large: '大件'\n}\n\nconst statusMap: Record<string, { text: string; type: any }> = {\n  active: { text: '启用', type: 'success' },\n  inactive: { text: '停用', type: 'warning' }\n}\n\n// 负载等级颜色\nconst getLoadColor = (rate: number) => {\n  if (rate >= 90) return '#f5222d'\n  if (rate >= 70) return '#fa8c16'\n  if (rate >= 30) return '#52c41a'\n  return '#1890ff'\n}\n\n// 表格列定义\nconst columns: DataTableColumns<Shelf> = [\n  { title: 'ID', key: 'id', width: 60 },\n  { title: '货架编码', key: 'shelf_code', width: 100 },\n  { title: '区域', key: 'area', width: 60 },\n  { title: '层', key: 'floor', width: 60 },\n  { title: '列', key: 'column', width: 60 },\n  {\n    title: '类型',\n    key: 'type',\n    width: 80,\n    render: (row) => typeMap[row.type] || row.type\n  },\n  {\n    title: '容量',\n    key: 'capacity',\n    width: 80,\n    render: (row) => `${row.current_count ?? 0}/${row.capacity}`\n  },\n  {\n    title: '使用率',\n    key: 'utilization',\n    width: 120,\n    render: (row) => {\n      const rate = Math.round(((row.current_count ?? 0) / row.capacity) * 100)\n      return h(NProgress, {\n        type: 'line',\n        percentage: rate,\n        color: getLoadColor(rate),\n        showIndicator: true\n      })\n    }\n  },\n  {\n    title: '状态',\n    key: 'status',\n    width: 80,\n    render: (row) => {\n      const status = statusMap[row.status ?? 'active'] || { text: row.status ?? '未知', type: 'default' }\n      return h(NTag, { type: status.type }, { default: () => status.text })\n    }\n  },\n  {\n    title: '操作',\n    key: 'actions',\n    width: 150,\n    render: (row) => {\n      return h(NSpace, {}, {\n        default: () => [\n          h(NButton, { size: 'small', onClick: () => handleEdit(row) }, { default: () => '编辑' }),\n          h(NButton, {\n            size: 'small',\n            type: 'error',\n            disabled: (row.current_count ?? 0) > 0,\n            onClick: () => handleDelete(row)\n          }, { default: () => '删除' })\n        ]\n      })\n    }\n  }\n]\n\n// 加载货架列表\nconst loadShelves = async () => {\n  loading.value = true\n  const res = await getShelfList({\n    area: areaFilter.value || undefined,\n    type: typeFilter.value || undefined,\n    status: statusFilter.value || undefined,\n    page: page.value,\n    page_size: pageSize.value\n  })\n\n  if (res.code === 0 && res.data) {\n    shelves.value = res.data.list\n    total.value = res.data.pagination.total\n  } else {\n    message.error(res.message || '加载失败')\n  }\n  loading.value = false\n}\n\n// 加载统计数据\nconst loadStatistics = async () => {\n  try {\n    const res = await getShelfStatistics()\n    if (res.code === 0 && res.data) {\n      statistics.value = res.data\n    }\n  } catch (error) {\n    console.error('Failed to load statistics', error)\n  }\n}\n\n// 打开创建弹窗\nconst handleCreate = () => {\n  modalMode.value = 'create'\n  formData.value = {\n    shelf_code: '',\n    area: '',\n    floor: 1,\n    column: 1,\n    type: 'small',\n    capacity: 20\n  }\n  showModal.value = true\n}\n\n// 打开编辑弹窗\nconst handleEdit = (shelf: Shelf) => {\n  modalMode.value = 'edit'\n  editingId.value = shelf.id\n  editFormData.value = {\n    area: shelf.area,\n    floor: shelf.floor,\n    column: shelf.column,\n    type: shelf.type,\n    capacity: shelf.capacity,\n    status: shelf.status\n  }\n  showModal.value = true\n}\n\n// 提交表单\nconst handleSubmit = async () => {\n  if (modalLoading.value) return\n\n  modalLoading.value = true\n  if (modalMode.value === 'create') {\n    if (!formData.value.shelf_code || !formData.value.area) {\n      message.error('请填写完整信息')\n      modalLoading.value = false\n      return\n    }\n    const res = await createShelf(formData.value)\n    if (res.code === 0) {\n      message.success('创建成功')\n      showModal.value = false\n      loadShelves()\n      loadStatistics()\n    } else {\n      message.error(res.message || '创建失败')\n    }\n  } else {\n    if (!editingId.value) {\n      modalLoading.value = false\n      return\n    }\n    const res = await updateShelf(editingId.value, editFormData.value)\n    if (res.code === 0) {\n      message.success('更新成功')\n      showModal.value = false\n      loadShelves()\n      loadStatistics()\n    } else {\n      message.error(res.message || '更新失败')\n    }\n  }\n  modalLoading.value = false\n}\n\n// 删除货架\nconst handleDelete = async (shelf: Shelf) => {\n  const res = await deleteShelf(shelf.id)\n  if (res.code === 0) {\n    message.success('删除成功')\n    loadShelves()\n    loadStatistics()\n  } else {\n    message.error(res.message || '删除失败')\n  }\n}\n\n// 处理分页变化\nconst handlePageChange = (newPage: number) => {\n  page.value = newPage\n  loadShelves()\n}\n\n// 处理每页条数变化\nconst handlePageSizeChange = (newPageSize: number) => {\n  pageSize.value = newPageSize\n  page.value = 1\n  loadShelves()\n}\n\n// 处理筛选变化\nconst handleFilterChange = () => {\n  page.value = 1\n  loadShelves()\n}\n\nonMounted(() => {\n  loadShelves()\n  loadStatistics()\n})\n</script>\n\n<template>\n  <div class=\"page-container\">\n    <!-- 统计卡片 -->\n    <NGrid :cols=\"4\" :x-gap=\"16\" style=\"margin-bottom: 16px;\">\n      <NGi>\n        <NCard>\n          <NStatistic label=\"总货架数\" :value=\"statistics?.total_shelves || 0\" />\n        </NCard>\n      </NGi>\n      <NGi>\n        <NCard>\n          <NStatistic label=\"启用货架\" :value=\"statistics?.active_shelves || 0\" />\n        </NCard>\n      </NGi>\n      <NGi>\n        <NCard>\n          <NStatistic label=\"总容量\" :value=\"statistics?.total_capacity || 0\" />\n        </NCard>\n      </NGi>\n      <NGi>\n        <NCard>\n          <NStatistic label=\"总使用率\">\n            <template #default>\n              <span :style=\"{ color: getLoadColor(statistics?.utilization_rate || 0) }\">\n                {{ (statistics?.utilization_rate || 0).toFixed(1) }}%\n              </span>\n            </template>\n          </NStatistic>\n        </NCard>\n      </NGi>\n    </NGrid>\n\n    <NCard title=\"货架管理\">\n      <template #header-extra>\n        <NButton type=\"primary\" @click=\"handleCreate\">新增货架</NButton>\n      </template>\n\n      <!-- 筛选工具栏 -->\n      <NSpace style=\"margin-bottom: 16px;\">\n        <NSelect v-model:value=\"areaFilter\" :options=\"areaOptions\" placeholder=\"区域\" style=\"width: 100px;\"\n          @update:value=\"handleFilterChange\" />\n        <NSelect v-model:value=\"typeFilter\" :options=\"typeOptions\" placeholder=\"类型\" style=\"width: 100px;\"\n          @update:value=\"handleFilterChange\" />\n        <NSelect v-model:value=\"statusFilter\" :options=\"statusOptions\" placeholder=\"状态\" style=\"width: 100px;\"\n          @update:value=\"handleFilterChange\" />\n      </NSpace>\n\n      <!-- 数据表格 -->\n      <NDataTable :remote=\"true\" :columns=\"columns\" :data=\"shelves\" :loading=\"loading\" :pagination=\"{\n        page: page,\n        pageSize: pageSize,\n        itemCount: total,\n        showSizePicker: true,\n        pageSizes: [10, 20, 50],\n        onUpdatePage: handlePageChange,\n        onUpdatePageSize: handlePageSizeChange,\n        prefix: () => `共 ${total} 条`\n      }\" :scroll-x=\"1000\" />\n    </NCard>\n\n    <!-- 创建/编辑弹窗 -->\n    <NModal v-model:show=\"showModal\" preset=\"card\" :title=\"modalMode === 'create' ? '新增货架' : '编辑货架'\"\n      style=\"width: 500px;\" :mask-closable=\"false\">\n      <NForm v-if=\"modalMode === 'create'\" :model=\"formData\" label-placement=\"left\" label-width=\"80\">\n        <NFormItem label=\"货架编码\" required>\n          <NInput v-model:value=\"formData.shelf_code\" placeholder=\"如 A-1-1\" />\n        </NFormItem>\n        <NFormItem label=\"区域\" required>\n          <NInput v-model:value=\"formData.area\" placeholder=\"如 A、B、C\" />\n        </NFormItem>\n        <NFormItem label=\"层\" required>\n          <NInputNumber v-model:value=\"formData.floor\" :min=\"1\" :max=\"10\" style=\"width: 100%;\" />\n        </NFormItem>\n        <NFormItem label=\"列\" required>\n          <NInputNumber v-model:value=\"formData.column\" :min=\"1\" :max=\"20\" style=\"width: 100%;\" />\n        </NFormItem>\n        <NFormItem label=\"类型\" required>\n          <NSelect v-model:value=\"formData.type\" :options=\"[\n            { label: '小件', value: 'small' },\n            { label: '中件', value: 'medium' },\n            { label: '大件', value: 'large' }\n          ]\" />\n        </NFormItem>\n        <NFormItem label=\"容量\" required>\n          <NInputNumber v-model:value=\"formData.capacity\" :min=\"1\" :max=\"100\" style=\"width: 100%;\" />\n        </NFormItem>\n      </NForm>\n\n      <NForm v-else :model=\"editFormData\" label-placement=\"left\" label-width=\"80\">\n        <NFormItem label=\"区域\">\n          <NInput v-model:value=\"editFormData.area\" />\n        </NFormItem>\n        <NFormItem label=\"层\">\n          <NInputNumber v-model:value=\"editFormData.floor\" :min=\"1\" :max=\"10\" style=\"width: 100%;\" />\n        </NFormItem>\n        <NFormItem label=\"列\">\n          <NInputNumber v-model:value=\"editFormData.column\" :min=\"1\" :max=\"20\" style=\"width: 100%;\" />\n        </NFormItem>\n        <NFormItem label=\"类型\">\n          <NSelect v-model:value=\"editFormData.type\" :options=\"[\n            { label: '小件', value: 'small' },\n            { label: '中件', value: 'medium' },\n            { label: '大件', value: 'large' }\n          ]\" />\n        </NFormItem>\n        <NFormItem label=\"容量\">\n          <NInputNumber v-model:value=\"editFormData.capacity\" :min=\"1\" :max=\"100\" style=\"width: 100%;\" />\n        </NFormItem>\n        <NFormItem label=\"状态\">\n          <NSelect v-model:value=\"editFormData.status\" :options=\"[\n            { label: '启用', value: 'active' },\n            { label: '停用', value: 'inactive' }\n          ]\" />\n        </NFormItem>\n      </NForm>\n\n      <template #footer>\n        <NSpace justify=\"end\">\n          <NButton @click=\"showModal = false\">取消</NButton>\n          <NButton type=\"primary\" :loading=\"modalLoading\" @click=\"handleSubmit\">\n            确认\n          </NButton>\n        </NSpace>\n      </template>\n    </NModal>\n  </div>\n</template>\n\n<style scoped>\n.page-container {\n  padding: 24px;\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, onMounted, h, computed } from 'vue'\nimport {\n  NCard,\n  NDataTable,\n  NButton,\n  NSpace,\n  NTag,\n  NStatistic,\n  NGrid,\n  NGi,\n  NPopconfirm,\n  useMessage,\n  type DataTableColumns,\n  type DataTableRowKey\n} from 'naive-ui'\nimport {\n  getOverdueList,\n  sendReminder,\n  batchReturn,\n  checkOverdue,\n  type OverdueInfo\n} from '../api/overdue'\n\nconst message = useMessage()\n\n// 滞留件列表\nconst loading = ref(false)\nconst overdueList = ref<OverdueInfo[]>([])\nconst total = ref(0)\nconst page = ref(1)\nconst pageSize = ref(20)\nconst statusFilter = ref('')\n\n// 选中的行\nconst checkedRowKeys = ref<DataTableRowKey[]>([])\n\n// 统计\nconst statistics = computed(() => {\n  const pending = overdueList.value.filter(o => o.status === 'pending').length\n  const reminded = overdueList.value.filter(o => o.status === 'reminded').length\n  const returned = overdueList.value.filter(o => o.status === 'returned').length\n  const totalFee = overdueList.value.reduce((sum, o) => sum + o.overdue_fee, 0)\n  return { pending, reminded, returned, totalFee }\n})\n\n// 状态选项\nconst statusOptions = [\n  { label: '全部', value: '' },\n  { label: '待处理', value: 'pending' },\n  { label: '已提醒', value: 'reminded' },\n  { label: '已退回', value: 'returned' }\n]\n\n// 状态映射\nconst statusMap: Record<string, { text: string; type: any }> = {\n  pending: { text: '待处理', type: 'warning' },\n  reminded: { text: '已提醒', type: 'info' },\n  returned: { text: '已退回', type: 'default' }\n}\n\n// 获取滞留天数颜色\nconst getOverdueColor = (days: number) => {\n  if (days >= 7) return '#f5222d'\n  if (days >= 3) return '#fa8c16'\n  return '#52c41a'\n}\n\n// 表格列定义\nconst columns: DataTableColumns<OverdueInfo> = [\n  { type: 'selection' },\n  { title: 'ID', key: 'id', width: 60 },\n  {\n    title: '取件码',\n    key: 'pickup_code',\n    width: 100,\n    render: (row) => h('strong', { style: 'color: #18a058;' }, row.pickup_code)\n  },\n  { title: '快递单号', key: 'tracking_number', width: 140 },\n  { title: '收件人', key: 'recipient_name', width: 80 },\n  { title: '手机号', key: 'recipient_phone', width: 120 },\n  { title: '货架', key: 'shelf_code', width: 80, render: (row) => row.shelf_code || '-' },\n  {\n    title: '滞留天数',\n    key: 'overdue_days',\n    width: 100,\n    render: (row) => {\n      return h('span', {\n        style: { color: getOverdueColor(row.overdue_days), fontWeight: 'bold' }\n      }, `${row.overdue_days} 天`)\n    }\n  },\n  {\n    title: '提醒次数',\n    key: 'reminder_count',\n    width: 80\n  },\n  {\n    title: '滞留费',\n    key: 'overdue_fee',\n    width: 80,\n    render: (row) => `¥${row.overdue_fee.toFixed(2)}`\n  },\n  {\n    title: '状态',\n    key: 'status',\n    width: 80,\n    render: (row) => {\n      const status = statusMap[row.status] || { text: row.status, type: 'default' }\n      return h(NTag, { type: status.type }, { default: () => status.text })\n    }\n  },\n  {\n    title: '操作',\n    key: 'actions',\n    width: 150,\n    render: (row) => {\n      if (row.status === 'returned') {\n        return h('span', { style: 'color: #999;' }, '已退回')\n      }\n      return h(NSpace, {}, {\n        default: () => [\n          h(NButton, {\n            size: 'small',\n            type: 'info',\n            onClick: () => handleSendReminder(row)\n          }, { default: () => '发送提醒' }),\n          h(NPopconfirm, {\n            onPositiveClick: () => handleReturn([row.id])\n          }, {\n            trigger: () => h(NButton, { size: 'small', type: 'error' }, { default: () => '退回' }),\n            default: () => '确定退回该包裹吗？'\n          })\n        ]\n      })\n    }\n  }\n]\n\n// 加载滞留件列表\nconst loadOverdueList = async () => {\n  loading.value = true\n  const res = await getOverdueList({\n    status: statusFilter.value || undefined,\n    page: page.value,\n    page_size: pageSize.value\n  })\n\n  if (res.code === 0 && res.data) {\n    overdueList.value = res.data.list\n    total.value = res.data.pagination.total\n  } else {\n    message.error(res.message || '加载失败')\n  }\n  loading.value = false\n}\n\n// 发送提醒\nconst handleSendReminder = async (row: OverdueInfo) => {\n  const res = await sendReminder(row.id)\n  if (res.code === 0) {\n    message.success('提醒已发送')\n    loadOverdueList()\n  } else {\n    message.error(res.message || '发送失败')\n  }\n}\n\n// 退回包裹\nconst handleReturn = async (ids: number[]) => {\n  const res = await batchReturn(ids)\n  if (res.code === 0 && res.data) {\n    message.success(`成功退回 ${res.data.success} 个包裹`)\n    checkedRowKeys.value = []\n    loadOverdueList()\n  } else {\n    message.error(res.message || '退回失败')\n  }\n}\n\n// 批量退回选中的包裹\nconst handleBatchReturn = () => {\n  const ids = checkedRowKeys.value as number[]\n  if (ids.length === 0) {\n    message.warning('请选择要退回的包裹')\n    return\n  }\n  handleReturn(ids)\n}\n\n// 手动检查滞留件\nconst handleCheckOverdue = async () => {\n  const res = await checkOverdue()\n  if (res.code === 0 && res.data) {\n    message.success(`已标记 ${res.data.marked_count} 个新滞留件`)\n    loadOverdueList()\n  } else {\n    message.error(res.message || '检查失败')\n  }\n}\n\n// 处理分页变化\nconst handlePageChange = (newPage: number) => {\n  page.value = newPage\n  loadOverdueList()\n}\n\n// 处理每页条数变化\nconst handlePageSizeChange = (newPageSize: number) => {\n  pageSize.value = newPageSize\n  page.value = 1\n  loadOverdueList()\n}\n\n// 处理选择变化\nconst handleCheck = (rowKeys: DataTableRowKey[]) => {\n  checkedRowKeys.value = rowKeys\n}\n\nonMounted(() => {\n  loadOverdueList()\n})\n</script>\n\n<template>\n  <div class=\"page-container\">\n    <!-- 统计卡片 -->\n    <NGrid :cols=\"4\" :x-gap=\"16\" style=\"margin-bottom: 16px;\">\n      <NGi>\n        <NCard>\n          <NStatistic label=\"待处理\" :value=\"statistics.pending\">\n            <template #suffix>件</template>\n          </NStatistic>\n        </NCard>\n      </NGi>\n      <NGi>\n        <NCard>\n          <NStatistic label=\"已提醒\" :value=\"statistics.reminded\">\n            <template #suffix>件</template>\n          </NStatistic>\n        </NCard>\n      </NGi>\n      <NGi>\n        <NCard>\n          <NStatistic label=\"已退回\" :value=\"statistics.returned\">\n            <template #suffix>件</template>\n          </NStatistic>\n        </NCard>\n      </NGi>\n      <NGi>\n        <NCard>\n          <NStatistic label=\"累计滞留费\">\n            <template #prefix>¥</template>\n            <template #default>{{ statistics.totalFee.toFixed(2) }}</template>\n          </NStatistic>\n        </NCard>\n      </NGi>\n    </NGrid>\n\n    <NCard title=\"滞留件管理\">\n      <template #header-extra>\n        <NSpace>\n          <NButton @click=\"handleCheckOverdue\">检查滞留件</NButton>\n          <NButton\n            type=\"error\"\n            :disabled=\"checkedRowKeys.length === 0\"\n            @click=\"handleBatchReturn\"\n          >\n            批量退回 ({{ checkedRowKeys.length }})\n          </NButton>\n        </NSpace>\n      </template>\n\n      <!-- 筛选工具栏 -->\n      <NSpace style=\"margin-bottom: 16px;\">\n        <NButton\n          v-for=\"option in statusOptions\"\n          :key=\"option.value ?? 'all'\"\n          :type=\"statusFilter === option.value ? 'primary' : 'default'\"\n          @click=\"statusFilter = option.value; page = 1; loadOverdueList()\"\n        >\n          {{ option.label }}\n        </NButton>\n      </NSpace>\n\n      <!-- 数据表格 -->\n      <NDataTable\n        :remote=\"true\"\n        :columns=\"columns\"\n        :data=\"overdueList\"\n        :loading=\"loading\"\n        :row-key=\"(row: OverdueInfo) => row.id\"\n        :checked-row-keys=\"checkedRowKeys\"\n        @update:checked-row-keys=\"handleCheck\"\n        :pagination=\"{\n          page: page,\n          pageSize: pageSize,\n          itemCount: total,\n          showSizePicker: true,\n          pageSizes: [10, 20, 50],\n          onUpdatePage: handlePageChange,\n          onUpdatePageSize: handlePageSizeChange,\n          prefix: () => `共 ${total} 条`\n        }\"\n        :scroll-x=\"1300\"\n      />\n    </NCard>\n  </div>\n</template>\n\n<style scoped>\n.page-container {\n  padding: 24px;\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n</style>\n","<script setup lang=\"ts\">\nimport { ref, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useUserStore } from '../stores/user'\nimport {\n  NCard,\n  NForm,\n  NFormItem,\n  NInput,\n  NButton,\n  NSpace,\n  NDescriptions,\n  NDescriptionsItem,\n  NTag,\n  useMessage\n} from 'naive-ui'\nimport { getProfile, updateProfile } from '../api/user'\nimport type { UserProfile } from '../api/types'\n\nconst router = useRouter()\nconst userStore = useUserStore()\nconst message = useMessage()\n\nconst loading = ref(false)\nconst editMode = ref(false)\nconst profile = ref<UserProfile | null>(null)\n\n// 编辑表单\nconst formValue = ref({\n  realName: '',\n  email: ''\n})\n\n// 角色映射\nconst roleMap: Record<string, { text: string; type: any }> = {\n  user: { text: '用户', type: 'default' },\n  staff: { text: '员工', type: 'info' },\n  admin: { text: '管理员', type: 'success' }\n}\n\n// 加载用户信息\nconst loadProfile = async () => {\n  loading.value = true\n  const res = await getProfile()\n  if (res.code === 0 && res.data) {\n    profile.value = res.data\n    formValue.value = {\n      realName: res.data.realName,\n      email: res.data.email || ''\n    }\n  } else {\n    message.error(res.message || '加载失败')\n  }\n  loading.value = false\n}\n\n// 进入编辑模式\nconst handleEdit = () => {\n  if (profile.value) {\n    formValue.value = {\n      realName: profile.value.realName,\n      email: profile.value.email || ''\n    }\n  }\n  editMode.value = true\n}\n\n// 取消编辑\nconst handleCancel = () => {\n  editMode.value = false\n}\n\n// 保存修改\nconst handleSave = async () => {\n  if (loading.value) return\n\n  if (!formValue.value.realName) {\n    message.error('请输入真实姓名')\n    return\n  }\n\n  loading.value = true\n  const res = await updateProfile(formValue.value)\n  if (res.code === 0) {\n    message.success('更新成功')\n    editMode.value = false\n    // 更新本地用户信息\n    if (profile.value) {\n      profile.value.realName = formValue.value.realName\n      profile.value.email = formValue.value.email\n      userStore.setUserInfo(profile.value)\n    }\n    loadProfile()\n  } else {\n    message.error(res.message || '更新失败')\n  }\n  loading.value = false\n}\n\n// 退出登录\nconst handleLogout = () => {\n  userStore.logout()\n  message.success('已退出登录')\n  router.push('/')\n}\n\nonMounted(() => {\n  loadProfile()\n})\n</script>\n\n<template>\n  <div class=\"page-container\">\n    <NCard title=\"个人中心\" style=\"max-width: 800px; margin: 0 auto;\">\n      <div v-if=\"!editMode && profile\">\n        <NDescriptions label-placement=\"left\" :column=\"1\" bordered>\n          <NDescriptionsItem label=\"用户名\">\n            {{ profile.username }}\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"真实姓名\">\n            {{ profile.realName }}\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"手机号\">\n            {{ profile.phone }}\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"邮箱\">\n            {{ profile.email || '-' }}\n          </NDescriptionsItem>\n          <NDescriptionsItem v-if=\"profile.idCard\" label=\"身份证号\">\n            {{ profile.idCard }}\n          </NDescriptionsItem>\n          <NDescriptionsItem label=\"角色\">\n            <NTag :type=\"roleMap[profile.role]?.type || 'default'\">\n              {{ roleMap[profile.role]?.text || profile.role }}\n            </NTag>\n          </NDescriptionsItem>\n        </NDescriptions>\n\n        <NSpace style=\"margin-top: 24px;\" justify=\"center\">\n          <NButton type=\"primary\" @click=\"handleEdit\">\n            编辑资料\n          </NButton>\n          <NButton @click=\"handleLogout\">\n            退出登录\n          </NButton>\n        </NSpace>\n      </div>\n\n      <div v-else>\n        <NForm :model=\"formValue\" label-placement=\"left\" label-width=\"100\">\n          <NFormItem label=\"真实姓名\" required>\n            <NInput v-model:value=\"formValue.realName\" placeholder=\"请输入真实姓名\" />\n          </NFormItem>\n\n          <NFormItem label=\"邮箱\">\n            <NInput v-model:value=\"formValue.email\" placeholder=\"请输入邮箱\" />\n          </NFormItem>\n        </NForm>\n\n        <NSpace style=\"margin-top: 24px;\" justify=\"center\">\n          <NButton @click=\"handleCancel\">\n            取消\n          </NButton>\n          <NButton type=\"primary\" :loading=\"loading\" @click=\"handleSave\">\n            保存\n          </NButton>\n        </NSpace>\n      </div>\n    </NCard>\n  </div>\n</template>\n\n<style scoped>\n.page-container {\n  padding: 24px;\n  min-height: 100vh;\n  background-color: #f5f5f5;\n}\n</style>\n"],"names":[],"mappings":"AAeA;AC8LA;ACrFA;ACqIA;AClBA;ACrBA;AC8BA;AC9EA;ACsKA;AC+EA;ACsBA;AC1HA;AC1IA"}